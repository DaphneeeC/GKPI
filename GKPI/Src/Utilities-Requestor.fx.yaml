"'Utilities-Requestor' As screen":
    OnVisible: |+
        =Set(varDefault,"EBSB");
        
        Set(popupusersaveutil,false);
        Set(popupusersubmit,false);
        Set(popupuserupdateutil,false);
        Set(popupsubmitupdateutil,false);
            
        Clear(colUtilities);
        
        Collect(colUtilities,'Utilities for G-KPI Calculation');
        
        Set(varGalElec, false );Set(varGalFuel, false );Set(varGalProd, false );Set(varGalCO2C, false );Set(varGalWater, false );Set(varGalCO2E, false );
        
        Clear(colProdHLMY);
        
        If(
        
        varDefault = "EBSB", Collect(colProdHLMY,
        {ID:1, Utilities:"Production", UtilitiesType:"Beverages or Milk", Unit:"kL"},{ID:2, Utilities:"Production", UtilitiesType:"Beverages or Milk", Unit:"kL"}),
        
        varDefault = "EDSB", Collect(colProdHLMY,
        {ID:3, Utilities:"Production",  UtilitiesType:"Beverages or Milk", Unit:"kL"},{ID:4, Utilities:"Production", UtilitiesType:"Condensed Milk", Unit:"kg"}, {ID:5, Utilities:"Production",  UtilitiesType:"Condensed Milk", Unit:"kg"}),
        
        varDefault = "PTEMI", Collect(colProdHLMY,
        {ID:6, Utilities:"Production", UtilitiesType:"Beverages or Milk", Unit:"kL"}),
        
        varDefault = "PTEDI", Collect(colProdHLMY,
        {ID:7, Utilities:"Production", UtilitiesType:"Condensed Milk", Unit:"kg"})
        
        );
        
        Clear(colCO2CMY);
        
        If(
        
        varDefault = "EBSB", Collect(colCO2CMY,
        {ID:9, Utilities:"CO2-C", UtilitiesType:"Liquid", Unit:"kg"}));
        
        Clear(colCO2EMY);
        
        If(
        
        varDefault = "EBSB", Collect(colCO2EMY,
        {ID:52, Utilities:"CO2-E", UtilitiesType:"Emissions Based On Energy Consumption", Unit:"kg-CO2e"},{ID:53, Utilities:"CO2-E", UtilitiesType:"Purchased Green Electricity Certificate", Unit:"kWh"},{ID:54, Utilities:"CO2-E", UtilitiesType:"Purchased CO2 Credit", Unit:"kg-CO2e"}),
        
        varDefault = "EDSB", Collect(colCO2EMY,
        {ID:55, Utilities:"CO2-E", UtilitiesType:"Emissions Based On Energy Consumption", Unit:"kg-CO2e"},{ID:56, Utilities:"CO2-E", UtilitiesType:"Purchased Green Electricity Certificate", Unit:"kWh"},{ID:57, Utilities:"CO2-E", UtilitiesType:"Purchased CO2 Credit", Unit:"kg-CO2e"}),
        
        varDefault = "PTEMI", Collect(colCO2EMY,
        {ID:58, Utilities:"CO2-E", UtilitiesType:"Emissions Based On Energy Consumption", Unit:"kg-CO2e"},{ID:59, Utilities:"CO2-E", UtilitiesType:"Purchased Green Electricity Certificate", Unit:"kWh"},{ID:60, Utilities:"CO2-E", UtilitiesType:"Purchased CO2 Credit", Unit:"kg-CO2e"}),
        
        varDefault = "PTEDI", Collect(colCO2EMY,
        {ID:61, Utilities:"CO2-E", UtilitiesType:"Emissions Based On Energy Consumption", Unit:"kg-CO2e"},{ID:62, Utilities:"CO2-E", UtilitiesType:"Purchased Green Electricity Certificate", Unit:"kWh"},{ID:63, Utilities:"CO2-E", UtilitiesType:"Purchased CO2 Credit", Unit:"kg-CO2e"})
        
        );
        
        Clear(colElecHLMY);
        
        If(
        
        varDefault = "EBSB", Collect(colElecHLMY,
        {ID:1, Utilities:"Electricity", UtilitiesType: "Renewable (e.g. Solar)", Unit: "kWh"},{ID:2, Utilities:"Electricity", UtilitiesType: "In-House excl. Renewable (e.g. CoGen)", Unit: "kWh"},{ID:16, Utilities:"Electricity", UtilitiesType:"TNB",  Unit: "kWh"}),
        
        varDefault = "EDSB", Collect(colElecHLMY,
        {ID:1, Utilities:"Electricity", UtilitiesType: "Renewable (e.g. Solar)", Unit: "kWh"},{ID:2, Utilities:"Electricity", UtilitiesType: "In-House excl. Renewable (e.g. CoGen)", Unit: "kWh"},{ID:16, Utilities:"Electricity", UtilitiesType: "In-House excl. Renewable (e.g. CoGen)", Unit: "kWh"}),
        
        varDefault = "PTEMI", Collect(colElecHLMY,
        {ID:17, Utilities:"Electricity", UtilitiesType:"550KVA From Cikarang Listrindo", Unit: "kWh"}, {ID:1, Utilities:"Electricity", UtilitiesType: "Renewable (e.g. Solar)", Unit: "kWh"}, {ID:2, Utilities:"Electricity", UtilitiesType: "In-House excl. Renewable (e.g. CoGen)", Unit: "kWh"}),
        
        varDefault = "PTEDI", Collect(colElecHLMY,
        {ID:18, Utilities:"Electricity", UtilitiesType:"PLN (State Electricity Enterprise)", Unit: "kWh"}, {ID:1, Utilities:"Electricity", UtilitiesType: "Renewable (e.g. Solar)", Unit: "kWh"}, {ID:2, Utilities:"Electricity", UtilitiesType: "In-House excl. Renewable (e.g. CoGen)", Unit: "kWh"}));
        
        Clear(colWaterHLMY);
        
        If(
        
        varDefault = "EBSB", Collect(colWaterHLMY,
        {ID:4, Utilities:"Water", UtilitiesType:"SYABAS", Unit: "m3"},{ID:5, Utilities:"Water", UtilitiesType:"Tube well (8 wells)", Unit: "m3"}),
        
        varDefault = "EDSB", Collect(colWaterHLMY,
        {ID:4, Utilities:"Water", UtilitiesType:"SYABAS", Unit: "m3"},{ID:6, Utilities:"Water",UtilitiesType:"Tanker Water", Unit: "m3"}),
        
        varDefault = "PTEMI", Collect(colWaterHLMY,
        {ID:7, Utilities:"Water", UtilitiesType:"23m3/day from Ejip industrial Park", Unit: "m3"}),
        
        varDefault = "PTEDI", Collect(colWaterHLMY,
        {ID:8, Utilities:"Water",UtilitiesType:"Ground Water", Unit: "m3"}));
        
        Clear(colFuelMY);
        
        If(
        
        varDefault = "EBSB", Collect(colFuelMY,
        {ID:24, Utilities:"Fuel", UtilitiesType: "Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"},{ID:25, Utilities:"Fuel", UtilitiesType: "Petroleum Gas or Liquefied Gas (PG/LPG)", Unit:"kg"},{ID:26, Utilities:"Fuel", UtilitiesType:"Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"}),
        
        varDefault = "EDSB", Collect(colFuelMY,
        {ID:27, Utilities:"Fuel",UtilitiesType: "Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"},{ID:28, Utilities:"Fuel", UtilitiesType: "Petroleum Gas or Liquefied Gas (PG/LPG)", Unit:"kg"},{ID:29, Utilities:"Fuel", UtilitiesType:"Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"}),
        
        varDefault = "PTEMI", Collect(colFuelMY,
        {ID:30, Utilities:"Fuel", UtilitiesType: "Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"},{ID:31, Utilities:"Fuel", UtilitiesType: "Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"}),
        
        varDefault = "PTEDI", Collect(colFuelMY,
        {ID:32, Utilities:"Fuel",UtilitiesType: "Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"}, {ID:33, Utilities:"Fuel", UtilitiesType: "Petroleum Gas or Liquefied Gas (PG/LPG)", Unit:"kg"}, {ID:34, Utilities:"Fuel", UtilitiesType:"Petrol (Gasoline)", Unit:"L"}, {ID:35, Utilities:"Fuel", UtilitiesType: "Natural Gas or Liquefied Gas (NG/LNG)", Unit:"mmBtu"}));
        
        ClearCollect(colUtilitiesSaved,Filter('Utilities Total Form',Year=Value(YearUtil.Selected.Value) && Month=MonthUtil.Selected.Value && BU=varDefault))
        

    HtmlText1_8 As htmlViewer:
        Height: =673
        HtmlText: |-
            ="<div style='background-color: rgba(253,253,253,1); box-shadow: 1px 2px 22px 0px rgba(236,236,236,1); margin: 30px; width: 1295px; height: 548px; border-radius: 10px'></div>"
        Width: =1366
        Y: =95
        ZIndex: =3

    SubHeader_9 As SubHeader:
        ZIndex: =4

    Header_14 As Header:
        HeaderText: ="E-1 G-KPI (Utility Related) Form"
        ZIndex: =5

    "'Utilities-Form' As form":
        AcceptsFocus: =false
        DataSource: ='Utilities Master Form'
        Height: =214
        Item: =Defaults('Utilities Master Form')
        SnapToColumns: =false
        Width: =1285
        X: =35
        Y: =144
        ZIndex: =6

        FormNo_DataCard2 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="FormNo"
            Default: =ThisItem.FormNo
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"FormNo")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "FormNo")
            Required: =false
            Update: =DataCardValue4.Text
            Width: =428
            X: =1
            Y: =0
            ZIndex: =7

            DataCardKey4 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: ="Form No"
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue4 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                BorderThickness: =0
                Default: ="Utilities"&"-"&BUUtil.Text&Right(YearUtil.Selected.Value, 2 )&Switch(MonthUtil.Selected.Value,"January", "01", "February", "02", "March", "03", "April", "04", "May", "05", "June", "06", "July", "07", "August", "08", "September", "09",  "October", "10", "November", "11", "December", "12")
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Fill: =RGBA(0, 0, 0, 0)
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey4.Y + DataCardKey4.Height + 5
                ZIndex: =2

            ErrorMessage15 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue4.Y + DataCardValue4.Height
                ZIndex: =3

            StarVisible15 As label:
                Align: =Align.Center
                Height: =DataCardKey4.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey4.Y
                ZIndex: =4

        BU_DataCard1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="BU"
            Default: =ThisItem.BU
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"BU")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "BU")
            Required: =false
            Update: =BUUtil.Text
            Width: =214
            X: =2
            Y: =0
            ZIndex: =7

            DataCardKey13 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            BUUtil As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =varDefault
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Fill: =RGBA(0, 0, 0, 0)
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey13.Y + DataCardKey13.Height + 5
                ZIndex: =2

            ErrorMessage16 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =BUUtil.Y + BUUtil.Height
                ZIndex: =3

            StarVisible16 As label:
                Align: =Align.Center
                Height: =DataCardKey13.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey13.Y
                ZIndex: =4

        Year_DataCard2 As typedDataCard.numberEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Year"
            Default: =ThisItem.Year
            DisplayMode: =DisplayMode.Edit
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"Year")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =164
            Required: =true
            Update: =YearUtil.Selected.Value
            Width: =321
            X: =3
            Y: =0
            ZIndex: =7

            DataCardKey16 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            ErrorMessage56 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: ="This field is mandatory."
                Visible: =(IsBlank(YearUtil.Selected.Value) && Parent.DisplayMode=DisplayMode.Edit)
                Width: =280
                X: =30
                Y: =99
                ZIndex: =3

            StarVisible62 As label:
                Align: =Align.Center
                Height: =DataCardKey16.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey16.Y
                ZIndex: =4

            YearUtil As dropdown:
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank(Self.Selected.Value),Red,RGBA(230,230,230,1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: |-
                    =If(UtilitiesSaved,
                    LookUp('Utilities Total Form',Created=varUtilities.Created).Year,"")
                Items: =["", Year(Now()),  Year(Today())-1]
                OnChange: =If(CountRows(Filter('Utilities Total Form', BU = BUUtil.Text, Month = MonthUtil.Selected.Value,Year = YearUtil.Selected.Value))>0,Set(popupalreadysubmitutil,true))
                Reset: =resetyearutil
                Width: =150
                X: =30
                Y: =44
                ZIndex: =5

        Month_DataCard6 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Month"
            Default: =ThisItem.Month
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"Month")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =94
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "Month")
            Required: =true
            Update: =MonthUtil.Selected.Value
            Width: =321
            X: =4
            Y: =0
            ZIndex: =7

            DataCardKey15 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            ErrorMessage17 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: ="This field is mandatory."
                Visible: =(IsBlank(MonthUtil.Selected.Value) && Parent.DisplayMode=DisplayMode.Edit)
                Width: =Parent.Width - 60
                X: =30
                Y: =99
                ZIndex: =3

            StarVisible17 As label:
                Align: =Align.Center
                Height: =DataCardKey15.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey15.Y
                ZIndex: =4

            MonthUtil As dropdown:
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank(Self.Selected.Value),Red,RGBA(230,230,230,1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: |-
                    =If(UtilitiesSaved,
                    LookUp('Utilities Total Form',Created=varUtilities.Created).Month,"")
                Items: =Calendar.MonthsLong()
                OnChange: =If(CountRows(Filter('Utilities Total Form', BU = BUUtil.Text, Month = MonthUtil.Selected.Value,Year = YearUtil.Selected.Value))>0,Set(popupalreadysubmitutil,true))
                Reset: =resetmonthutil
                Width: =273
                X: =30
                Y: =44
                ZIndex: =5

        RequestorName_DataCard1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="RequestorName"
            Default: =ThisItem.RequestorName
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"RequestorName")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "RequestorName")
            Required: =false
            Update: =DataCardValue56.Text
            Visible: =false
            Width: =428
            X: =2
            Y: =1
            ZIndex: =7

            DataCardKey17 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue56 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =varUserName
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey17.Y + DataCardKey17.Height + 5
                ZIndex: =2

            ErrorMessage57 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue56.Y + DataCardValue56.Height
                ZIndex: =3

            StarVisible63 As label:
                Align: =Align.Center
                Height: =DataCardKey17.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey17.Y
                ZIndex: =4

        RequestorEmail_DataCard1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="RequestorEmail"
            Default: =ThisItem.RequestorEmail
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"RequestorEmail")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "RequestorEmail")
            Required: =false
            Update: =DataCardValue57.Text
            Visible: =false
            Width: =428
            X: =0
            Y: =2
            ZIndex: =7

            DataCardKey51 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue57 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =varUserEmail
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey51.Y + DataCardKey51.Height + 5
                ZIndex: =2

            ErrorMessage61 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue57.Y + DataCardValue57.Height
                ZIndex: =3

            StarVisible66 As label:
                Align: =Align.Center
                Height: =DataCardKey51.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey51.Y
                ZIndex: =4

    "'Submit-New-Util' As button":
        BorderThickness: =0
        DisplayMode: |
            =DisplayMode.Edit
        Fill: =RGBA(0, 161, 233, 1)
        Height: =42
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: =Set(popupusersubmit,true)
        Size: =13
        Text: ="Submit"
        Visible: =If(UtilitiesSaved,false,true)
        Width: =200
        X: =1133
        Y: =703
        ZIndex: =7

    "'Save-New-Util' As button":
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderThickness: =0
        Fill: =RGBA(128, 128, 128, 1)
        Height: =42
        HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        HoverFill: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        OnSelect: =Set(popupusersaveutil,true)
        Size: =13
        Text: ="Save"
        Visible: =If(UtilitiesSaved,false,true)
        Width: =200
        X: =918
        Y: =703
        ZIndex: =8

    Icon2_28 As icon.Home:
        Color: =RGBA(128, 128, 128, 1)
        Height: =29
        Icon: =Icon.Home
        OnSelect: =Navigate(Homepage)
        Width: =25
        X: =60
        Y: =9
        ZIndex: =9

    Button2_10 As button:
        Color: =RGBA(153, 153, 153, 1)
        Fill: =RGBA(0, 0, 0, 0)
        FontWeight: =Semibold
        HoverColor: =ColorFade(Self.Color, -10%)
        HoverFill: =Self.Fill
        OnSelect: |-
            =Launch("https://asahisea.sharepoint.com/sites/GKPISTG2/Shared%20Documents/Definition-Utilities.pdf")
        PressedColor: =Self.Color
        PressedFill: =Self.Fill
        Size: =12
        Text: ="Definition"
        Width: =115
        X: =626
        Y: =55
        ZIndex: =11

    Gallery11 As gallery.variableTemplateHeightGallery:
        Height: =386
        Items: =Sort(Distinct(colUtilities,Coefficient),Result)
        Layout: =Layout.Vertical
        TemplateSize: =280
        Visible: =If(UtilitiesSaved,false,true)
        Width: =1260
        X: =60
        Y: =264
        ZIndex: =12

        "'Gallery-Water' As gallery.variableTemplateHeightGallery":
            Height: |
                =CountRows('Gallery-Water'.AllItems)*40*Value(CountRows(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient = "Water").Coefficient))+40
            Items: =Filter(colUtilities, varDefault in BU.Value && Coefficient = "Water" && Status = "Approved")
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =50
            Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater,true,false)
            Width: =1250
            Y: =61
            ZIndex: =1

            Water As text:
                BorderColor: |-
                    =If(
                        IsBlank(Water.Text),
                        Red,
                        RGBA(
                            230,
                            230,
                            230,
                            1
                        )
                    )
                Default: =ThisItem.FuelType
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', Water = ThisItem.Water)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(Water.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colWaterHLMY, ID= ThisItem.ID) =0,
                    Collect(colWaterHLMY,{Amount:Value('Water-Conversion-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_6.Text, UtilitiesType: Water.Text, ID: ThisItem.ID, DataType: TextInput19_5.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)}),
                    Patch(colWaterHLMY,
                                 First(
                                    Filter(colWaterHLMY,
                                       ID= ThisItem.ID)),
                                        {
                                           Amount:Value('Water-Conversion-Amt'.Text), ID: ThisItem.ID,UtilitiesType: Water.Text,DataType: TextInput19_5.Text, Unit:TextInput19_6.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =410
                X: =33
                Y: =2
                ZIndex: =5

            TextInput19_5 As text:
                BorderColor: =If(IsBlank(TextInput19_5.Text),Red,RGBA(230,230,230,1))
                Default: =ThisItem.DataType
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', Water = ThisItem.Water)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(TextInput19_5.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colWaterHLMY, ID= ThisItem.ID) =0,
                    Collect(colWaterHLMY,{Amount:Value('Water-Conversion-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_6.Text, UtilitiesType: Water.Text, ID: ThisItem.ID, DataType: TextInput19_5.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)}),
                    Patch(colWaterHLMY,
                                 First(
                                    Filter(colWaterHLMY,
                                       ID= ThisItem.ID)),
                                        {
                                           Amount:Value('Water-Conversion-Amt'.Text), ID: ThisItem.ID,UtilitiesType: Water.Text,DataType: TextInput19_5.Text, Unit:TextInput19_6.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =387
                X: =459
                Y: =2
                ZIndex: =6

            TextInput19_6 As text:
                BorderColor: =If(IsBlank(TextInput19_6.Text),Red,RGBA(230,230,230,1))
                Default: =If(Self.Visible,ThisItem.Unit, Dropdown4.Selected.Result)
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', Water = ThisItem.Water)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(TextInput19_6.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colWaterHLMY, ID= ThisItem.ID) =0,
                    Collect(colWaterHLMY,{Amount:Value('Water-Conversion-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_6.Text, UtilitiesType: Water.Text, ID: ThisItem.ID, DataType: TextInput19_5.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)}),
                    Patch(colWaterHLMY,
                                 First(
                                    Filter(colWaterHLMY,
                                       ID= ThisItem.ID)),
                                        {
                                           Amount:Value('Water-Conversion-Amt'.Text), ID: ThisItem.ID,UtilitiesType: Water.Text,DataType: TextInput19_5.Text, Unit:TextInput19_6.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(!IsBlank(LookUp('Utilities for G-KPI Calculation',ID=ThisItem.ID&&Coefficient=CoefficientUtil_1.Text))&&!varSubtotalWater, true ,varSubtotalWater, false , false )
                Width: =189
                X: =859
                Y: =2
                ZIndex: =7

            TextInput19_7 As text:
                BorderColor: =If(IsBlank(TextInput19_7.Text),Red,RGBA(230,230,230,1))
                Default: =""
                DisplayMode: |
                    =DisplayMode.Edit
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colWaterHLMY, ID= ThisItem.ID) =0,
                    Collect(colWaterHLMY,{Amount:Value('Water-Conversion-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_6.Text, UtilitiesType: Water.Text, ID: ThisItem.ID, DataType: TextInput19_5.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)}),
                    Patch(colWaterHLMY,
                                 First(
                                    Filter(colWaterHLMY,
                                       ID= ThisItem.ID)),
                                        {
                                           Amount:Value('Water-Conversion-Amt'.Text), ID: ThisItem.ID,UtilitiesType: Water.Text,DataType: TextInput19_5.Text, Unit:TextInput19_6.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =171
                X: =1061
                Y: =2
                ZIndex: =8

            "'Water-Conversion-DT' As text":
                Default: ="Water Consumption"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =387
                X: =459
                Y: =TextInput19_5.Height 
                ZIndex: =9

            "'Water-Conversion-Unit' As text":
                Default: ="hL"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =189
                X: =859
                Y: =TextInput19_6.Height 
                ZIndex: =10

            "'Water-Conversion-Amt' As text":
                Default: =Value(TextInput19_7.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Unit = "hL" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value')
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =189
                X: =1061
                Y: =TextInput19_7.Height 
                ZIndex: =11

            Circle4_5 As circle:
                Fill: |+
                    =If(
                    IsBlank(Water.Text) || IsBlank(TextInput19_5.Text) || IsBlank(TextInput19_6.Text) || IsBlank(TextInput19_7.Text), Orange,
                    
                    
                    Green
                    
                    )
                    
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =12

            Label32_4 As label:
                OnSelect: =Select(Parent)
                Text: =If(Circle4_5.Fill = Orange,0,1)
                Visible: =false
                Width: =64
                X: =406
                Y: =10
                ZIndex: =13

            Dropdown4 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =""
                Items: =Distinct(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient=CoefficientUtil_1.Text),Unit)
                OnChange: |-
                    =If(CountIf(colWaterHLMY, ID= ThisItem.ID) =0,
                    Collect(colWaterHLMY,{Amount:Value('Water-Conversion-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit:Dropdown4.Selected.Result, UtilitiesType: Water.Text, ID: ThisItem.ID, DataType: TextInput19_5.Text, AmountConversion: Value('Water-Conversion-Amt'.Text)}),
                    Patch(colWaterHLMY,
                                 First(
                                    Filter(colWaterHLMY,
                                       ID= ThisItem.ID)),
                                        {
                                           Amount:Value('Water-Conversion-Amt'.Text), ID: ThisItem.ID,UtilitiesType: Water.Text,DataType: TextInput19_5.Text, Unit:Dropdown4.Selected.Result, AmountConversion: Value('Water-Conversion-Amt'.Text)
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         !IsBlank(LookUp('Utilities for G-KPI Calculation', ID = ThisItem.ID && Coefficient=CoefficientUtil_1.Text)),false,
                         varSubtotalWater,false,
                         true
                         )
                Width: =189
                X: =859
                Y: =2
                ZIndex: =14

        Button8_57 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =56
            Text: =""
            Width: =1250
            ZIndex: =3

        CoefficientUtil_1 As label:
            AutoHeight: =true
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            OnSelect: =Select(Parent)
            Text: =ThisItem.Result
            Width: =133
            X: =50
            Y: =12
            ZIndex: =4

        Circle1_15 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =12
            Y: =13
            ZIndex: =5

        Icon22_26 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =16
            Icon: =Icon.Document
            OnSelect: =Select(Parent)
            Width: =26
            X: =14
            Y: =20
            ZIndex: =6

        "'Gallery-CO2-C' As gallery.variableTemplateHeightGallery":
            Height: |
                =CountRows('Gallery-CO2-C'.AllItems)*40*Value(CountRows(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient = "CO2-C").Coefficient))+120
            Items: =Filter(colUtilities, varDefault in BU.Value && Coefficient = CoefficientUtil_1.Text && Status = "Approved")
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =50
            Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C,true,false)
            Width: =1250
            Y: =61
            ZIndex: =7

            "'CO2-C-Text' As dropdown":
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank('CO2-C-Text'.Selected.FuelType),Red,RGBA(230,230,230,1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                Items: =Filter('Utilities for G-KPI Calculation', BUUtil.Text in BU.Value && Coefficient=CoefficientUtil_1.Text).FuelType
                OnChange: |-
                    =If(CountIf(colCO2CMY, ID = ThisItem.ID) =0,
                    Collect(colCO2CMY,{Amount:Value(TextInput18.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput16.Text, UtilitiesType: 'CO2-C-Text'.Selected.FuelType, ID: ThisItem.ID}),
                    Patch(colCO2CMY,
                                 First(
                                    Filter(colCO2CMY, ID = ThisItem.ID
                                       )),
                                        {   
                                           Amount:Value(TextInput18.Text), UtilitiesType: 'CO2-C-Text'.Selected.FuelType
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && !varSubtotalCOC,true,false)
                Width: =410
                X: =32
                Y: =2
                ZIndex: =5

            TextInput15 As text:
                BorderColor: =If(IsBlank(TextInput15.Text),Red,RGBA(230,230,230,1))
                Default: =ThisItem.DataType
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', 'CO2-C' = ThisItem.'CO2-C')) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && !varSubtotalCOC,true,false)
                Width: =387
                X: =459
                Y: =1
                ZIndex: =6

            TextInput16 As text:
                BorderColor: =If(IsBlank(TextInput16.Text),Red,RGBA(230,230,230,1))
                Default: =ThisItem.Unit
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', 'CO2-C' = ThisItem.'CO2-C')) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && !varSubtotalCOC,true,false)
                Width: =189
                X: =859
                Y: =1
                ZIndex: =7

            TextInput18 As text:
                BorderColor: =If(IsBlank(TextInput18.Text),Red,RGBA(230,230,230,1))
                Default: =
                Format: =TextFormat.Number
                OnChange: |-
                    =If(CountIf(colCO2CMY, ID = ThisItem.ID) =0,
                    Collect(colCO2CMY,{Amount:Value(TextInput18.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput16.Text, UtilitiesType: 'CO2-C-Text'.Selected.FuelType, ID: ThisItem.ID}),
                    Patch(colCO2CMY,
                                 First(
                                    Filter(colCO2CMY, ID = ThisItem.ID
                                       )),
                                        {   
                                           Amount:Value(TextInput18.Text), UtilitiesType: 'CO2-C-Text'.Selected.FuelType
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && !varSubtotalCOC,true,false)
                Width: =171
                X: =1061
                Y: =1
                ZIndex: =8

            "'Subtotal-CO2C-DataType' As label":
                Height: =36
                OnSelect: =Select(Parent)
                Text: =Text(LookUp('Utilities for G-KPI Calculation',Coefficient=CoefficientUtil_1.Text).DataType)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && varSubtotalCOC,true,false)
                Width: =257
                X: =TextInput15.X+7
                Y: =3
                ZIndex: =9

            "'Subtotal-CO2C-Unit' As label":
                Height: =36
                OnSelect: =Select(Parent)
                Text: =Text(LookUp('Utilities for G-KPI Calculation',Coefficient=CoefficientUtil_1.Text).Unit)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && varSubtotalCOC,true,false)
                Width: =257
                X: =TextInput16.X+7
                Y: =3
                ZIndex: =10

            "'Subtotal-CO2C-Amt' As label":
                Height: =36
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: =Value(TextInput18.Text)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && varSubtotalCOC,true,false)
                Width: =170
                X: =1061
                Y: =3
                ZIndex: =11

            "'Subtotal-Text' As label":
                OnSelect: =Select(Parent)
                Text: ="Subtotal"
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && varSubtotalCOC,true,false)
                X: =10
                Y: =3
                ZIndex: =12

            Label32_3 As label:
                OnSelect: =Select(Parent)
                Text: =If(Circle4_9.Fill = Orange,0,1)
                Visible: =false
                Width: =64
                X: =386
                Y: =10
                ZIndex: =14

            "'No-items-to-display' As label":
                OnSelect: =Select(Parent)
                Text: ="No items to display"
                Visible: =If(BUUtil.Text<>"EBSB",true,false)
                Width: =574
                X: =32
                Y: =2
                ZIndex: =15

            Circle4_9 As circle:
                Fill: =If(IsBlank('CO2-C-Text'.Selected.FuelType)||IsBlank(TextInput18.Text),Orange,Green)
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-C" && varGalCO2C && !varSubtotalCOC,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =16

        "'Gallery-Production' As gallery.variableTemplateHeightGallery":
            Height: |
                =CountRows('Gallery-Production'.AllItems)*40*Value(CountRows(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient = CoefficientUtil_1.Text).Coefficient))+40
            Items: =Filter('Line Name Production from Etika SC Table', varDefault in Title)
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =50
            Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && !varSubtotalProd,true, false)
            Width: =1250
            Y: =61
            ZIndex: =8

            TextInput19_12 As text:
                BorderColor: =If(IsBlank(TextInput19_12.Text),Red,RGBA(230, 230, 230, 1))
                Default: |-
                    =If(
                    IsBlank(
                    'Production-Text'.Selected.FuelType),"0",
                    ThisItem.ID = 1,
                    Text(Sum(Filter('UFE-Extract-Excel', ProdLineUtil = "CSD" && Month= MonthUtil.Selected.Value && 
                    Year=Value(YearUtil.Selected.Value)),Litres),"#,###,###" ),
                    ThisItem.ID = 2,
                    Text(Sum(Filter('UFE-Extract-Excel', ProdLineUtil = "NCB" && Month= MonthUtil.Selected.Value && Year=Value(YearUtil.Selected.Value)),Litres),"#,###,###" ),
                    ThisItem.ID = 3,
                    Text(Sum(Filter('UFE-Extract-Excel', ProdLineUtil = "EVAP" && Month= MonthUtil.Selected.Value && Year=Value(YearUtil.Selected.Value)),Litres),"#,###,###" ),
                    ThisItem.ID = 4,
                    Text(Sum(Filter('UFE-Extract-Excel', ProdLineUtil = "SCM" && Month= MonthUtil.Selected.Value && Year=Value(YearUtil.Selected.Value)),Litres),"#,###,###" ),
                    ThisItem.ID = 5,
                    Text(Sum(Filter('UFE-Extract-Excel', ProdLineUtil = "UHT" && Month= MonthUtil.Selected.Value && Year=Value(YearUtil.Selected.Value)),Litres),"#,###,###" ),
                    ThisItem.ID = 6,
                    Text(Sum(Filter('UFE-Extract-Excel', ProdLineUtil = "Line A & B" && Month= MonthUtil.Selected.Value && Year=Value(YearUtil.Selected.Value)),Litres),"#,###,###" ),
                    ThisItem.ID = 7,
                    Text(Sum(Filter('UFE-Extract-Excel', ProdLineUtil = "Line 1" && Month= MonthUtil.Selected.Value && Year=Value(YearUtil.Selected.Value)),Litres),"#,###,###" ))
                DisplayMode: =If(varDefault = "EBSB" || varDefault = "EDSB",DisplayMode.View,DisplayMode.Edit)
                Fill: =If(varDefault = "EBSB" || varDefault = "EDSB", RGBA(0, 0, 0, 0), White)
                FontWeight: =Normal
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && !varSubtotalProd,true, false)
                Width: =171
                X: =1061
                Y: =2
                ZIndex: =4

            "'Production-Text' As dropdown":
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank('Production-Text'.Selected.FuelType),Red,RGBA(230, 230, 230, 1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                Items: =Filter('Utilities for G-KPI Calculation',Coefficient="Production" && varDefault in BU.Value).FuelType
                OnChange: |-
                    =If(CountIf(colProdHLMY, ID = ThisItem.ID) =0,
                    Collect(colProdHLMY,{Amount:Value(TextInput19_12.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput14_1.Text, UtilitiesType: 'Production-Text'.Selected.FuelType, AmountConversion: Value(TextInput19_13.Text), ID: ThisItem.ID, ProdName:Label3.Text}),
                    Patch(colProdHLMY,
                                 First(
                                    Filter(colProdHLMY, ID = ThisItem.ID
                                       )),
                                        {   
                                           Amount:Value(TextInput19_12.Text), AmountConversion: Value(TextInput19_13.Text), UtilitiesType: 'Production-Text'.Selected.FuelType, ProdName:Label3.Text
                                           }
                              ))
                Visible: |
                    =If(
                    
                    CountRows(Filter('Line Name Production from Etika SC Table',Title = ThisItem.Title)) > 0  &&  !varSubtotalProd,true,false)
                Width: =410
                X: =200
                Y: =2
                ZIndex: =5

            TextInput14 As text:
                BorderColor: =If(IsBlank(TextInput14.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="Production Amount"
                DisplayMode: |-
                    =If(
                    
                    CountRows(Filter('Line Name Production from Etika SC Table',Title = ThisItem.Title)) = 0, DisplayMode.Edit,DisplayMode.View)
                Fill: |-
                    =If(
                    
                    CountRows(Filter('Line Name Production from Etika SC Table',Title = ThisItem.Title)) = 0, White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && !varSubtotalProd,true, false)
                Width: =200
                X: =700
                Y: =2
                ZIndex: =6

            TextInput14_1 As text:
                BorderColor: =If(IsBlank(TextInput14_1.Text),Red,RGBA(230, 230, 230, 1))
                Default: |-
                    =If(!IsBlank('Production-Text'.Selected.FuelType),
                    LookUp('Utilities for G-KPI Calculation', FuelType = 'Production-Text'.Selected.FuelType).Unit,
                    "kL")
                DisplayMode: |-
                    =If(
                    
                    CountRows(Filter('Line Name Production from Etika SC Table',Title = ThisItem.Title)) = 0, DisplayMode.Edit,DisplayMode.View)
                Fill: |-
                    =If(
                    
                    CountRows(Filter('Line Name Production from Etika SC Table',Title = ThisItem.Title)) = 0, White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(TextInput14.DisplayMode=DisplayMode.View &&  !varSubtotalProd,true,false)
                Width: =90
                X: =960
                Y: =2
                ZIndex: =7

            TextInput19_13 As text:
                BorderColor: =If(IsBlank(TextInput19_13.Text),Red,RGBA(230, 230, 230, 1))
                Default: |+
                    =If(
                    
                    IsBlank('Production-Text'.Selected.FuelType),"0",
                    
                    !IsBlank('Production-Text'.Selected.FuelType),
                    Text(Value(TextInput19_12.Text)*LookUp('Coefficients for G-KPI Calculation',Title = 'Production-Text'.Selected.FuelType && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value',"###,###,###,###" )
                    
                    )
                    
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && !varSubtotalProd,true, false)
                Width: =171
                X: =1061
                Y: =TextInput14_1.Height + 10
                ZIndex: =8

            TextInput14_4 As text:
                BorderColor: =If(IsBlank(TextInput14_4.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="Production Amount"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && !varSubtotalProd,true, false)
                Width: =200
                X: =700
                Y: =TextInput14_1.Height + 10
                ZIndex: =9

            TextInput14_5 As text:
                BorderColor: =If(IsBlank(TextInput14_5.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="hL"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && !varSubtotalProd,true, false)
                Width: =90
                X: =960
                Y: =TextInput14_1.Height + 10
                ZIndex: =10

            TextInput13 As text:
                BorderColor: =If(IsBlank(TextInput13.Text),Red,RGBA(230, 230, 230, 1))
                Default: =""
                OnSelect: =Select(Parent)
                Visible: |
                    =If(CountRows(Filter('Line Name Production from Etika SC Table',ID=ThisItem.ID)) = 0, true, false)
                Width: =405
                X: =33
                Y: =2
                ZIndex: =11

            Circle4_2 As circle:
                Fill: |+
                    =If(
                    IsBlank('Production-Text'.Selected.FuelType) || IsBlank(TextInput14.Text) || IsBlank(TextInput19_12.Text)&& Dropdown7.Visible=false && TextInput13.Visible=false, Orange,
                    
                    Green
                    
                    )
                    
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If('Production-Text'.Visible &&  !varSubtotalProd,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =13

            Label32_2 As label:
                OnSelect: =Select(Parent)
                Text: =If(Circle4_6.Fill = Orange,0,1)
                Visible: =false
                Width: =64
                X: =386
                Y: =10
                ZIndex: =14

            Dropdown7 As dropdown:
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Items: =Distinct(Filter('Coefficients for G-KPI Calculation', Coefficient="Product"),Unit)
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         IsBlank(LookUp('Line Name Production from Etika SC Table', ID = ThisItem.ID))  &&  TextInput19_12.Visible,true,false
                         
                         )
                Width: =90
                X: =960
                Y: =2
                ZIndex: =15

            Circle4_6 As circle:
                Fill: |+
                    =If(
                    IsBlank(TextInput13.Text) || IsBlank(Dropdown7.Selected.Result) || IsBlank(TextInput19_12.Text) || IsBlank(TextInput14.Text), Orange,
                    
                    Green
                    
                    )
                    
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If(Dropdown7.Visible &&  !varSubtotalProd,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =16

            Label18 As label:
                OnSelect: =Select(Parent)
                Text: =ThisItem.ID
                Visible: =false
                Width: =89
                X: =352
                Y: =10
                ZIndex: =17

            Label3 As label:
                FontWeight: =Semibold
                OnSelect: =Select(Parent)
                Text: |-
                    =If(
                    ThisItem.ID = 1,
                    "CSD",
                    ThisItem.ID = 2,
                    "NCB",
                    ThisItem.ID = 3,
                    "EVAP",
                    ThisItem.ID = 4,
                    "SCM",
                    ThisItem.ID = 5,
                    "UHT",
                    ThisItem.ID = 6,
                    "Line A & B",
                    ThisItem.ID = 7,
                    "Line 1")
                X: =60
                Y: =2
                ZIndex: =18

        "'Gallery-Fuel' As gallery.variableTemplateHeightGallery":
            Height: |
                =CountRows('Gallery-Fuel'.AllItems)*40*Value(CountRows(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient = CoefficientUtil_1.Text).Coefficient))+80
            Items: =Filter(colUtilities, varDefault in BU.Value && Coefficient = CoefficientUtil_1.Text && Status = "Approved")
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplateSize: =206
            Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel,true, false)
            Width: =1250
            Y: =58
            ZIndex: =36

            Dropdown10 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank(Dropdown10.Selected.Title),Red,RGBA(230, 230, 230, 1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Items: =Filter('Coefficients for G-KPI Calculation',Coefficient=CoefficientUtil_1.Text && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).Title
                OnChange: |-
                    =If(CountIf(colFuelMY, ID= ThisItem.ID) =0,
                    Collect(colFuelMY,{Amount:Value(TextInput18_1.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput16_1.Text, UtilitiesType:Dropdown10.Selected.Title, AmountConversion: Value('Conversion-Fuel-MJ'.Text), AmountCO2: Value('Conversion-Fuel-CO2'.Text), ID: ThisItem.ID, UnitCO2:TextInput11_8.Text}),
                    Patch(colFuelMY,
                                 First(
                                    Filter(colFuelMY,
                                     ID= ThisItem.ID)),
                                        {
                                           Amount:Value(TextInput18_1.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput16_1.Text, UtilitiesType:Dropdown10.Selected.Title, AmountConversion: Value('Conversion-Fuel-MJ'.Text), AmountCO2: Value('Conversion-Fuel-CO2'.Text), UnitCO2:TextInput11_8.Text
                                           }
                              ));
                    
                    If(CountIf(colCO2EMY, 
                    ID= LookUp(colUtilities, 'CO2-E'="Emissions Based On Energy Consumption" && varDefault in BU.Value).ID) = 0,
                    Collect(colCO2EMY,{AmountFuel:Sum(Filter(colFuelMY,UnitCO2="kg-CO2e"),AmountCO2), AmountElec:Sum(Filter(colElecHLMY,UnitCO2="kg-CO2e"),AmountCO2), Unit:"kg-CO2e", Utilities: "CO2-E", UtilitiesType: "Emissions Based On Energy Consumption", ID: LookUp(colUtilities, 'CO2-E'="Emissions Based On Energy Consumption").ID, DataType: "Emissions by Fuel"}),
                    Patch(colCO2EMY,First(
                                    Filter(colCO2EMY,ID= ThisItem.ID)),
                                    {AmountFuel:Sum(Filter(colFuelMY,UnitCO2="kg-CO2e"),AmountCO2), AmountElec:Sum(Filter(colElecHLMY,UnitCO2="kg-CO2e"),AmountCO2), Unit:"kg-CO2e", Utilities: "CO2-E", UtilitiesType: "Emissions Based On Energy Consumption"}))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =410
                X: =32
                Y: =2
                ZIndex: =1

            TextInput15_1 As text:
                BorderColor: =If(IsBlank(TextInput15_1.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="Purchased Fuel Amount"
                DisplayMode: |
                    =If(!IsBlank(TextInput19.Text),
                    DisplayMode.View,DisplayMode.Edit)
                Fill: =If(TextInput15_1.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =387
                X: =459
                Y: =1
                ZIndex: =2

            TextInput16_1 As text:
                BorderColor: =If(IsBlank(TextInput16_1.Text),Red,RGBA(230, 230, 230, 1))
                Default: |-
                    =If(IsBlank(Dropdown10.Selected.Title),"mmBtu",
                    
                    LookUp('Coefficients for G-KPI Calculation',Title=Dropdown10.Selected.Title).Unit
                    
                    )
                DisplayMode: |
                    =If(!IsBlank(TextInput19.Text),
                    DisplayMode.View,DisplayMode.Edit)
                Fill: =If(TextInput16_1.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: |-
                    =If(
                         !IsBlank(LookUp('Utilities for G-KPI Calculation', ID = ThisItem.ID && Coefficient=CoefficientUtil_1.Text)) && !varSubtotalFuel,true,false
                         
                         )
                Width: =90
                X: =900
                Y: =1
                ZIndex: =3

            TextInput18_1 As text:
                BorderColor: =If(IsBlank(TextInput18_1.Text),Red,RGBA(230, 230, 230, 1))
                Default: =
                DisplayMode: |
                    =DisplayMode.Edit
                Format: =TextFormat.Number
                OnChange: |-
                    =If(CountIf(colFuelMY, ID= ThisItem.ID) =0,
                    Collect(colFuelMY,{Amount:Value(TextInput18_1.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput16_1.Text, UtilitiesType:Dropdown10.Selected.Title, AmountConversion: Value('Conversion-Fuel-MJ'.Text), AmountCO2: Value('Conversion-Fuel-CO2'.Text), ID: ThisItem.ID, UnitCO2:TextInput11_8.Text}),
                    Patch(colFuelMY,
                                 First(
                                    Filter(colFuelMY,
                                     ID= ThisItem.ID)),
                                        {
                                           Amount:Value(TextInput18_1.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput16_1.Text, UtilitiesType:Dropdown10.Selected.Title, AmountConversion: Value('Conversion-Fuel-MJ'.Text), AmountCO2: Value('Conversion-Fuel-CO2'.Text), UnitCO2:TextInput11_8.Text
                                           }
                              ));
                    
                    If(CountIf(colCO2EMY, 
                    ID= LookUp(colUtilities, FuelType="Emissions Based On Energy Consumption" && varDefault in BU.Value).ID) = 0,
                    Collect(colCO2EMY,{AmountFuel:Sum(Filter(colFuelMY,UnitCO2="kg-CO2e"),AmountCO2), AmountElec:Sum(Filter(colElecHLMY,UnitCO2="kg-CO2e"),AmountCO2), Unit:"kg-CO2e", Utilities: "CO2-E", UtilitiesType: "Emissions Based On Energy Consumption", ID: LookUp(colUtilities, 'CO2-E'="Emissions Based On Energy Consumption").ID, DataType: "Emissions by Fuel"}),
                    Patch(colCO2EMY,First(
                    Filter(colCO2EMY,ID= LookUp(colUtilities, FuelType="Emissions Based On Energy Consumption" && varDefault in BU.Value).ID)),
                    {AmountFuel:Sum(Filter(colFuelMY,UnitCO2="kg-CO2e"),AmountCO2), AmountElec:Sum(Filter(colElecHLMY,UnitCO2="kg-CO2e"),AmountCO2), Unit:"kg-CO2e", Utilities: "CO2-E", UtilitiesType: "Emissions Based On Energy Consumption"}))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =171
                X: =1057
                ZIndex: =4

            TextInput19 As text:
                Default: =ThisItem.FuelType
                OnSelect: =Select(Parent)
                Visible: =false
                X: =60
                Y: =2
                ZIndex: =11

            TextInput20 As text:
                BorderColor: =If(IsBlank(TextInput20.Text),Red,RGBA(230, 230, 230, 1))
                Default: =""
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =405
                X: =33
                Y: =2
                ZIndex: =12

            TextInput11 As text:
                BorderColor: =If(IsBlank(TextInput11.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="Purchased Fuel Amount"
                DisplayMode: =DisplayMode.View
                Fill: =If(TextInput11.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =387
                X: =459
                Y: =50
                ZIndex: =13

            TextInput11_2 As text:
                BorderColor: =If(IsBlank(TextInput11_2.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="MJ"
                DisplayMode: =DisplayMode.View
                Fill: =If(TextInput11_2.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =90
                X: =900
                Y: =50
                ZIndex: =15

            "'Conversion-Fuel-MJ' As text":
                BorderColor: =If(IsBlank('Conversion-Fuel-MJ'.Text),Red,RGBA(230, 230, 230, 1))
                Default: |-
                    =If(
                        
                    !IsBlank(Dropdown10.Selected.Title) && Dropdown10.Selected.Title <> "Natural Gas or Liquefied Gas (NG/LNG)",
                    
                    Text(Value(TextInput18_1.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title =Dropdown10.Selected.Title && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" ),
                    
                    IsBlank(Dropdown10.Selected.Title) && Dropdown6.Selected.Result = "mmBtu", 
                    
                    Text(Value(TextInput18_1.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title = "mmBtu" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" ),
                    
                    IsBlank(Dropdown10.Selected.Title) && Dropdown6.Selected.Result <> "mmBtu", Text(Value(TextInput18_1.Text)*1,"#,###,###" ),
                    
                    Text(Value(TextInput18_1.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title = "mmBtu" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" ),
                    
                    !IsBlank(Dropdown10.Selected.Title) && Dropdown10.Selected.Title = "Natural Gas or Liquefied Gas (NG/LNG)",
                    Text(Value(TextInput18_1.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title ="mmBtu" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" )
                    )
                DisplayMode: =DisplayMode.View
                Fill: =If('Conversion-Fuel-MJ'.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =171
                X: =1057
                Y: =50
                ZIndex: =16

            TextInput11_4 As text:
                BorderColor: =If(IsBlank(TextInput11_4.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="CO2 Emissions"
                DisplayMode: =DisplayMode.View
                Fill: =If(TextInput11_4.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =387
                X: =459
                Y: =95
                ZIndex: =17

            TextInput11_5 As text:
                BorderColor: =If(IsBlank(TextInput11_5.Text),Red,RGBA(230, 230, 230, 1))
                Default: =""
                DisplayMode: =DisplayMode.View
                Fill: =If(TextInput11_5.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =false
                Width: =90
                X: =860
                Y: =95
                ZIndex: =18

            TextInput11_8 As text:
                BorderColor: =If(IsBlank(TextInput11_8.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="kg-CO2e"
                DisplayMode: =DisplayMode.View
                Fill: =If(TextInput11_8.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =90
                X: =900
                Y: =95
                ZIndex: =19

            "'Conversion-Fuel-CO2' As text":
                BorderColor: =If(IsBlank('Conversion-Fuel-CO2'.Text),Red,RGBA(230, 230, 230, 1))
                Default: =Value(TextInput18_1.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title =Dropdown10.Selected.Title && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit CO2 Emmission (Fuel) Value')
                DisplayMode: =DisplayMode.View
                Fill: =If('Conversion-Fuel-CO2'.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =171
                X: =1057
                Y: =95
                ZIndex: =20

            Circle4_1 As circle:
                Fill: |-
                    =If(
                    
                    IsBlank(Dropdown10.Selected.Title) || IsBlank(TextInput18_1.Text), Orange, 
                    
                    
                    Green)
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =21

            Label32_1 As label:
                Height: =64
                OnSelect: =Select(Parent)
                Text: =If(Circle4_7.Fill = Orange,0,1)
                Visible: =false
                Width: =70
                X: =10
                Y: =16
                ZIndex: =22

            Dropdown6 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Items: =Distinct(Filter('Coefficients for G-KPI Calculation', Coefficient=CoefficientUtil_1.Text),Unit)
                OnChange: |-
                    =If(CountIf(colFuelMY, ID= ThisItem.ID) =0,
                    Collect(colFuelMY,{Amount:Value(TextInput18_1.Text), Utilities: CoefficientUtil_1.Text, Unit: Dropdown6.Selected.Result, UtilitiesType:TextInput19.Text, AmountConversion: Value('Conversion-Fuel-MJ'.Text), AmountCO2: Value('Conversion-Fuel-CO2'.Text), ID: ThisItem.ID, UnitCO2:TextInput11_8.Text}),
                    Patch(colFuelMY,
                                 First(
                                    Filter(colFuelMY,
                                     ID= ThisItem.ID)),
                                        {
                                           Amount:Value(TextInput18_1.Text), Utilities: CoefficientUtil_1.Text, Unit: Dropdown6.Selected.Result, UtilitiesType:TextInput19.Text, AmountConversion: Value('Conversion-Fuel-MJ'.Text), AmountCO2: Value('Conversion-Fuel-CO2'.Text), ID: ThisItem.ID, UnitCO2:TextInput11_8.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         !IsBlank(LookUp('Utilities for G-KPI Calculation', ID = ThisItem.ID && Coefficient=CoefficientUtil_1.Text)),false,true
                         
                         )
                Width: =114
                X: =900
                Y: =2
                ZIndex: =23

            Circle4_7 As circle:
                Fill: |-
                    =If(
                    
                    IsBlank(Dropdown10.Selected.Title) || IsBlank(TextInput15_1.Text) || IsBlank(TextInput16_1.Text) || IsBlank(TextInput18_1.Text)
                        
                        
                    ,Orange, 
                    
                    
                    Green)
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =24

            Label33 As label:
                OnSelect: =Select(Parent)
                Text: =ThisItem.ID
                Visible: =false
                X: =40
                Y: =40
                ZIndex: =25

        "'Gallery-Electricity' As gallery.variableTemplateHeightGallery":
            Height: |
                =CountRows('Gallery-Electricity'.AllItems)*40*Value(CountRows(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient = CoefficientUtil_1.Text).Coefficient))
            Items: |+
                =Filter(colUtilities, varDefault in BU.Value && Coefficient = CoefficientUtil_1.Text && Status = "Approved")
                
                
                
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplateSize: =280
            Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec,true,false)
            Width: =1250
            Y: =56
            ZIndex: =52

            Electricity As text:
                BorderColor: =If(IsBlank(Electricity.Text),Red,RGBA(230, 230, 230, 1))
                Default: =ThisItem.FuelType
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(Self.DisplayMode=DisplayMode.Edit,White,Transparent)
                OnChange: |-
                    =If(CountIf(colElecHLMY,  ID= ThisItem.ID) =0,
                    Collect(colElecHLMY,{Amount:Value(TextInput19_9.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_8.Text, UtilitiesType: Electricity.Text, DataType: TextInput19_4.Text, DataTypeEnergyAmt: 'Elec-PurchasedEnergy-DT_1'.Text, AmountEnergy:Value('Elec-Amt-Energy_1'.Text), DataTypeCO2Emissions: 'Elec-CO2-DT_1'.Text, AmountCO2:Value('Elec-Amt-CO2_1'.Text), ID: ThisItem.ID, UnitCO2: 'Elec-Unit-CO2_1'.Text}),
                    Patch(colElecHLMY,
                                 First(
                                    Filter(colElecHLMY,
                                        ID= ThisItem.ID)),
                                        {
                                           Amount:Value(TextInput19_9.Text), AmountEnergy:Value('Elec-Amt-Energy_1'.Text), 
                                           AmountCO2:Value('Elec-Amt-CO2_1'.Text),UtilitiesType: Electricity.Text,UnitCO2: 'Elec-Unit-CO2_1'.Text,
                                           DataType: TextInput19_4.Text,  Unit: TextInput19_8.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =401
                X: =36
                ZIndex: =1

            TextInput19_4 As text:
                BorderColor: =If(IsBlank(TextInput19_4.Text),Red,RGBA(230, 230, 230, 1))
                Default: =ThisItem.DataType
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', Electricity = ThisItem.Electricity)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(TextInput19_4.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colElecHLMY,  ID= ThisItem.ID) =0,
                    Collect(colElecHLMY,{Amount:Value(TextInput19_9.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_8.Text, UtilitiesType: Electricity.Text, DataType: TextInput19_4.Text, DataTypeEnergyAmt: 'Elec-PurchasedEnergy-DT_1'.Text, AmountEnergy:Value('Elec-Amt-Energy_1'.Text), DataTypeCO2Emissions: 'Elec-CO2-DT_1'.Text, AmountCO2:Value('Elec-Amt-CO2_1'.Text), ID: ThisItem.ID, UnitCO2: 'Elec-Unit-CO2_1'.Text}),
                    Patch(colElecHLMY,
                                 First(
                                    Filter(colElecHLMY,
                                        ID= ThisItem.ID)),
                                        {
                                           Amount:Value(TextInput19_9.Text), AmountEnergy:Value('Elec-Amt-Energy_1'.Text), 
                                           AmountCO2:Value('Elec-Amt-CO2_1'.Text),UtilitiesType: Electricity.Text,UnitCO2: 'Elec-Unit-CO2_1'.Text,
                                           DataType: TextInput19_4.Text,  Unit: TextInput19_8.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =308
                X: =459
                ZIndex: =2

            TextInput19_8 As text:
                BorderColor: =If(IsBlank(TextInput19_8.Text),Red,RGBA(230, 230, 230, 1))
                Default: =If(Self.Visible,ThisItem.Unit,Dropdown7_1.Selected.Result)
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', Electricity = ThisItem.Electricity)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(TextInput19_8.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colElecHLMY,  ID= ThisItem.ID) =0,
                    Collect(colElecHLMY,{Amount:Value(TextInput19_9.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_8.Text, UtilitiesType: Electricity.Text, DataType: TextInput19_4.Text, DataTypeEnergyAmt: 'Elec-PurchasedEnergy-DT_1'.Text, AmountEnergy:Value('Elec-Amt-Energy_1'.Text), DataTypeCO2Emissions: 'Elec-CO2-DT_1'.Text, AmountCO2:Value('Elec-Amt-CO2_1'.Text), ID: ThisItem.ID, UnitCO2: 'Elec-Unit-CO2_1'.Text}),
                    Patch(colElecHLMY,
                                 First(
                                    Filter(colElecHLMY,
                                        ID= ThisItem.ID)),
                                        {
                                           Amount:Value(TextInput19_9.Text), AmountEnergy:Value('Elec-Amt-Energy_1'.Text), 
                                           AmountCO2:Value('Elec-Amt-CO2_1'.Text),UtilitiesType: Electricity.Text,UnitCO2: 'Elec-Unit-CO2_1'.Text,
                                           DataType: TextInput19_4.Text,  Unit: TextInput19_8.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec && !Dropdown7_1.Visible,true,false)
                Width: =189
                X: =859
                ZIndex: =3

            TextInput19_9 As text:
                BorderColor: =If(IsBlank(TextInput19_9.Text),Red,RGBA(230, 230, 230, 1))
                Default: =""
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colElecHLMY,  ID= ThisItem.ID) =0,
                    Collect(colElecHLMY,{Amount:Value(TextInput19_9.Text), Utilities: CoefficientUtil_1.Text, Unit: TextInput19_8.Text, UtilitiesType: Electricity.Text, DataType: TextInput19_4.Text, DataTypeEnergyAmt: 'Elec-PurchasedEnergy-DT_1'.Text, AmountEnergy:Value('Elec-Amt-Energy_1'.Text), DataTypeCO2Emissions: 'Elec-CO2-DT_1'.Text, AmountCO2:Value('Elec-Amt-CO2_1'.Text), ID: ThisItem.ID, UnitCO2: 'Elec-Unit-CO2_1'.Text}),
                    Patch(colElecHLMY,
                                 First(
                                    Filter(colElecHLMY,
                                        ID= ThisItem.ID)),
                                        {
                                           Amount:Value(TextInput19_9.Text), AmountEnergy:Value('Elec-Amt-Energy_1'.Text), 
                                           AmountCO2:Value('Elec-Amt-CO2_1'.Text),UtilitiesType: Electricity.Text,UnitCO2: 'Elec-Unit-CO2_1'.Text,
                                           DataType: TextInput19_4.Text,  Unit: TextInput19_8.Text
                                           }
                              ));
                    
                    If(CountIf(colCO2EMY, 
                    ID= LookUp(colUtilities, 'CO2-E'="Emissions Based On Energy Consumption" && varDefault in BU.Value).ID) = 0,
                    Collect(colCO2EMY,{AmountFuel:Sum(Filter(colFuelMY,UnitCO2="kg-CO2e"),AmountCO2), AmountElec:Sum(Filter(colElecHLMY,UnitCO2="kg-CO2e"),AmountCO2), Unit:"kg-CO2e", Utilities: "CO2-E", UtilitiesType: "Emissions Based On Energy Consumption", ID: LookUp(colUtilities, 'CO2-E'="Emissions Based On Energy Consumption").ID, DataType: "Emissions by Fuel"}),
                    Patch(colCO2EMY,First(
                                    Filter(colCO2EMY,
                                    ID= LookUp(colUtilities, 'CO2-E'="Emissions Based On Energy Consumption" && varDefault in BU.Value).ID)),
                                    {AmountFuel:Sum(Filter(colFuelMY,UnitCO2="kg-CO2e"),AmountCO2), AmountElec:Sum(Filter(colElecHLMY,UnitCO2="kg-CO2e"),AmountCO2), Unit:"kg-CO2e", Utilities: "CO2-E", UtilitiesType: "Emissions Based On Energy Consumption"}))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =171
                X: =1057
                ZIndex: =4

            "'Elec-PurchasedEnergy-DT_1' As text":
                Default: =If(Electricity.Text = "Renewable (e.g. Solar)" || Electricity.Text = "In-House excl. Renewable (e.g. CoGen)","Generated Energy Amount","Purchased Energy Amount")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =387
                X: =459
                Y: =TextInput19_4.Height
                ZIndex: =5

            "'Elec-CO2-DT_1' As text":
                Default: ="CO2 Emissions"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =387
                X: =459
                Y: ='Elec-PurchasedEnergy-DT_1'.Height+40
                ZIndex: =6

            "'Elec-Unit-Energy_1' As text":
                Default: ="MJ"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =167
                X: =859
                Y: =TextInput19_4.Height
                ZIndex: =7

            "'Elec-Amt-Energy_1' As text":
                Default: =Value(TextInput19_9.Text)*LookUp('Coefficients for G-KPI Calculation',Title ="kWh" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =167
                X: =1061
                Y: =TextInput19_4.Height
                ZIndex: =8

            "'Elec-Unit-CO2_1' As text":
                Default: ="kg-CO2e"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =200
                X: =859
                Y: ='Elec-PurchasedEnergy-DT_1'.Height+40
                ZIndex: =9

            "'Elec-Amt-CO2_1' As text":
                Default: =Value(TextInput19_9.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Unit ="kWh" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit CO2 Emmission (Fuel) Value')
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =167
                X: =1061
                Y: ='Elec-PurchasedEnergy-DT_1'.Height+40
                ZIndex: =10

            Circle4 As circle:
                Fill: =If(IsBlank(Electricity.Text) || IsBlank(TextInput19_4.Text) || IsBlank(TextInput19_8.Text) || IsBlank(TextInput19_9.Text), Orange, Green)
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =11

            Label32 As label:
                OnSelect: =Select(Parent)
                Text: =If(Circle4.Fill = Orange,0,1)
                Visible: =false
                Width: =64
                X: =362
                ZIndex: =12

            Dropdown7_1 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =""
                Items: =Distinct(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient=CoefficientUtil_1.Text),Unit)
                OnChange: |-
                    =If(CountIf(colElecHLMY,  ID= ThisItem.ID) =0,
                    Collect(colElecHLMY,{Amount:Value(TextInput19_9.Text), Utilities: CoefficientUtil_1.Text, Unit: Dropdown7_1.Selected.Result, UtilitiesType: Electricity.Text, DataType: TextInput19_4.Text, DataTypeEnergyAmt: 'Elec-PurchasedEnergy-DT_1'.Text, AmountEnergy:Value('Elec-Amt-Energy_1'.Text), DataTypeCO2Emissions: 'Elec-CO2-DT_1'.Text, AmountCO2:Value('Elec-Amt-CO2_1'.Text), ID: ThisItem.ID, UnitCO2: 'Elec-Unit-CO2_1'.Text}),
                    Patch(colElecHLMY,
                                 First(
                                    Filter(colElecHLMY,
                                        ID= ThisItem.ID)),
                                        {
                                        Amount:Value(TextInput19_9.Text), AmountEnergy:Value('Elec-Amt-Energy_1'.Text), 
                                        AmountCO2:Value('Elec-Amt-CO2_1'.Text),UtilitiesType: Electricity.Text,UnitCO2: 'Elec-Unit-CO2_1'.Text,
                                        Unit: Dropdown7_1.Selected.Result
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         !IsBlank(LookUp('Utilities for G-KPI Calculation', ID = ThisItem.ID && Coefficient=CoefficientUtil_1.Text)),false,true
                         
                         )
                Width: =90
                X: =859
                ZIndex: =13

        "'Add-CPP_1' As group":
            Height: =5
            Width: =5
            X: =30
            Y: =40
            ZIndex: =52

            "'Add-bttn-CPP_1' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Water",Collect(colUtilities,{Water:"", BU:Table({Value: varDefault}), DataType:"Water Consumption", Unit:"", ID: CountRows(Filter(colUtilities,varDefault in BU.Value).Water)+1, Coefficient: CoefficientUtil_1.Text}),
                    
                    CoefficientUtil_1.Text = "Fuel",Collect(colUtilities,{BU:Table({Value: varDefault}), DataType:"Purchased Fuel Amount", Unit:"", ID: CountRows(Filter(colUtilities,varDefault in BU.Value).FuelTest)+1, Coefficient: CoefficientUtil_1.Text}),
                    
                    CoefficientUtil_1.Text = "Production",Collect(colUtilities,{ProductType:"", BU:Table({Value: varDefault}), DataType:"Production Amount", Unit:"", ID: CountRows(Filter(colUtilities,varDefault in BU.Value).FuelTest)+1, Coefficient: CoefficientUtil_1.Text})
                    
                    )
                    
                PaddingLeft: =30
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =false
                Width: =80
                X: =15
                Y: |-
                    =If(
                    CoefficientUtil_1.Text = "Electricity",'Gallery-Electricity'.Height + 80,
                    CoefficientUtil_1.Text = "Water",'Gallery-Water'.Height + 40,
                    CoefficientUtil_1.Text = "Fuel",'Gallery-Fuel'.Height + 40,
                    CoefficientUtil_1.Text = "CO2-C",'Gallery-CO2-C'.Height,
                    CoefficientUtil_1.Text = "Production",'Gallery-Production'.Height + 40
                    )
                ZIndex: =50

            Icon22_25 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Water",Collect(colUtilities,{Water:"", BU:Table({Value: varDefault}), DataType:"Water Consumption", Unit:"", ID: CountRows(Filter(colUtilities,varDefault in BU.Value).Water)+1, Coefficient: CoefficientUtil_1.Text}),
                    
                    CoefficientUtil_1.Text = "Fuel",Collect(colUtilities,{BU:Table({Value: varDefault}), DataType:"Purchased Fuel Amount", Unit:"", ID: CountRows(Filter(colUtilities,varDefault in BU.Value).FuelTest)+1, Coefficient: CoefficientUtil_1.Text}),
                    
                    CoefficientUtil_1.Text = "Production",Collect(colUtilities,{ProductType:"", BU:Table({Value: varDefault}), DataType:"Production Amount", Unit:"", ID: CountRows(Filter(colUtilities,varDefault in BU.Value).FuelTest)+1, Coefficient: CoefficientUtil_1.Text})
                    
                    )
                    
                Visible: =false
                Width: =28
                X: =10
                Y: |
                    =If(
                    CoefficientUtil_1.Text = "Electricity",'Gallery-Electricity'.Height + 90,
                    CoefficientUtil_1.Text = "Water",'Gallery-Water'.Height + 50,
                    CoefficientUtil_1.Text = "Fuel",'Gallery-Fuel'.Height + 50,
                    CoefficientUtil_1.Text = "CO2-C",'Gallery-CO2-C'.Height + 10,
                    CoefficientUtil_1.Text = "Production",'Gallery-Production'.Height + 50
                    )
                ZIndex: =51

        "'Add-Water' As group":
            Height: =5
            Width: =5
            X: =30
            Y: =40
            ZIndex: =66

            "'Add-bttn-CPP_2' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Water",Collect(colUtilities,{Water:"", BU:Table({Value: varDefault}), DataType:"Water Consumption", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "Water", Status: "Approved"})
                    
                    )
                    
                PaddingLeft: =0
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(CoefficientUtil_1.Text="Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =80
                X: =43
                Y: ='Gallery-Water'.Height + Water.Height
                ZIndex: =64

            Icon22_27 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Water",Collect(colUtilities,{Water:"", BU:Table({Value: varDefault}), DataType:"Water Consumption", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "Water", Status: "Approved"})
                    
                    )
                    
                Visible: =If(CoefficientUtil_1.Text="Water" && varGalWater && !varSubtotalWater,true,false)
                Width: =28
                X: =10
                Y: ='Gallery-Water'.Height + Water.Height + 12
                ZIndex: =65

        "'Add-Production' As group":
            Height: =5
            Width: =5
            X: =20
            Y: =60
            ZIndex: =68

            "'Add-bttn-CPP_3' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Production",Collect(colUtilities,{ProductType:"", BU:Table({Value: varDefault}), DataType:"Production Amount", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "Production", Status: "Approved"})
                    
                    )
                    
                PaddingLeft: =30
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =false
                Width: =80
                X: =45
                Y: ='Gallery-Production'.Height+40
                ZIndex: =66

            Icon22_28 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Production",Collect(colUtilities,{ProductType:"", BU:Table({Value: varDefault}), DataType:"Production Amount", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "Production", Status: "Approved"})
                    
                    )
                    
                Visible: =false
                Width: =28
                X: =40
                Y: ='Gallery-Production'.Height+50
                ZIndex: =67

        "'Add-Fuel' As group":
            Height: =5
            Width: =5
            X: =70
            Y: =80
            ZIndex: =70

            "'Add-bttn-CPP_4' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Fuel",Collect(colUtilities,{BU:Table({Value: varDefault}), DataType:"Purchased Fuel Amount", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: CoefficientUtil_1.Text, Status: "Approved"})
                    
                    )
                    
                PaddingLeft: =0
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(CoefficientUtil_1.Text="Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =80
                X: =43
                Y: ='Gallery-Fuel'.Height + Dropdown10.Height
                ZIndex: =68

            Icon22_29 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Fuel",Collect(colUtilities,{BU:Table({Value: varDefault}), DataType:"Purchased Fuel Amount", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: CoefficientUtil_1.Text, Status: "Approved"})
                    
                    )
                    
                Visible: =If(CoefficientUtil_1.Text="Fuel" && varGalFuel && !varSubtotalFuel,true,false)
                Width: =28
                X: =10
                Y: ='Gallery-Fuel'.Height + Dropdown10.Height + 12
                ZIndex: =69

        "'Add-Electricity' As group":
            Height: =5
            Width: =5
            X: =20
            Y: =60
            ZIndex: =72

            "'Add-bttn-CPP_5' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |-
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Electricity",Collect(colUtilities,{Electricity:"", BU:Table({Value: varDefault}), DataType:"Purchased Electricity Amount", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "Electricity", Status: "Approved"})
                    
                    );
                PaddingLeft: =0
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(CoefficientUtil_1.Text="Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =80
                X: =43
                Y: ='Gallery-Electricity'.Height + Electricity.Height
                ZIndex: =70

            Icon22_30 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |-
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "Electricity",Collect(colUtilities,{Electricity:"", BU:Table({Value: varDefault}), DataType:"Purchased Electricity Amount", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "Electricity", Status: "Approved"})
                    
                    );
                Visible: =If(CoefficientUtil_1.Text="Electricity" && varGalElec && !varSubtotalElec,true,false)
                Width: =28
                X: =10
                Y: ='Gallery-Electricity'.Height + Electricity.Height + 12
                ZIndex: =71

        "'Subtotal-Icon-Elec' As icon.ListScrollWatchlist":
            Color: =RGBA(128, 128, 128, 1)
            Height: =29
            Icon: =Icon.ListScrollWatchlist
            OnSelect: =Set(varSubtotalElec,!varSubtotalElec);
            Tooltip: ="Subtotal"&" "&CoefficientUtil_1.Text
            Visible: =If(CoefficientUtil_1.Text="Electricity",true,false)
            Width: =29
            X: =1131
            Y: =14
            ZIndex: =73

        "'Subtotal-Icon-Water' As icon.ListScrollWatchlist":
            Color: =RGBA(128, 128, 128, 1)
            Height: =29
            Icon: =Icon.ListScrollWatchlist
            OnSelect: =Set(varSubtotalWater,!varSubtotalWater)
            Tooltip: ="Subtotal"&" "&CoefficientUtil_1.Text
            Visible: =If(CoefficientUtil_1.Text="Water",true,false)
            Width: =29
            X: ='Subtotal-Icon-Elec'.X
            Y: ='Subtotal-Icon-Elec'.Y
            ZIndex: =74

        "'Subtotal-Elec' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =74

            "'Subtotal-Elec-DataType' As label":
                AutoHeight: =true
                Height: |
                    =40
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Purchased Electricity Amount"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: =464
                Y: =66
                ZIndex: =13

            "'Subtotal-Elec-Unit' As label":
                AutoHeight: =true
                Height: |
                    =40
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="kWh"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: =864
                Y: =66
                ZIndex: =14

            "'Subtotal-Elec-Amt' As label":
                AutoHeight: =true
                Height: |
                    =40
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(LookUp(colElecHLMY,DataType="Purchased Electricity Amount").Amount),"0",
                    LookUp(colElecHLMY,DataType="Purchased Electricity Amount").Amount)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =170
                X: =1066
                Y: =66
                ZIndex: =15

            "'Subtotal-Elec-Text' As label":
                AutoHeight: =true
                Height: |
                    =40
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Subtotal"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                X: =10
                Y: =66
                ZIndex: =16

            "'Subtotal-Ener-DataType' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Purchased Energy Amount"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: ='Subtotal-Elec-DataType'.X
                Y: =102
                ZIndex: =17

            "'Subtotal-Ener-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="MJ"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: ='Subtotal-Elec-Unit'.X
                Y: =102
                ZIndex: =18

            "'Subtotal-Ener-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(LookUp(colElecHLMY,DataType="Purchased Electricity Amount").AmountEnergy),"0",
                    
                    LookUp(colElecHLMY,DataType="Purchased Electricity Amount").AmountEnergy)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =170
                X: ='Subtotal-Elec-Amt'.X
                Y: =102
                ZIndex: =19

            "'Subtotal-Overall-Elec-DT' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Ref. Overall Elc. Consumption"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: ='Subtotal-Elec-DataType'.X
                Y: =138
                ZIndex: =20

            "'Subtotal-Overall-Elec-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="kWh"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: ='Subtotal-Elec-Unit'.X
                Y: =138
                ZIndex: =21

            "'Subtotal-Overall-Elec-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colElecHLMY,Amount)),"0",
                    
                    Sum(colElecHLMY,Amount))
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =170
                X: ='Subtotal-Elec-Amt'.X
                Y: =138
                ZIndex: =22

            "'Subtotal-Overall-Ener-DT' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Ref. Overall Ene. Consumption"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =270
                X: ='Subtotal-Elec-DataType'.X
                Y: =174
                ZIndex: =23

            "'Subtotal-Overall-Ener-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="MJ"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: ='Subtotal-Elec-Unit'.X
                Y: =174
                ZIndex: =24

            "'Subtotal-Overall-Ener-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colElecHLMY,AmountEnergy)),"0",
                    
                    Sum(colElecHLMY,AmountEnergy))
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =170
                X: ='Subtotal-Elec-Amt'.X
                Y: =174
                ZIndex: =25

            "'Subtotal-Overall-Ener-Ratio-DT' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Ref. Renewable Energy Ratio"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =270
                X: ='Subtotal-Elec-DataType'.X
                Y: =210
                ZIndex: =26

            "'Subtotal-Overall-Ener-Ratio-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="%"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: ='Subtotal-Elec-Unit'.X
                Y: =210
                ZIndex: =27

            "'Subtotal-Overall-Ener-Ratio-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: =LookUp(colElecHLMY,UtilitiesType="Renewable (e.g. Solar)").Amount/Sum(colElecHLMY,Amount)*100
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =170
                X: ='Subtotal-Elec-Amt'.X
                Y: =210
                ZIndex: =28

            "'Subtotal-CO2-DT' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="CO2 Emissions"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =270
                X: ='Subtotal-Elec-DataType'.X
                Y: =246
                ZIndex: =29

            "'Subtotal-CO2-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="kg-CO2e"
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =257
                X: ='Subtotal-Elec-Unit'.X
                Y: =246
                ZIndex: =30

            "'Subtotal-CO2-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: =Value(LookUp(colElecHLMY,UtilitiesType <> "Renewable (e.g. Solar)" && UtilitiesType <> "In-House excl. Renewable (e.g. CoGen)").AmountCO2)
                Visible: =If(CoefficientUtil_1.Text = "Electricity" && varGalElec && varSubtotalElec,true,false)
                Width: =170
                X: ='Subtotal-Elec-Amt'.X
                Y: =246
                ZIndex: =31

        "'Subtotal-Icon-COC' As icon.ListScrollWatchlist":
            Color: =RGBA(128, 128, 128, 1)
            Height: =29
            Icon: =Icon.ListScrollWatchlist
            OnSelect: =Set(varSubtotalCOC,!varSubtotalCOC)
            Tooltip: ="Subtotal"&" "&CoefficientUtil_1.Text
            Visible: =If(CoefficientUtil_1.Text="CO2-C",true,false)
            Width: =29
            X: ='Subtotal-Icon-Elec'.X
            Y: ='Subtotal-Icon-Elec'.Y
            ZIndex: =75

        "'Subtotal-Water' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =75

            "'Subtotal-Water-DataType' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: =Text(LookUp('Utilities for G-KPI Calculation',Coefficient=CoefficientUtil_1.Text).DataType)
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && varSubtotalWater,true,false)
                Width: =257
                X: =459
                Y: =62
                ZIndex: =9

            "'Subtotal-Water-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="hL"
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && varSubtotalWater,true,false)
                Width: =257
                X: =859
                Y: =62
                ZIndex: =10

            "'Subtotal-Water-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colWaterHLMY,Amount)),"0",
                    Sum(colWaterHLMY,Amount))
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && varSubtotalWater,true,false)
                Width: =170
                X: =1061
                Y: =62
                ZIndex: =11

            "'Subtotal-Water-Text' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Subtotal"
                Visible: =If(CoefficientUtil_1.Text = "Water" && varGalWater && varSubtotalWater,true,false)
                X: =10
                Y: =62
                ZIndex: =12

        "'Subtotal-Icon-Prod' As icon.ListScrollWatchlist":
            Color: =RGBA(128, 128, 128, 1)
            Height: =29
            Icon: =Icon.ListScrollWatchlist
            OnSelect: =Set(varSubtotalProd,!varSubtotalProd)
            Tooltip: ="Subtotal"&" "&CoefficientUtil_1.Text
            Visible: =If(CoefficientUtil_1.Text="Production",true,false)
            Width: =29
            X: ='Subtotal-Icon-Elec'.X
            Y: ='Subtotal-Icon-Elec'.Y
            ZIndex: =76

        "'Subtotal-Icon-Fuel' As icon.ListScrollWatchlist":
            Color: =RGBA(128, 128, 128, 1)
            Height: =29
            Icon: =Icon.ListScrollWatchlist
            OnSelect: =Set(varSubtotalFuel,!varSubtotalFuel)
            Tooltip: ="Subtotal"&" "&CoefficientUtil_1.Text
            Visible: =If(CoefficientUtil_1.Text="Fuel",true,false)
            Width: =29
            X: ='Subtotal-Icon-Elec'.X
            Y: ='Subtotal-Icon-Elec'.Y
            ZIndex: =77

        "'Subtotal-Fuel' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =77

            "'Subtotal-FuelAmt-DataType' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =10
                Text: ="Purchased Fuel Amount"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =257
                X: =459
                Y: =66
                ZIndex: =37

            "'Subtotal-FuelAmt-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                Text: ="mmBtu"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =257
                X: =905
                Y: =66
                ZIndex: =38

            "'Subtotal-FuelAmt-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colFuelMY,Amount)),"0",
                    
                    Sum(colFuelMY,Amount))
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =170
                X: =1062
                Y: =66
                ZIndex: =39

            "'Subtotal-FuelAmt-Text' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                Text: ="Subtotal"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                X: =19
                Y: =66
                ZIndex: =40

            "'Subtotal-FuelEner-DataType' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =10
                Text: ="Purchased Energy Amount"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =257
                X: =459
                Y: =111
                ZIndex: =41

            "'Subtotal-FuelEner-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                Text: ="MJ"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =257
                X: =905
                Y: =111
                ZIndex: =42

            "'Subtotal-FuelEner-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colFuelMY,AmountConversion)),"0",
                    
                    
                    Sum(colFuelMY,AmountConversion))
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =170
                X: =1061
                Y: =111
                ZIndex: =43

            "'Subtotal-RefFuelEner-DataType' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =10
                Text: ="Ref. Energy excl. Elc. Generation"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =300
                X: =459
                Y: =156
                ZIndex: =44

            "'Subtotal-RefFuelEner-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                Text: ="MJ"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =257
                X: =905
                Y: =156
                ZIndex: =45

            "'Subtotal-RefFuelEner-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colFuelMY,AmountConversion)),"0",
                    
                    Sum(colFuelMY,AmountConversion))
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =170
                X: =1061
                Y: =156
                ZIndex: =46

            "'Subtotal-FuelCO2-DataType' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =10
                Text: ="CO2 Emissions"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =300
                X: =459
                Y: =201
                ZIndex: =47

            "'Subtotal-FuelCO2-Unit' As label":
                Align: =Left
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                Text: ="kg-CO2e"
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =257
                X: =905
                Y: =201
                ZIndex: =48

            "'Subtotal-FuelCO2-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colFuelMY,AmountCO2)),"0",
                    
                    Sum(colFuelMY,AmountCO2))
                Visible: =If(CoefficientUtil_1.Text = "Fuel" && varGalFuel && varSubtotalFuel,true, false)
                Width: =170
                X: =1061
                Y: =201
                ZIndex: =49

        "'Subtotal-Prod' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =77

            "'Subtotal-Prod-DataType' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Production Amount"
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && varSubtotalProd,true, false)
                Width: =257
                X: =450
                Y: =64
                ZIndex: =32

            "'Subtotal-Prod-Unit' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="hL"
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && varSubtotalProd,true, false)
                Width: =257
                X: =960
                Y: =64
                ZIndex: =33

            "'Subtotal-Prod-Amt' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colProdHLMY,AmountConversion)),"0",
                    Text(
                    Sum(colProdHLMY,AmountConversion),"#,###,###" ))
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && varSubtotalProd,true, false)
                Width: =170
                X: =1061
                Y: =64
                ZIndex: =34

            "'Subtotal-Prod-Text' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Subtotal"
                Visible: =If(CoefficientUtil_1.Text = "Production" && varGalProd && varSubtotalProd,true, false)
                X: =10
                Y: =64
                ZIndex: =35

        "'Subtotal-Icon-All' As icon.ListScrollWatchlist":
            Color: =RGBA(128, 128, 128, 1)
            Height: =29
            Icon: =Icon.ListScrollWatchlist
            OnSelect: |-
                =If(
                CoefficientUtil_1.Text="CO2-E" && Checkbox2_1.Value, Set(varSubtotalCO2E,!varSubtotalCO2E),
                CoefficientUtil_1.Text="CO2-C"&& Checkbox2_1.Value, Set(varSubtotalCO2C,!varSubtotalCO2C),
                CoefficientUtil_1.Text="Production" && Checkbox2_1.Value, Set(varSubtotalProd,!varSubtotalProd),
                CoefficientUtil_1.Text="Electricity" && Checkbox2_1.Value, Set(varSubtotalElec,!varSubtotalElec),
                CoefficientUtil_1.Text="Fuel" && Checkbox2_1.Value, Set(varSubtotalFuel,!varSubtotalFuel),
                CoefficientUtil_1.Text="Water" && Checkbox2_1.Value, Set(varSubtotalWater,!varSubtotalWater)
                )
            Tooltip: ="Subtotal"&" "&CoefficientUtil_1.Text
            Visible: =If(CoefficientUtil_1.Text="CO2-E",true,false)
            Width: =29
            X: =1131
            Y: =14
            ZIndex: =79

        "'Gallery-CO2-E' As gallery.variableTemplateHeightGallery":
            Height: =224
            Items: =Filter(colUtilities, varDefault in BU.Value && Coefficient = CoefficientUtil_1.Text && Status = "Approved")
            Layout: =Layout.Vertical
            ShowNavigation: =true
            ShowScrollbar: =false
            TemplatePadding: =0
            TemplateSize: =50
            Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E,true,false)
            Width: =1250
            Y: =56
            ZIndex: =80

            "'CO2-E' As text":
                BorderColor: |-
                    =If(
                        IsBlank('CO2-E'.Text),
                        Red,
                        RGBA(
                            230,
                            230,
                            230,
                            1
                        )
                    )
                Default: =ThisItem.FuelType
                DisplayMode: |-
                    =If(
                    CountRows(Filter('Utilities for G-KPI Calculation', ID = ThisItem.ID)) = 0,DisplayMode.Edit,DisplayMode.View)
                Fill: =If('CO2-E'.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && !varSubtotalCO2E,true,false)
                Width: =410
                X: =33
                Y: =2
                ZIndex: =5

            "'CO2-E-DT' As text":
                BorderColor: =If(IsBlank('CO2-E-DT'.Text),Red,RGBA(230,230,230,1))
                Default: =ThisItem.DataType
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If('CO2-E-DT'.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && !varSubtotalCO2E,true,false)
                Width: =387
                X: =459
                Y: =2
                ZIndex: =6

            "'CO2-E-Unit' As text":
                BorderColor: =If(IsBlank('CO2-E-Unit'.Text),Red,RGBA(230,230,230,1))
                Default: =If(!IsBlank(LookUp('Utilities for G-KPI Calculation', ID = ThisItem.ID && Coefficient=CoefficientUtil_1.Text)),ThisItem.Unit,Dropdown4_1.Selected.Result)
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If('CO2-E-Unit'.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         !IsBlank(LookUp('Utilities for G-KPI Calculation', ID = ThisItem.ID && Coefficient=CoefficientUtil_1.Text && !varSubtotalCO2E)),true,false
                         
                         )
                Width: =189
                X: =859
                Y: =2
                ZIndex: =7

            "'CO2-E-Amt' As text":
                BorderColor: =If(IsBlank('CO2-E-Amt'.Text),Red,RGBA(230,230,230,1))
                Default: |-
                    =If('CO2-E'.Text="Emissions Based On Energy Consumption",
                    
                    Sum(Filter(colFuelMY,UnitCO2='CO2-E-Unit'.Text),AmountCO2),
                    
                    "")
                DisplayMode: |
                    =If(
                    CountRows(Filter('Utilities for G-KPI Calculation', ID = ThisItem.ID)) = 0,DisplayMode.Edit,
                    'CO2-E'.Text<>"Emissions Based On Energy Consumption", DisplayMode.Edit,
                     DisplayMode.View)
                Fill: =If('CO2-E-Amt'.DisplayMode=DisplayMode.Edit,White,Transparent)
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colCO2EMY, ID= ThisItem.ID) =0,
                    Collect(colCO2EMY,{TotalUtilities:Value('CO2-E-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: 'CO2-E-Unit'.Text, UtilitiesType: 'CO2-E'.Text, ID: ThisItem.ID, DataType: 'CO2-E-DT'.Text, Conversion1Amt:If(
                    'CO2-E'.Text="Emissions Based On Energy Consumption",
                    Sum(Filter(colElecHLMY,UnitCO2='CO2-E_Emm_Elec_Unit'.Text),AmountCO2),
                    Value('CO2-E-Amt'.Text)*LookUp('Coefficients for G-KPI Calculation', Title="Unit CO2 Emission by Electricity" &&
                    Year=Value(YearUtil.Selected.Value),'Unit Calorific (Fuel) Value'))}),
                    Patch(colCO2EMY,
                                 First(
                                    Filter(colCO2EMY,
                                       ID= ThisItem.ID)),
                                        {
                                           TotalUtilities:Value('CO2-E-Amt'.Text), ID: ThisItem.ID,UtilitiesType: 'CO2-E'.Text,DataType: 'CO2-E-DT'.Text, Unit:'CO2-E-Unit'.Text, 
                                           Conversion1Amt: If(
                    'CO2-E'.Text="Emissions Based On Energy Consumption",
                    Sum(Filter(colElecHLMY,UnitCO2='CO2-E_Emm_Elec_Unit'.Text),AmountCO2),
                    Value('CO2-E-Amt'.Text)*LookUp('Coefficients for G-KPI Calculation', Title="Unit CO2 Emission by Electricity" &&
                    Year=Value(YearUtil.Selected.Value),'Unit Calorific (Fuel) Value'))}))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && !varSubtotalCO2E,true,false)
                Width: =171
                X: =1061
                Y: =2
                ZIndex: =8

            Circle4_8 As circle:
                Fill: |+
                    =If(
                    IsBlank('CO2-E'.Text) || IsBlank('CO2-E-DT'.Text) || IsBlank('CO2-E-Amt'.Text) || IsBlank('CO2-E-Unit'.Text), Orange,
                    
                    
                    Green
                    
                    )
                    
                Height: =10
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && !varSubtotalCO2E,true,false)
                Width: =10
                X: =16
                Y: =16
                ZIndex: =12

            Label32_5 As label:
                OnSelect: =Select(Parent)
                Text: =If(Dropdown4_1.Selected.Result="" || 'CO2-E-DT'.Text="" ||  'CO2-E-Amt'.Text="" ||  'CO2-E'.Text="",0,1)
                Visible: =false
                Width: =64
                X: =406
                Y: =10
                ZIndex: =13

            "'CO2-E_Emm_Elec_DT' As text":
                BorderColor: |-
                    =If(
                        IsBlank('CO2-E_Emm_Elec_DT'.Text),
                        Red,
                        RGBA(
                            230,
                            230,
                            230,
                            1
                        )
                    )
                Default: ="Emissions by Electricity"
                DisplayMode: =DisplayMode.View
                Fill: =If('CO2-E_Emm_Elec_DT'.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && !varSubtotalCO2E && 'CO2-E'.Text<>"Purchased CO2 Credit",true,false)
                Width: =410
                X: =459
                Y: =40
                ZIndex: =15

            "'CO2-E_Emm_Elec_Unit' As text":
                BorderColor: =If(IsBlank('CO2-E_Emm_Elec_Unit'.Text),Red,RGBA(230,230,230,1))
                Default: ="kg-CO2e"
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities for G-KPI Calculation', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If('CO2-E_Emm_Elec_Unit'.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: |
                    =If('CO2-E'.DisplayMode=DisplayMode.View && !varSubtotalCO2E && 'CO2-E'.Text<>"Purchased CO2 Credit",true,false)
                Width: =189
                X: =859
                Y: =40
                ZIndex: =16

            "'CO2-E_Emm_Elec_Amt' As text":
                BorderColor: =If(IsBlank('CO2-E_Emm_Elec_Amt'.Text),Red,RGBA(230,230,230,1))
                Default: |-
                    =If(
                    'CO2-E'.Text="Emissions Based On Energy Consumption",
                    Sum(Filter(colElecHLMY,UnitCO2='CO2-E_Emm_Elec_Unit'.Text),AmountCO2),
                    Value('CO2-E-Amt'.Text)*LookUp('Coefficients for G-KPI Calculation',  Title="Unit CO2 Emission by Electricity" &&
                    Year=Value(YearUtil.Selected.Value ),'Unit Calorific (Fuel) Value'))
                DisplayMode: =DisplayMode.View
                Fill: =If('CO2-E_Emm_Elec_Amt'.DisplayMode=DisplayMode.Edit,White,Transparent)
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colCO2EMY, ID= ThisItem.ID) =0,
                    Collect(colCO2EMY,{TotalUtilities:Value('CO2-E-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: 'CO2-E-Unit'.Text, UtilitiesType: 'CO2-E'.Text, ID: ThisItem.ID, DataType: 'CO2-E-DT'.Text, Conversion1Amt: Value('CO2-E_Emm_Elec_Amt'.Text)}),
                    Patch(colCO2EMY,
                                 First(
                                    Filter(colCO2EMY,
                                       ID= ThisItem.ID)),
                                        {
                                           TotalUtilities:Value('CO2-E-Amt'.Text), ID: ThisItem.ID,UtilitiesType: 'CO2-E'.Text,DataType: 'CO2-E-DT'.Text, Unit:'CO2-E-Unit'.Text, Conversion1Amt: Value('CO2-E_Emm_Elec_Amt'.Text)
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && !varSubtotalCO2E && 'CO2-E'.Text<>"Purchased CO2 Credit",true,false)
                Width: =171
                X: =1061
                Y: =40
                ZIndex: =17

            Dropdown4_1 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =""
                Items: =Distinct(Filter('Utilities for G-KPI Calculation', Coefficient=CoefficientUtil_1.Text),Unit)
                OnChange: |-
                    =If(CountIf(colCO2EMY, ID= ThisItem.ID) =0,
                    Collect(colCO2EMY,{TotalUtilities:Value('CO2-E-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: Dropdown4_1.Selected.Result, UtilitiesType: 'CO2-E'.Text, ID: ThisItem.ID, DataType: 'CO2-E-DT'.Text, AmountElec: Value('CO2-E_Emm_Elec_Amt'.Text)}),
                    Patch(colCO2EMY,
                                 First(
                                    Filter(colCO2EMY,
                                       ID= ThisItem.ID)),
                                        {
                                           TotalUtilities:Value('CO2-E-Amt'.Text), ID: ThisItem.ID,UtilitiesType: 'CO2-E'.Text,DataType: 'CO2-E-DT'.Text, Unit: Dropdown4_1.Selected.Result, AmountElec: Value('CO2-E_Emm_Elec_Amt'.Text)
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         !IsBlank(LookUp('Utilities for G-KPI Calculation', ID = ThisItem.ID && Coefficient=CoefficientUtil_1.Text)),false,true
                         
                         )
                Width: =120
                X: =859
                Y: =2
                ZIndex: =18

            Label34 As label:
                OnSelect: =Select(Parent)
                Text: =ThisItem.ID
                Visible: =false
                X: =60
                Y: =10
                ZIndex: =19

            Label35 As label:
                OnSelect: =Select(Parent)
                Text: =If(Circle4_8.Fill = Orange,0,1)
                Visible: =false
                X: =80
                Y: =10
                ZIndex: =20

        "'Add-CO2-E' As group":
            Height: =5
            Width: =5
            X: =50
            Y: =60
            ZIndex: =83

            "'Add-bttn-CPP_6' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "CO2-E",Collect(colUtilities,{'CO2-E':"", BU:Table({Value: varDefault}), DataType:"Emissions By Fuel", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "CO2-E", Status: "Approved"})
                    
                    )
                    
                PaddingLeft: =0
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =false
                Width: =80
                X: =43
                Y: ='Gallery-CO2-E'.Height + Dropdown4_1.Height
                ZIndex: =81

            Icon22_31 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =If(
                    
                    
                    CoefficientUtil_1.Text = "CO2-E",Collect(colUtilities,{'CO2-E':"", BU:Table({Value: varDefault}), DataType:"Emissions By Fuel", Unit:"", ID: First(Sort(colUtilities,ID,Descending)).ID+1, Coefficient: "CO2-E", Status: "Approved"})
                    
                    )
                    
                Visible: =false
                Width: =28
                X: =10
                Y: ='Gallery-CO2-E'.Height + Dropdown4_1.Height + 12
                ZIndex: =82

        Checkbox2_1 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            OnCheck: |-
                =If(
                
                CoefficientUtil_1.Text = "CO2-C",Set(varGalCO2C,!varGalCO2C),
                CoefficientUtil_1.Text = "CO2-E",Set(varGalCO2E,!varGalCO2E),
                CoefficientUtil_1.Text = "Fuel",Set(varGalFuel,!varGalFuel),
                CoefficientUtil_1.Text = "Water",Set(varGalWater,!varGalWater),
                CoefficientUtil_1.Text = "Production",Set(varGalProd,!varGalProd),
                CoefficientUtil_1.Text = "Electricity",Set(varGalElec,!varGalElec)
                
                )
            OnSelect: =Select(Parent)
            Text: ="Show all SKU"
            Width: =297
            X: =193
            ZIndex: =91

        Label41 As label:
            Align: =Center
            Color: |
                =If(
                CoefficientUtil_1.Text = "CO2-C" && CountRows(Filter(colCO2CMY,Amount = 0 || IsBlank(Amount) || IsBlank(UtilitiesType))) >0,Orange,
                CoefficientUtil_1.Text = "Electricity" && CountRows(Filter('Gallery-Electricity'.AllItems,IsBlank(Electricity.Text) || IsBlank(TextInput19_9.Text) || IsBlank(TextInput19_8.Text))) >0,Orange,
                CoefficientUtil_1.Text = "Fuel" && CountRows(Filter('Gallery-Fuel'.AllItems,IsBlank(Dropdown10.Selected.Title) || IsBlank(TextInput18_1.Text) || IsBlank(TextInput16_1.Text))) >0, Orange,
                CoefficientUtil_1.Text = "Production" && CountRows(Filter('Gallery-Production'.AllItems,IsBlank('Production-Text'.Selected.FuelType))) >0, Orange,
                CoefficientUtil_1.Text = "Water" && CountRows(Filter('Gallery-Water'.AllItems,IsBlank(Water.Text)|| IsBlank(TextInput19_6.Text) ||  IsBlank(TextInput19_7.Text))) >0, Orange,
                CoefficientUtil_1.Text = "CO2-E" && CountRows(Filter('Gallery-CO2-E'.AllItems,IsBlank('CO2-E-Amt'))) >0, Orange,
                
                Green)
            FontWeight: =Semibold
            OnSelect: =Select(Parent)
            Size: =14
            Text: ="Table Progress"
            X: =550
            Y: =8
            ZIndex: =92

        "'Subtotal-CO2-E' As group":
            Height: =5
            Width: =5
            X: =18
            Y: =-6
            ZIndex: =96

            "'Subtotal-CO2E-DT' As label":
                Height: =60
                OnSelect: =Select(Parent)
                PaddingLeft: =10
                Text: ="Emissions based on energy consumption"
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && varSubtotalCO2E,true, false)
                Width: =257
                X: =477
                Y: =80
                ZIndex: =83

            "'Subtotal-CO2E-Unit' As label":
                Height: |
                    =40
                OnSelect: =Select(Parent)
                Text: ="kg-CO2e"
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && varSubtotalCO2E,true, false)
                Width: =257
                X: =865
                Y: =80
                ZIndex: =84

            "'Subtotal-CO2E-Amt' As label":
                Height: |
                    =40
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: |-
                    =If(IsBlank(Sum(colCO2EMY,AmountFuel) Or Sum(colCO2EMY,AmountElec)),"0",
                    
                    Sum(colCO2EMY,AmountFuel) + Sum(colCO2EMY,AmountElec))
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && varSubtotalCO2E,true, false)
                Width: =170
                X: =1080
                Y: =80
                ZIndex: =85

            "'Subtotal-CO2E' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                Text: ="Sub Total"
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && varSubtotalCO2E,true, false)
                Width: =350
                X: =37
                Y: =60
                ZIndex: =86

            "'Subtotal-CO2-DT-2' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =10
                Text: ="CO2 Emissions"
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && varSubtotalCO2E,true, false)
                Width: =257
                X: =477
                Y: =140
                ZIndex: =87

            "'Subtotal-CO2-Unit-2' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                Text: ="kg-CO2e"
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && varSubtotalCO2E,true, false)
                Width: =257
                X: =865
                Y: =140
                ZIndex: =88

            "'Subtotal-CO2-Amt-2' As label":
                Height: |
                    =If(ThisItem.Result =  Gallery11.Selected.Result,40,0)
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="0"
                Visible: =If(CoefficientUtil_1.Text = "CO2-E" && varGalCO2E && varSubtotalCO2E,true, false)
                Width: =170
                X: =1079
                Y: =140
                ZIndex: =89

    "'CountRows-Dont-Delete' As text":
        Default: =CountRows(Filter(Filter('Utilities for G-KPI Calculation', BUUtil.Text in BU.Value),!IsBlank('CO2-C')))
        Visible: =false
        X: =85
        Y: =224
        ZIndex: =13

    Button11_1 As button:
        FontWeight: =FontWeight.Bold
        Height: =37
        OnSelect: |+
            =ForAll(colUtilitiesSaved As aPatch,If(IsBlank(LookUp('Utilities Total Form',ID=aPatch.ID).ID),
            Patch('Utilities Total Form',{
            
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                    aPatch.Conversion2Amt, DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate
            
            }),
            
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                    aPatch.Conversion2Amt
                    
                    }
                  )
            
            )
            
            );
            
        Text: ="Update form"
        Visible: =false
        Width: =215
        X: =169
        Y: =696
        ZIndex: =14

    Button11_4 As button:
        FontWeight: =FontWeight.Bold
        Height: =37
        OnSelect: |-
            =ForAll(
                  colElecHLMY As aPatch,
                  Patch(
                     'Utilities for G-KPI Calculation',
                     {   
                    ID:aPatch.ID,
                    Coefficient:aPatch.Utilities,
                    Electricity:aPatch.UtilitiesType,
                    DataType:aPatch.DataType,
                    Unit:aPatch.Unit
                     }
                  )
            );
            
            ForAll(
                  colFuelMY As aPatch,
                  Patch(
                     'Utilities for G-KPI Calculation',
                     {   
                    ID:aPatch.ID,
                    Coefficient:aPatch.Utilities,
                    FuelType:aPatch.UtilitiesType
                     }
                  )
            );
            
            ForAll(
                  colProdHLMY As aPatch,
                  Patch(
                     'Utilities for G-KPI Calculation',
                     {   
                    ID:aPatch.ID,
                    Coefficient:aPatch.Utilities,
                    ProductType:aPatch.UtilitiesType,
                    Unit:aPatch.Unit
                     }
                  )
            );
            
            ForAll(
                  colWaterHLMY As aPatch,
                  Patch(
                     'Utilities for G-KPI Calculation',
                     {   
                    ID:aPatch.ID,
                    Coefficient:aPatch.Utilities,
                    Water:aPatch.UtilitiesType,
                    DataType:aPatch.DataType,
                    Unit:aPatch.Unit
                     }
                  )
            );
            
            ForAll(
                  colCO2CMY As aPatch,
                  Patch(
                     'Utilities for G-KPI Calculation',
                     {   
                    ID:aPatch.ID,
                    Coefficient:aPatch.Utilities,
                    'CO2-C': aPatch.UtilitiesType
                     }
                  )
            );
            
            ForAll(
                  colCO2EMY As aPatch,
                  Patch(
                     'Utilities for G-KPI Calculation',
                     {   
                    ID:aPatch.ID,
                    Coefficient:aPatch.Utilities,
                    'CO2-E':aPatch.UtilitiesType,
                    DataType:aPatch.DataType,
                    Unit:aPatch.Unit
                     }
                  )
            );
            
            ForAll(
                  colFuelMY As aPatch,
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.Amount, Conversion1Amt: aPatch.AmountConversion, Conversion2Amt: 
                    aPatch.AmountCO2
                    
                    }
                  )
            );
            
            ForAll(
                  colElecHLMY As aPatch,
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    DataType: aPatch.DataType, Unit: aPatch.Unit, TotalUtilities: aPatch.Amount, Conversion1Amt: aPatch.AmountEnergy, 
                    Conversion2Amt: aPatch.AmountCO2
                    
                    }
                  )
            );
            
            ForAll(
                  colWaterHLMY As aPatch,
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    DataType: aPatch.DataType, Unit: aPatch.Unit, TotalUtilities: aPatch.Amount, Conversion1Amt: aPatch.AmountConversion
                    
                    }
                  )
            );
            
            ForAll(
                  colProdHLMY As aPatch,
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.Amount, Conversion1Amt: aPatch.AmountConversion
            
                    }
                  )
            );
            
            ForAll(
                  colCO2CMY As aPatch,
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.Amount
                    
                    }
                  )
            );
            
            ForAll(
                  colCO2EMY As aPatch,
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, 
                    Conversion1: If(aPatch.UtilitiesType ="Emissions Based On Energy
                    Consumption","Emissions by Fuel","CO2 Emissions Offset"), Conversion1Amt: If (aPatch.UtilitiesType ="Emissions Based On 
                    Energy Consumption", aPatch.AmountElec, aPatch.AmountFuel)
                    
                    }
                  )
            );
            
            
                 
                    
        Text: ="Update new item"
        Visible: =false
        Width: =215
        X: =169
        Y: =650
        ZIndex: =15

    "'CreatedSavedDate-do not delete' As datepicker":
        DefaultDate: =varUtilities.Created
        Visible: =false
        X: =918
        Y: =95
        ZIndex: =16

    Gallery8 As gallery.variableTemplateHeightGallery:
        Height: =386
        Items: =Sort(Distinct(colUtilitiesSaved,Utilities),Result)
        Layout: =Layout.Vertical
        TemplateSize: =205
        Visible: =If(UtilitiesSaved,true,false)
        Width: =1260
        X: =60
        Y: =264
        ZIndex: =17

        Button8_58 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =56
            Text: =""
            Width: =1250
            ZIndex: =1

        CoefficientUtilSaved As label:
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =32
            OnSelect: =Select(Parent)
            Text: =ThisItem.Result
            Width: =133
            X: =50
            Y: =12
            ZIndex: =2

        Circle1_16 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =12
            Y: =13
            ZIndex: =3

        Icon22_32 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =16
            Icon: =Icon.Document
            OnSelect: =Select(Parent)
            Width: =26
            X: =14
            Y: =20
            ZIndex: =4

        "'Subtotal-Icon-Elec_1' As icon.ListScrollWatchlist":
            Color: =RGBA(128, 128, 128, 1)
            Height: =29
            Icon: =Icon.ListScrollWatchlist
            OnSelect: |+
                =Set(varSubtotalSaved,!varSubtotalSaved)
                
            Tooltip: ="Subtotal"&" "&CoefficientUtil_1.Text
            Width: =29
            X: =1181
            Y: =14
            ZIndex: =6

        "'SubtotalSave-Text' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: ="Subtotal"
            Visible: =If(Checkbox2.Value && varSubtotalSaved,true,false)
            X: =10
            Y: =60
            ZIndex: =7

        "'SubtotalSave-DT' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(CoefficientUtilSaved.Text="Fuel","Purchased Fuel Amount",
                CoefficientUtilSaved.Text="Electricity","Purchased Electricity Amount",
                CoefficientUtilSaved.Text="Electricity","Purchased Electricity Amount",
                CoefficientUtilSaved.Text="CO2-E","Emissions Based On Energy Consumption",
                LookUp('Utilities Total Form',Utilities=CoefficientUtilSaved.Text).DataType)
            Visible: =If(Checkbox2.Value && varSubtotalSaved,true,false)
            Width: =348
            X: =459
            Y: =60
            ZIndex: =8

        "'SubtotalSave-Unit' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(CoefficientUtilSaved.Text="Fuel","MJ",
                CoefficientUtilSaved.Text="Water","hL",
                CoefficientUtilSaved.Text="Production","hL",
                LookUp('Utilities Total Form',Utilities=CoefficientUtilSaved.Text).Unit
                
                )
            Visible: =If(Checkbox2.Value && varSubtotalSaved,true,false)
            X: =859
            Y: =60
            ZIndex: =9

        "'SubtotalSave-Amt' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(
                
                CoefficientUtilSaved.Text="Fuel", 
                
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Fuel"),Conversion1Amt)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Fuel"),Conversion1Amt)),
                
                CoefficientUtilSaved.Text="Electricity", 
                
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Electricity" && DataType = "Purchased Electricity Amount"),TotalUtilities)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Electricity"&& DataType = "Purchased Electricity Amount"),TotalUtilities)),
                
                CoefficientUtilSaved.Text="Production", 
                
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Production"),Conversion1Amt)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Production"),Conversion1Amt)),
                
                CoefficientUtilSaved.Text="CO2-E", 
                
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Fuel"),Conversion2Amt))&&IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Electricity"),Conversion2Amt)),"0", Sum(Filter(colUtilitiesSaved,Utilities="Fuel"),Conversion2Amt) + Sum(Filter(colUtilitiesSaved,Utilities="Electricity"),Conversion2Amt)),
                
                CoefficientUtilSaved.Text="Water", 
                
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Water"),Conversion1Amt)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Water"),Conversion1Amt)),
                
                CoefficientUtilSaved.Text="CO2-C", 
                
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="CO2-C"),TotalUtilities)),"0",Sum(Filter(colUtilitiesSaved,Utilities="CO2-C"),TotalUtilities))
                
                
                )
            Visible: =If(Checkbox2.Value && varSubtotalSaved,true,false)
            X: =1057
            Y: =60
            ZIndex: =10

        "'Add-Water_1' As group":
            Height: =5
            Width: =5
            X: =-40
            Y: =40
            ZIndex: =10

            "'Add-bttn-CPP_7' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =Collect(colUtilitiesSaved,{UtilitiesType:"", BU:varDefault, DataType:"Water Consumption", Unit:"", ID: First(Sort(colUtilitiesSaved,ID,Descending)).ID+1, Utilities: "Water", DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate,  Status: "Saved", FormNo: varUtilities.FormNo})
                    
                    
                    
                PaddingLeft: =0
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(CoefficientUtilSaved.Text="Water" && Checkbox2.Value,true,false)
                Width: =80
                X: =43
                Y: =Gallery10.Height
                ZIndex: =27

            Icon22_33 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =Collect(colUtilitiesSaved,{UtilitiesType:"", BU:varDefault, DataType:"Water Consumption", Unit:"", ID: First(Sort(colUtilitiesSaved,ID,Descending)).ID+1, Utilities: "Water", DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate,  Status: "Saved", FormNo: varUtilities.FormNo})
                    
                    
                    
                Visible: =If(CoefficientUtilSaved.Text="Water" && Checkbox2.Value,true,false)
                Width: =28
                X: =10
                Y: =Gallery10.Height + 12
                ZIndex: =28

        "'SubtotalSave-DT_1' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(CoefficientUtilSaved.Text="Fuel","Ref. Energy excl. Elc. Generation",
                CoefficientUtilSaved.Text="Electricity","Purchased Energy Amount")
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , CoefficientUtilSaved.Text = "Fuel" && Checkbox2.Value && varSubtotalSaved, true, false)
            Width: =348
            X: =459
            Y: =105
            ZIndex: =11

        "'SubtotalSave-Unit_1' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |
                ="MJ"
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , CoefficientUtilSaved.Text = "Fuel" && Checkbox2.Value && varSubtotalSaved, true, false)
            X: =859
            Y: =105
            ZIndex: =12

        "'Add-Fuel_1' As group":
            Height: =5
            Width: =5
            X: =30
            Y: =40
            ZIndex: =12

            "'Add-bttn-CPP_8' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =Collect(colUtilitiesSaved,{UtilitiesType:"", BU:varDefault, DataType:"Purchased Fuel Amount", Unit:"", ID: First(Sort(colUtilitiesSaved,ID,Descending)).ID+1, Utilities: "Fuel", DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate,  Status: "Saved", FormNo: varUtilities.FormNo})
                    
                    
                    
                PaddingLeft: =0
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(CoefficientUtilSaved.Text="Fuel" && Checkbox2.Value,true,false)
                Width: =80
                X: =43
                Y: =Gallery10.Height 
                ZIndex: =29

            Icon22_34 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =Collect(colUtilitiesSaved,{UtilitiesType:"", BU:varDefault, DataType:"Purchased Fuel Amount", Unit:"", ID: First(Sort(colUtilitiesSaved,ID,Descending)).ID+1, Utilities: "Fuel", DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate,  Status: "Saved", FormNo: varUtilities.FormNo})
                    
                    
                    
                Visible: =If(CoefficientUtilSaved.Text="Fuel" && Checkbox2.Value,true,false)
                Width: =28
                X: =10
                Y: =Gallery10.Height + 12
                ZIndex: =30

        "'SubtotalSave-Amt_1' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(CoefficientUtilSaved.Text="Fuel",'SubtotalSave-Amt'.Text,
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Electricity" && DataType = "Purchased Electricity Amount"),Conversion1Amt)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Electricity"&& DataType = "Purchased Electricity Amount"),Conversion1Amt))
                
                )
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , CoefficientUtilSaved.Text = "Fuel" && Checkbox2.Value && varSubtotalSaved, true, false)
            X: =1057
            Y: =105
            ZIndex: =13

        "'SubtotalSave-DT_2' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(CoefficientUtilSaved.Text="Fuel","CO2 Emissions",
                CoefficientUtilSaved.Text="Electricity","Ref. Overall Elc. Consumption")
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , CoefficientUtilSaved.Text = "Fuel" && Checkbox2.Value && varSubtotalSaved, true, false)
            Width: =348
            X: =459
            Y: =150
            ZIndex: =14

        "'Add-Elec_1' As group":
            Height: =5
            Width: =5
            X: =30
            Y: =40
            ZIndex: =14

            "'Add-bttn-CPP_9' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =Collect(colUtilitiesSaved,{UtilitiesType:"", BU:varDefault, DataType:"Purchased Electricity Amount", Unit:"", ID: First(Sort(colUtilitiesSaved,ID,Descending)).ID+1, Utilities: "Electricity", DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate,  Status: "Saved", FormNo: varUtilities.FormNo})
                    
                    
                    
                PaddingLeft: =0
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(CoefficientUtilSaved.Text="Electricity" && Checkbox2.Value,true,false)
                Width: =80
                X: =43
                Y: =Gallery10.Height
                ZIndex: =31

            Icon22_35 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =Collect(colUtilitiesSaved,{UtilitiesType:"", BU:varDefault, DataType:"Purchased Electricity Amount", Unit:"", ID: First(Sort(colUtilitiesSaved,ID,Descending)).ID+1, Utilities: "Electricity", DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate,  Status: "Saved", FormNo: varUtilities.FormNo})
                    
                    
                    
                Visible: =If(CoefficientUtilSaved.Text="Electricity" && Checkbox2.Value,true,false)
                Width: =28
                X: =10
                Y: =Gallery10.Height + 12
                ZIndex: =32

        "'SubtotalSave-Unit_2' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(CoefficientUtilSaved.Text="Fuel","kg-CO2e",
                CoefficientUtilSaved.Text="Electricity","kWh")
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , CoefficientUtilSaved.Text = "Fuel" && Checkbox2.Value && varSubtotalSaved, true, false)
            X: =859
            Y: =150
            ZIndex: =15

        "'SubtotalSave-Amt_2' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |-
                =If(
                    
                CoefficientUtilSaved.Text="Fuel",
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Fuel" && Conversion2 = "kg-CO2e"),Conversion2Amt)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Fuel" && Conversion2 = "kg-CO2e"),Conversion2Amt)),
                
                If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Electricity"),TotalUtilities)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Electricity"),TotalUtilities))
                
                )
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , CoefficientUtilSaved.Text = "Fuel" && Checkbox2.Value && varSubtotalSaved, true, false)
            X: =1057
            Y: =150
            ZIndex: =16

        "'SubtotalSave-DT_3' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: ="Ref. Overall Ene. Consumption"
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            Width: =348
            X: =459
            Y: =195
            ZIndex: =17

        "'SubtotalSave-Unit_3' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: ="MJ"
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            X: =859
            Y: =195
            ZIndex: =18

        "'SubtotalSave-Amt_3' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |+
                =If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Electricity"),Conversion1Amt)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Electricity"),Conversion1Amt))
                
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            X: =1057
            Y: =195
            ZIndex: =19

        "'SubtotalSave-DT_4' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: ="Ref. Renewable Energy Ratio"
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            Width: =348
            X: =459
            Y: =240
            ZIndex: =20

        "'SubtotalSave-Unit_4' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: ="%"
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            X: =859
            Y: =240
            ZIndex: =21

        "'SubtotalSave-Amt_4' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |+
                =If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Electricity" && UtilitiesType = "Renewable (e.g. Solar)"),TotalUtilities)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Electricity" && UtilitiesType = "Renewable (e.g. Solar)"),TotalUtilities)/'SubtotalSave-Amt_2'.Text*100
                
                )
                
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            X: =1057
            Y: =240
            ZIndex: =22

        "'SubtotalSave-DT_5' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: ="CO2 Emissions"
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            Width: =348
            X: =459
            Y: =285
            ZIndex: =23

        "'SubtotalSave-Unit_5' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: ="kg-CO2e"
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            X: =859
            Y: =285
            ZIndex: =24

        "'SubtotalSave-Amt_5' As label":
            FontWeight: =Normal
            OnSelect: =Select(Parent)
            Text: |+
                =If(IsBlank(Sum(Filter(colUtilitiesSaved,Utilities="Electricity" && DataType = "Purchased Electricity Amount"),Conversion2Amt)),"0",Sum(Filter(colUtilitiesSaved,Utilities="Electricity" && DataType = "Purchased Electricity Amount"),Conversion2Amt))
                
                
            Visible: =If(CoefficientUtilSaved.Text = "Electricity" && Checkbox2.Value && varSubtotalSaved, true , false)
            X: =1057
            Y: =285
            ZIndex: =25

        Gallery10 As gallery.variableTemplateHeightGallery:
            Fill: =RGBA(253, 253, 253, 1)
            Height: |-
                =If(Checkbox2.Value,
                
                Value(CountRows(Filter(colUtilitiesSaved, Utilities = CoefficientUtilSaved.Text).ID))*120,0)
            Items: |-
                =If(Checkbox2.Value,
                
                Filter(colUtilitiesSaved,DateSavedSubmit = 'CreatedSavedDate-do not delete'.SelectedDate && Utilities = CoefficientUtilSaved.Text && Status = "Saved" && FormNo = varUtilities.FormNo ))
            Layout: =Layout.Vertical
            TemplateSize: =148
            Visible: =If(varSubtotalSaved,false,true)
            Width: =1270
            Y: =52
            ZIndex: =26

            Circle4_4 As circle:
                Fill: =If(IsBlank(Electricity.Text) || IsBlank(TextInput19_4.Text) || IsBlank(TextInput19_8.Text) || IsBlank(TextInput19_9.Text), Orange, Green)
                Height: =10
                OnSelect: =Select(Parent)
                Width: =10
                X: =16
                Y: =15
                ZIndex: =2

            FuelDT As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: |-
                    =If(CoefficientUtilSaved.Text="Water","Water Consumption",
                    UTSaved.Text="Purchased Green Electricity Certificate","Purchased Green Electricity",
                    ThisItem.DataType)
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities Total Form', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(Self.DisplayMode=DisplayMode.Edit,White,Transparent)
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, DataType: FuelDT.Text}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            DataType: FuelDT.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Width: =308
                X: =If(CoefficientUtilSaved.Text = "Production",700,459)
                ZIndex: =3

            FuelUnit As text:
                BorderColor: =If(IsBlank(FuelUnit.Text),Red,RGBA(230, 230, 230, 1))
                Default: |-
                    =If(
                    CoefficientUtilSaved.Text="Fuel",
                    LookUp('Coefficients for G-KPI Calculation',Title=FuelType.Selected.Title).Unit,
                    CoefficientUtilSaved.Text="CO2-C",
                    LookUp('Utilities for G-KPI Calculation',FuelType='CO2-C-Text_1'.Selected.FuelType && BUUtil.Text in BU.Value).Unit,
                    CoefficientUtilSaved.Text="CO2-E",
                    LookUp('Utilities for G-KPI Calculation',FuelType=UTSaved.Text && BUUtil.Text in BU.Value).Unit,
                    CoefficientUtilSaved.Text="Production",
                    LookUp('Utilities for G-KPI Calculation',FuelType=UTSaved.Text && BUUtil.Text in BU.Value).Unit,
                    CoefficientUtilSaved.Text="Electricity",
                    LookUp('Utilities for G-KPI Calculation',FuelType=UTSaved.Text && BUUtil.Text in BU.Value).Unit,
                    CoefficientUtilSaved.Text="Water",
                    LookUp('Utilities for G-KPI Calculation',FuelType=UTSaved.Text && BUUtil.Text in BU.Value).Unit
                    
                    )
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities Total Form', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, Unit: FuelUnit.Text}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            Unit: FuelUnit.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         !IsBlank(LookUp('Utilities Total Form', ID = ThisItem.ID)), true,
                         false
                         )
                Width: =189
                X: =If(CoefficientUtilSaved.Text = "Production", 960,859)
                ZIndex: =4

            FuelAmt As text:
                BorderColor: =If(IsBlank(FuelAmt.Text),Red,RGBA(230, 230, 230, 1))
                Default: |-
                    =Text(
                    ThisItem.TotalUtilities,"###,###,###,###")
                DisplayMode: |-
                    =If(CoefficientUtilSaved.Text="Production",DisplayMode.View,
                    DisplayMode.Edit)
                Fill: =If(Self.DisplayMode = DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0 && CoefficientUtilSaved.Text = "Fuel",
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, TotalUtilities: Value(FuelAmt.Text),
                    Conversion1Amt:Value(FuelConversionAmt.Text), Conversion2Amt:Value(FuelCO2Amt.Text)
                    
                    }),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID && CoefficientUtilSaved.Text = "Fuel")),
                                        {
                                            TotalUtilities: Value(FuelAmt.Text),Conversion1Amt:Value(FuelConversionAmt.Text),Conversion2Amt:Value(FuelCO2Amt.Text)
                                           }
                              ));
                    
                    If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0 && CoefficientUtilSaved.Text = "Electricity",
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, TotalUtilities: Value(FuelAmt.Text),
                    Conversion1Amt:Value('Elec-Amt-Energy-Saved'.Text), Conversion2Amt:Value('Elec-Amt-CO2_2'.Text)
                    
                    }),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID && CoefficientUtilSaved.Text = "Electricity")),
                                        {
                                            TotalUtilities: Value(FuelAmt.Text),Conversion1Amt:Value('Elec-Amt-Energy-Saved'.Text), Conversion2Amt:Value('Elec-Amt-CO2_2'.Text)
                                           }
                              ));
                    
                    If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0 && CoefficientUtilSaved.Text = "Water",
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, TotalUtilities: Value(FuelAmt.Text),
                    Conversion1Amt:Value('Water-Conversion-Amt_1'.Text)
                    
                    }),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID && CoefficientUtilSaved.Text = "Water")),
                                        {
                                            TotalUtilities: Value(FuelAmt.Text),Conversion1Amt:Value('Water-Conversion-Amt_1'.Text)
                                           }
                              ));
                    
                    
                    If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0 && CoefficientUtilSaved.Text = "CO2-C",
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, TotalUtilities: Value(FuelAmt.Text)
                    
                    }),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID && CoefficientUtilSaved.Text = "CO2-C")),
                                        {
                                            TotalUtilities: Value(FuelAmt.Text)
                                           }
                              ));
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                    
                    CoefficientUtilSaved.Text<>"CO2-E", true , 
                    
                    false )
                Width: =171
                X: =1057
                ZIndex: =5

            "'Purchased Energy Amount' As label":
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="Purchased Energy Amount"
                Visible: =If(CoefficientUtilSaved.Text = "Fuel", true, false)
                Width: =300
                X: =459
                Y: =40
                ZIndex: =6

            MJ As label:
                OnSelect: =Select(Parent)
                PaddingLeft: =12
                Text: ="MJ"
                Visible: =If(CoefficientUtilSaved.Text = "Fuel", true, false)
                Width: =100
                X: =859
                Y: =40
                ZIndex: =7

            FuelConversionAmt As label:
                OnSelect: =Select(Parent)
                Text: |-
                    =If(
                        
                    !IsBlank(FuelType.Selected.Title) && FuelType.Selected.Title <> "Natural Gas or Liquefied Gas (NG/LNG)",
                    
                    Text(Value(FuelAmt.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title =FuelType.Selected.Title && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" ),
                    
                    IsBlank(FuelType.Selected.Title) && NewFuelUnit.Selected.Result = "mmBtu", 
                    
                    Text(Value(FuelAmt.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Unit = "mmBtu" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" ),
                    
                    IsBlank(FuelType.Selected.Title) && NewFuelUnit.Selected.Result <> "mmBtu", Text(Value(FuelAmt.Text)*1,"#,###,###" ),
                    
                    Text(Value(FuelAmt.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Unit = "mmBtu" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" ),
                    
                    !IsBlank(FuelType.Selected.Title) && FuelType.Selected.Title = "Natural Gas or Liquefied Gas (NG/LNG)",
                    Text(Value(FuelAmt.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title ="mmBtu" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"#,###,###" )
                    )
                Visible: =If(CoefficientUtilSaved.Text = "Fuel", true, false)
                Width: =100
                X: =1057
                Y: =40
                ZIndex: =8

            FuelType As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =ThisItem.UtilitiesType
                Items: =Filter('Coefficients for G-KPI Calculation',Coefficient=CoefficientUtilSaved.Text).Title
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, UtilitiesType: FuelType.Selected.Title}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            UtilitiesType: FuelType.Selected.Title
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Fuel", true, false)
                Width: =410
                X: =32
                Y: =4
                ZIndex: =9

            NewFuelUnit As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =ThisItem.Unit
                Items: =Distinct(Filter('Coefficients for G-KPI Calculation', Coefficient=CoefficientUtilSaved.Text),Unit)
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, Unit: NewFuelUnit.Selected.Result}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            Unit: NewFuelUnit.Selected.Result
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         (CountRows(Filter('Utilities Total Form',ID = ThisItem.ID))) = 0 && CoefficientUtilSaved.Text = "Fuel",
                         true,
                         false
                         )
                Width: =114
                X: =859
                Y: =4
                ZIndex: =10

            FuelCO2DT As text:
                BorderColor: =If(IsBlank(FuelCO2DT.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="CO2 Emissions"
                DisplayMode: =DisplayMode.View
                Fill: =If(FuelCO2DT.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Fuel", true, false)
                Width: =387
                X: =459
                Y: =85
                ZIndex: =11

            FuelCO2Unit As text:
                BorderColor: =If(IsBlank(FuelCO2Unit.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="kg-CO2e"
                DisplayMode: =DisplayMode.View
                Fill: =If(FuelCO2Unit.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Fuel", true, false)
                Width: =90
                X: =859
                Y: =85
                ZIndex: =12

            FuelCO2Amt As text:
                BorderColor: =If(IsBlank(FuelCO2Amt.Text),Red,RGBA(230, 230, 230, 1))
                Default: =Value(FuelAmt.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Title =FuelType.Selected.Title && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit CO2 Emmission (Fuel) Value')
                DisplayMode: =DisplayMode.View
                Fill: =If(FuelCO2Amt.DisplayMode=DisplayMode.Edit,White,Transparent)
                Height: =38
                OnSelect: =Select(Parent)
                PaddingLeft: =5
                Visible: =If(CoefficientUtilSaved.Text = "Fuel", true, false)
                Width: =171
                X: =1057
                Y: =85
                ZIndex: =13

            "'Elec-DT-Energy-Saved' As text":
                Default: =If(UTSaved.Text = "Renewable (e.g. Solar)" || UTSaved.Text = "In-House excl. Renewable (e.g. CoGen)","Generated Energy Amount","Purchased Energy Amount")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Electricity",true,false)
                Width: =387
                X: =459
                Y: =40
                ZIndex: =14

            "'Elec-Unit-Energy-Saved' As text":
                Default: ="MJ"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Electricity",true,false)
                Width: =167
                X: =859
                Y: =TextInput19_4.Height
                ZIndex: =15

            "'Elec-Amt-Energy-Saved' As text":
                Default: |-
                    =Text(
                    Value(FuelAmt.Text)*LookUp('Coefficients for G-KPI Calculation',Title ="kWh" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value',"###,###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Electricity",true,false)
                Width: =167
                X: =1057
                Y: =TextInput19_4.Height
                ZIndex: =16

            "'Elec-CO2-DT_2' As text":
                Default: ="CO2 Emissions"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Electricity",true,false)
                Width: =387
                X: =459
                Y: =85
                ZIndex: =17

            "'Elec-Unit-CO2_2' As text":
                Default: ="kg-CO2e"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Electricity",true,false)
                Width: =200
                X: =859
                Y: =85
                ZIndex: =18

            "'Elec-Amt-CO2_2' As text":
                Default: |-
                    =Text(Value(FuelAmt.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Unit ="kWh" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit CO2 Emmission (Fuel) Value'),"###,###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Electricity",true,false)
                Width: =167
                X: =1057
                Y: =85
                ZIndex: =19

            "'Water-Conversion-DT_1' As text":
                Default: ="Water Consumption"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Water",true,false)
                Width: =387
                X: =459
                Y: =TextInput19_5.Height 
                ZIndex: =20

            "'Water-Conversion-Unit_1' As text":
                Default: ="hL"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Water",true,false)
                Width: =189
                X: =859
                Y: =TextInput19_6.Height 
                ZIndex: =21

            "'Water-Conversion-Amt_1' As text":
                Default: |-
                    =Text(
                    Value(FuelAmt.Text)*Value(LookUp('Coefficients for G-KPI Calculation',Unit = "hL" && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value'),"###,###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Water",true,false)
                Width: =189
                X: =1057
                Y: =TextInput19_7.Height 
                ZIndex: =22

            NewElecUnit As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =ThisItem.Unit
                Items: =Distinct(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient=CoefficientUtilSaved.Text),Unit)
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, Unit: NewElecUnit.Selected.Result}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            Unit: NewElecUnit.Selected.Result
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         (CountRows(Filter('Utilities Total Form',ID = ThisItem.ID))) = 0 && CoefficientUtilSaved.Text = "Electricity",true,
                         false
                         )
                Width: =90
                X: =859
                Y: =4
                ZIndex: =23

            NewWaterUnit As dropdown:
                AllowEmptySelection: =true
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =ThisItem.Unit
                Items: =Distinct(Filter('Utilities for G-KPI Calculation',varDefault in BU.Value && Coefficient=CoefficientUtilSaved.Text),Unit)
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, Unit: NewWaterUnit.Selected.Result}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            Unit: NewWaterUnit.Selected.Result
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(
                         (CountRows(Filter('Utilities Total Form',ID = ThisItem.ID))) = 0 && CoefficientUtilSaved.Text = "Water",true,
                         false
                         )
                Width: =189
                X: =859
                Y: =4
                ZIndex: =24

            ProdConversionAmt As text:
                BorderColor: =If(IsBlank(ProdConversionAmt.Text),Red,RGBA(230, 230, 230, 1))
                Default: |+
                    =If(
                    
                    IsBlank('Production-Text_1'.Selected.FuelType),"0",
                    
                    !IsBlank('Production-Text_1'.Selected.FuelType),
                    
                    Text(Value(FuelAmt.Text)*LookUp('Coefficients for G-KPI Calculation',Title = 'Production-Text_1'.Selected.FuelType && EffectiveDate=First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result).'Unit Calorific (Fuel) Value',"###,###,###,###" )
                    )
                    
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text="Production",true,false)
                Width: =171
                X: =1057
                Y: =40
                ZIndex: =25

            ProdConversionDT As text:
                BorderColor: =If(IsBlank(ProdConversionDT.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="Production Amount"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Production",true,false)
                Width: =200
                X: =700
                Y: =40
                ZIndex: =26

            ProdConversionUnit As text:
                BorderColor: =If(IsBlank(ProdConversionUnit.Text),Red,RGBA(230, 230, 230, 1))
                Default: ="hL"
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "Production",true,false)
                Width: =90
                X: =960
                Y: =40
                ZIndex: =27

            "'Production-Text_1' As dropdown":
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank('Production-Text_1'.Selected.FuelType),Red,RGBA(230, 230, 230, 1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =ThisItem.UtilitiesType
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                Items: =Filter('Utilities for G-KPI Calculation', varDefault in BU.Value && Coefficient=CoefficientUtilSaved.Text).FuelType
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0 && CoefficientUtilSaved.Text = "Production",
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text,
                    Conversion1Amt:Value(ProdConversionAmt.Text), UtilitiesType:'Production-Text_1'.Selected.FuelType
                    
                    }),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID && CoefficientUtilSaved.Text = "Production")),
                                        {
                                            Conversion1Amt:Value(ProdConversionAmt.Text), UtilitiesType:'Production-Text_1'.Selected.FuelType
                                           }
                              ));
                Visible: =If(CoefficientUtilSaved.Text = "Production",true,false)
                Width: =410
                X: =200
                Y: =4
                ZIndex: =28

            NewProdUnit As dropdown:
                BorderColor: =RGBA(230, 230, 230, 1)
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Items: =Distinct(Filter('Coefficients for G-KPI Calculation', Coefficient="Product"),Unit)
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, Unit: NewProdUnit.Selected.Result}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            Unit: NewProdUnit.Selected.Result
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =90
                X: =859
                Y: =4
                ZIndex: =29

            ProdName As label:
                FontWeight: =Semibold
                OnSelect: =Select(Parent)
                Text: =ThisItem.ProdName
                Visible: =If(CoefficientUtilSaved.Text = "Production",true,false)
                X: =60
                ZIndex: =30

            "'CO2-C-Text_1' As dropdown":
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank('CO2-C-Text_1'.Selected.FuelType),Red,RGBA(230,230,230,1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =ThisItem.UtilitiesType
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                Items: =Filter('Utilities for G-KPI Calculation', varDefault in BU.Value && Coefficient=CoefficientUtilSaved.Text).FuelType
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, UtilitiesType: 'CO2-C-Text_1'.Selected.FuelType}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                             UtilitiesType: 'CO2-C-Text_1'.Selected.FuelType
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "CO2-C",true,false)
                Width: =410
                X: =32
                Y: =4
                ZIndex: =31

            "'CO2-E_Emm_Elec_DT_1' As text":
                BorderColor: |-
                    =If(
                        IsBlank('CO2-E_Emm_Elec_DT_1'.Text),
                        Red,
                        RGBA(
                            230,
                            230,
                            230,
                            1
                        )
                    )
                Default: =If(ThisItem.UtilitiesType = "Emissions Based On Energy Consumption","Emissions by Electricity","CO2 Emissions Offset")
                DisplayMode: =DisplayMode.View
                Fill: =If('CO2-E_Emm_Elec_DT_1'.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colWaterHLMY, ID= ThisItem.ID) =0,
                    Collect(colWaterHLMY,{Amount:Value('CO2-E-Amt'.Text), Utilities: CoefficientUtil_1.Text, Unit: 'CO2-E-Unit'.Text, UtilitiesType: 'CO2-E'.Text, ID: ThisItem.ID, DataType: 'CO2-E-DT'.Text}),
                    Patch(colWaterHLMY,
                                 First(
                                    Filter(colWaterHLMY,
                                       ID= ThisItem.ID)),
                                        {
                                           Amount:Value('CO2-E-Amt'.Text), ID: ThisItem.ID,UtilitiesType: 'CO2-E'.Text,DataType: 'CO2-E-DT'.Text, Unit:'CO2-E-Unit'.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(CoefficientUtilSaved.Text = "CO2-E" && ThisItem.UtilitiesType <> "Purchased CO2 Credit",true,
                    false)
                Width: =410
                X: =459
                Y: =40
                ZIndex: =32

            "'CO2-E_Emm_Elec_Unit_1' As text":
                BorderColor: =If(IsBlank('CO2-E_Emm_Elec_Unit_1'.Text),Red,RGBA(230,230,230,1))
                Default: ="kg-CO2e"
                DisplayMode: =DisplayMode.View
                Fill: =If('CO2-E_Emm_Elec_Unit_1'.DisplayMode=DisplayMode.Edit,White,Transparent)
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(CoefficientUtilSaved.Text = "CO2-E" && ThisItem.UtilitiesType <> "Purchased CO2 Credit",true,
                    false)
                Width: =189
                X: =859
                Y: =40
                ZIndex: =33

            "'CO2-E_Emm_Elec_Amt_1' As text":
                BorderColor: =If(IsBlank('CO2-E_Emm_Elec_Amt_1'.Text),Red,RGBA(230,230,230,1))
                Default: |-
                    =If(
                    UTSaved.Text="Emissions Based On Energy Consumption",
                    Sum(Filter(colUtilitiesSaved,Utilities="Electricity"),Conversion2Amt),
                    Value('CO2-E-Amt_1'.Text)*LookUp('Coefficients for G-KPI Calculation', Year=Value(YearUtil.Selected.Value),'Unit Calorific (Fuel) Value')
                    )
                DisplayMode: =DisplayMode.View
                Fill: =If('CO2-E_Emm_Elec_Amt_1'.DisplayMode=DisplayMode.Edit,White,Transparent)
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Visible: |-
                    =If(CoefficientUtilSaved.Text = "CO2-E" && ThisItem.UtilitiesType <> "Purchased CO2 Credit",true,
                    false)
                Width: =171
                X: =1057
                Y: =40
                ZIndex: =34

            "'CO2-E-Amt_1' As text":
                BorderColor: =If(IsBlank('CO2-E-Amt_1'.Text),Red,RGBA(230,230,230,1))
                Default: |-
                    =If(UTSaved.Text="Emissions Based On Energy Consumption",
                    
                    Sum(Filter(colUtilitiesSaved,Utilities="Fuel"),Conversion2Amt),
                    
                    ThisItem.TotalUtilities)
                DisplayMode: |
                    =If(
                    CountRows(Filter('Utilities Total Form', ID = ThisItem.ID)) = 0,DisplayMode.Edit,
                    UTSaved.Text<>"Emissions Based On Energy Consumption", DisplayMode.Edit,
                     DisplayMode.View)
                Fill: =If('CO2-E-Amt_1'.DisplayMode=DisplayMode.Edit,White,Transparent)
                Format: =TextFormat.Number
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0 && CoefficientUtilSaved.Text = "CO2-E" && ThisItem.UtilitiesType = "Purchased Green Electricity Certificate",
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, TotalUtilities: Value('CO2-E-Amt_1'.Text),
                    Conversion1Amt:Value('CO2-E_Emm_Elec_Amt_1'.Text)
                    
                    }),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID && CoefficientUtilSaved.Text = "CO2-E" && ThisItem.UtilitiesType = "Purchased Green Electricity Certificate")),
                                        {
                                            TotalUtilities: Value('CO2-E-Amt_1'.Text),Conversion1Amt:Value('CO2-E_Emm_Elec_Amt_1'.Text)
                                           }
                              ));
                OnSelect: =Select(Parent)
                Visible: =If(CoefficientUtilSaved.Text = "CO2-E",true,false)
                Width: =171
                X: =1057
                ZIndex: =35

            UTSaved As text:
                BorderColor: =If(IsBlank(Self.Text),Red,Silver)
                Default: =ThisItem.UtilitiesType
                DisplayMode: |
                    =If(
                    
                    CountRows(Filter('Utilities Total Form', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(Self.DisplayMode = DisplayMode.Edit,White,Transparent)
                OnChange: |-
                    =If(CountIf(colUtilitiesSaved, ID= ThisItem.ID) =0,
                    Collect(colUtilitiesSaved,{ID: ThisItem.ID, Utilities: CoefficientUtilSaved.Text, UtilitiesType: UTSaved.Text}),
                    Patch(colUtilitiesSaved,
                                 First(
                                    Filter(colUtilitiesSaved,
                                       ID= ThisItem.ID)),
                                        {
                                            UtilitiesType: UTSaved.Text
                                           }
                              ))
                OnSelect: =Select(Parent)
                Visible: |
                    =If(CoefficientUtilSaved.Text="Production",false,
                    CoefficientUtilSaved.Text="CO2-C", false,
                    CoefficientUtilSaved.Text="Fuel",false,true)
                Width: =410
                X: =32
                ZIndex: =36

        Checkbox2 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            OnSelect: =Select(Parent)
            Text: ="Show all SKU"
            Width: =297
            X: =193
            ZIndex: =33

        Label41_1 As label:
            Align: =Center
            Color: |
                =If(
                CoefficientUtilSaved.Text = "CO2-C" && CountRows(Filter(Filter(colUtilitiesSaved, Utilities="CO2-C"),IsBlank(UtilitiesType) || IsBlank(TotalUtilities))) >0,Orange,
                
                CoefficientUtilSaved.Text = "CO2-E" && CountRows(Filter(Filter(colUtilitiesSaved, Utilities="CO2-E"), IsBlank(TotalUtilities))) >0,Orange,
                
                CoefficientUtilSaved.Text = "Electricity" && CountRows(Filter(Filter(colUtilitiesSaved, Utilities="Electricity"), IsBlank(TotalUtilities) ||IsBlank(UtilitiesType) || IsBlank(Unit))) >0,Orange,
                
                CoefficientUtilSaved.Text = "Fuel" && CountRows(Filter(Filter(colUtilitiesSaved, Utilities="Fuel"), IsBlank(TotalUtilities) ||IsBlank(UtilitiesType) || IsBlank(Unit))) >0,Orange,
                
                CoefficientUtilSaved.Text = "Production" && CountRows(Filter(Filter(colUtilitiesSaved, Utilities="Production"), IsBlank(TotalUtilities) ||IsBlank(UtilitiesType) || IsBlank(Unit))) >0,Orange,
                
                CoefficientUtilSaved.Text = "Water" && CountRows(Filter(Filter(colUtilitiesSaved, Utilities="Water"), IsBlank(TotalUtilities) ||IsBlank(UtilitiesType) || IsBlank(Unit))) >0,Orange,
                
                Green)
            Fill: =Transparent
            FontWeight: =Semibold
            OnSelect: =Select(Parent)
            Size: =14
            Text: ="Table Progress"
            X: =550
            Y: =8
            ZIndex: =34

    DatePicker1 As datepicker:
        Visible: =false
        X: =938
        Y: =101
        ZIndex: =18

    BG_12 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =18

        Image3_19 As image:
            Height: =768
            Image: =asahi_people
            ImagePosition: =ImagePosition.Fill
            Width: =1366
            ZIndex: =1

        Rectangle1_46 As rectangle:
            Fill: =RGBA(255, 255, 255, 0.97)
            Height: =768
            Width: =1365
            X: =1
            ZIndex: =2

    "'Save-Update-Util' As button":
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderThickness: =0
        Fill: =RGBA(128, 128, 128, 1)
        Height: =42
        HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        HoverFill: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        OnSelect: =Set(popupuserupdateutil,true)
        Size: =13
        Text: ="Save"
        Visible: =If(UtilitiesSaved,true,false)
        Width: =200
        X: =918
        Y: =703
        ZIndex: =19

    Pop_Up_User_Submit_6 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =19

        Rectangle5_29 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupusersubmit
            Width: =1366
            ZIndex: =28

        Submit_Bttn_25 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            Fill: =RGBA(0, 161, 233, 1)
            Height: =44
            HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
            OnSelect: |+
                =///utilities for gkpi calculation form///
                
                ForAll(colElecHLMY As aPatch,If(IsBlank(LookUp('Utilities for G-KPI Calculation',ID=aPatch.ID).ID),
                Patch('Utilities for G-KPI Calculation',Defaults('Utilities for G-KPI Calculation'), {Coefficient:aPatch.Utilities,Electricity:aPatch.UtilitiesType,DataType:aPatch.DataType,Unit:aPatch.Unit,BU:Table({Value:varDefault}), Status: "Pending approval", Month: MonthUtil.Selected.Value, Year: Value(YearUtil.Selected.Value)})));
                
                ForAll(colCO2EMY As aPatch,If(IsBlank(LookUp('Utilities for G-KPI Calculation',ID=aPatch.ID).ID),
                Patch('Utilities for G-KPI Calculation',Defaults('Utilities for G-KPI Calculation'),{Coefficient:aPatch.Utilities,'CO2-E':aPatch.UtilitiesType,DataType:aPatch.DataType,Unit:aPatch.Unit,BU:Table({Value:varDefault}), Status: "Pending approval", Month: MonthUtil.Selected.Value, Year: Value(YearUtil.Selected.Value)})));
                
                ForAll(colWaterHLMY As aPatch,If(IsBlank(LookUp('Utilities for G-KPI Calculation',ID=aPatch.ID).ID),
                Patch('Utilities for G-KPI Calculation',Defaults('Utilities for G-KPI Calculation'),{Coefficient:aPatch.Utilities,Water:aPatch.UtilitiesType,DataType:aPatch.DataType,Unit:aPatch.Unit,BU:Table({Value:varDefault}), Status: "Pending approval", Month: MonthUtil.Selected.Value, Year: Value(YearUtil.Selected.Value)})));
                
                ///total form///
                
                ForAll(colFuelMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    "Purchased Fuel Amount", Unit: Unit, TotalUtilities:Amount, Conversion1: "Purchased Energy Amount", Conversion1Unit: "MJ", 
                    Conversion1Amt: AmountConversion, Conversion2: "CO2 Emissions", Conversion2Unit: "kg-CO2e", Conversion2Amt: AmountCO2, 
                    DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colElecHLMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    DataType, Unit: Unit,TotalUtilities: Amount, Conversion1: "Purchased Energy Amount", Conversion1Unit: "MJ", Conversion1Amt: 
                    AmountEnergy, Conversion2: "CO2 Emissions", Conversion2Unit: "kg-CO2e", Conversion2Amt: AmountCO2, DateSavedSubmit: 
                    DatePicker1.SelectedDate
                    }));
                
                ForAll(colWaterHLMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    DataType, Unit: Unit, TotalUtilities: Amount, Conversion1: "Water Consumption", Conversion1Unit: "hL", Conversion1Amt: 
                    AmountConversion, DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colProdHLMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    "Production Amount", Unit:  Unit, TotalUtilities: Amount, Conversion1: "Production Amount", 
                    Conversion1Unit: "hL", 
                    Conversion1Amt: AmountConversion, ProdName:ProdName, DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colCO2CMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    "Consumption", Unit: "kg", TotalUtilities: Amount, DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colCO2EMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, Unit: Unit,     
                    Conversion1Unit: "kg-CO2e", DateSavedSubmit: DatePicker1.SelectedDate,
                    
                    DataType: If(ThisRecord.UtilitiesType ="Emissions Based On Energy Consumption", 
                    "Emissions by Fuel", DataType),
                
                    TotalUtilities: If(ThisRecord.UtilitiesType ="Emissions Based On Energy Consumption", 
                    Sum(colFuelMY,AmountCO2),TotalUtilities),
                
                    Conversion1: If(ThisRecord.UtilitiesType ="Emissions Based On Energy 
                    Consumption","Emissions by Electricity", ThisRecord.UtilitiesType = "Purchased CO2 Credit","", "CO2 Emissions Offset"), 
                    
                    Conversion1Amt: If
                    (ThisRecord.UtilitiesType ="Emissions Based On Energy Consumption", 
                    Sum(colElecHLMY,AmountCO2), Conversion1Amt)
                
                    }));
                
                ///master form///
                
                Patch('Utilities Master Form',Defaults('Utilities Master Form'),{FormNo:DataCardValue4.Text, Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value), RequestorName:varUserName, RequestorEmail:varUserEmail});
                
                Set(UtilitiesSaved,false);
                
                Navigate(Successful)
                
                
            Size: =13
            Text: ="Submit"
            Visible: =popupusersubmit
            Width: =209
            X: =687
            Y: =664
            ZIndex: =29

        Cancel_Bttn_25 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupusersubmit,false)
            Size: =13
            Text: ="Cancel"
            Visible: =popupusersubmit
            Width: =209
            X: =452
            Y: =664
            ZIndex: =30

        Circle2_40 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupusersubmit
            Width: =65
            X: =651
            Y: =264
            ZIndex: =31

        Image6_10 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupusersubmit
            Width: =45
            X: =661
            Y: =274
            ZIndex: =32

        Label3_41 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Are you sure you want to submit the form for approval?"
            Visible: =popupusersubmit
            Width: =681
            X: =343
            Y: =362
            ZIndex: =33

    Submit_Bttn_SavedForm As button:
        Align: =Center
        BorderColor: =RGBA(0, 161, 233, 1)
        Fill: =RGBA(0, 161, 233, 1)
        Height: =44
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: |+
            =ForAll(colUtilitiesSaved As aPatch,If(IsBlank(LookUp('Utilities Total Form',ID=aPatch.ID).ID),
            Patch('Utilities Total Form',{
            
                    FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                    aPatch.Conversion2Amt, DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate
            
            }),
            
                  Patch(
                     'Utilities Total Form',
                     {
                         
                    ID:aPatch.ID,
                    FormNo:DataCardValue4.Text,
                    Status:"Pending", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                    Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                    aPatch.Conversion2Amt
                    
                    }
                  )
            
            )
            
            );
            
        Size: =13
        Text: ="Submit"
        Visible: =popupusersubmit && UtilitiesSaved
        Width: =209
        X: =687
        Y: =664
        ZIndex: =20

    "'Submit-Update-Util' As button":
        BorderThickness: =0
        DisplayMode: |
            =DisplayMode.Edit
        Fill: =RGBA(0, 161, 233, 1)
        Height: =42
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: =Set(popupsubmitupdateutil,true)
        Size: =13
        Text: ="Submit"
        Visible: =If(UtilitiesSaved,true,false)
        Width: =200
        X: =1133
        Y: =703
        ZIndex: =21

    Pop_Up_User_Save_New_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =33

        Rectangle5_35 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupusersaveutil
            Width: =1366
            ZIndex: =34

        Submit_Bttn_30 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            BorderThickness: =0
            Fill: =RGBA(128, 128, 128, 1)
            Height: =44
            HoverColor: =ColorFade(Self.Color, -4%)
            HoverFill: =ColorFade(Self.Fill, -4%)
            OnSelect: |+
                =///utilities for gkpi calculation form///
                
                ForAll(colElecHLMY As aPatch,If(IsBlank(LookUp('Utilities for G-KPI Calculation',ID=aPatch.ID).ID),
                Patch('Utilities for G-KPI Calculation',Defaults('Utilities for G-KPI Calculation'), {Coefficient:aPatch.Utilities,Electricity:aPatch.UtilitiesType,DataType:aPatch.DataType,Unit:aPatch.Unit,BU:Table({Value:varDefault}), Status: "Saved", Month: MonthUtil.Selected.Value, Year: Value(YearUtil.Selected.Value)})));
                
                ForAll(colCO2EMY As aPatch,If(IsBlank(LookUp('Utilities for G-KPI Calculation',ID=aPatch.ID).ID),
                Patch('Utilities for G-KPI Calculation',Defaults('Utilities for G-KPI Calculation'),{Coefficient:aPatch.Utilities,'CO2-E':aPatch.UtilitiesType,DataType:aPatch.DataType,Unit:aPatch.Unit,BU:Table({Value:varDefault}), Status: "Saved", Month: MonthUtil.Selected.Value, Year: Value(YearUtil.Selected.Value)})));
                
                ForAll(colWaterHLMY As aPatch,If(IsBlank(LookUp('Utilities for G-KPI Calculation',ID=aPatch.ID).ID),
                Patch('Utilities for G-KPI Calculation',Defaults('Utilities for G-KPI Calculation'),{Coefficient:aPatch.Utilities,Water:aPatch.UtilitiesType,DataType:aPatch.DataType,Unit:aPatch.Unit,BU:Table({Value:varDefault}), Status: "Saved", Month: MonthUtil.Selected.Value, Year: Value(YearUtil.Selected.Value)})));
                
                ///total form///
                
                ForAll(colFuelMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    "Purchased Fuel Amount", Unit: Unit, TotalUtilities:Amount, Conversion1: "Purchased Energy Amount", Conversion1Unit: "MJ", 
                    Conversion1Amt: AmountConversion, Conversion2: "CO2 Emissions", Conversion2Unit: "kg-CO2e", Conversion2Amt: AmountCO2, 
                    DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colElecHLMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    DataType, Unit: Unit,TotalUtilities: Amount, Conversion1: "Purchased Energy Amount", Conversion1Unit: "MJ", Conversion1Amt: 
                    AmountEnergy, Conversion2: "CO2 Emissions", Conversion2Unit: "kg-CO2e", Conversion2Amt: AmountCO2, DateSavedSubmit: 
                    DatePicker1.SelectedDate
                    }));
                
                ForAll(colWaterHLMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    DataType, Unit: Unit, TotalUtilities: Amount, Conversion1: "Water Consumption", Conversion1Unit: "hL", Conversion1Amt: 
                    AmountConversion, DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colProdHLMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    "Production Amount", Unit: Unit, TotalUtilities: Amount, Conversion1: "Production Amount", 
                    Conversion1Unit: "hL", 
                    Conversion1Amt: AmountConversion, ProdName:ProdName, DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colCO2CMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, DataType: 
                    "Consumption", Unit: "kg", TotalUtilities: Amount, DateSavedSubmit: DatePicker1.SelectedDate
                    }));
                
                ForAll(colCO2EMY, Patch('Utilities Total Form', Defaults('Utilities Total Form'), {FormNo:DataCardValue4.Text,
                    Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                    RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: Utilities, UtilitiesType: UtilitiesType, Unit: Unit,     
                    Conversion1Unit: "kg-CO2e", DateSavedSubmit: DatePicker1.SelectedDate,
                    
                    DataType: If(ThisRecord.UtilitiesType ="Emissions Based On Energy Consumption", 
                    "Emissions by Fuel", DataType),
                
                    TotalUtilities: If(ThisRecord.UtilitiesType ="Emissions Based On Energy Consumption", 
                    Sum(colFuelMY,AmountCO2),TotalUtilities),
                
                    Conversion1: If(ThisRecord.UtilitiesType ="Emissions Based On Energy 
                    Consumption","Emissions by Electricity", ThisRecord.UtilitiesType = "Purchased CO2 Credit","", "CO2 Emissions Offset"), 
                    
                    Conversion1Amt: If
                    (ThisRecord.UtilitiesType ="Emissions Based On Energy Consumption", 
                    Sum(colElecHLMY,AmountCO2), Conversion1Amt)
                
                    }));
                
                ///master form///
                
                Patch('Utilities Master Form',Defaults('Utilities Master Form'),{FormNo:DataCardValue4.Text, Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value), RequestorName:varUserName, RequestorEmail:varUserEmail});
                
                Set(UtilitiesSaved,false);
                
                Navigate(Successful)
                
                
            PressedColor: =ColorFade(Self.Color, -4%)
            PressedFill: =ColorFade(Self.Fill, -4%)
            Size: =13
            Text: ="Yes"
            Visible: =popupusersaveutil
            Width: =209
            X: =452
            Y: =664
            ZIndex: =35

        Cancel_Bttn_32 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupusersaveutil,false)
            Size: =13
            Text: ="No"
            Visible: =popupusersaveutil
            Width: =209
            X: =687
            Y: =664
            ZIndex: =36

        Circle2_44 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupusersaveutil
            Width: =65
            X: =651
            Y: =264
            ZIndex: =37

        Image6_23 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupusersaveutil
            Width: =45
            X: =661
            Y: =274
            ZIndex: =38

        Label3_47 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Do you want to save the form?"
            Visible: =popupusersaveutil
            Width: =681
            X: =343
            Y: =362
            ZIndex: =39

    Pop_Up_User_Update_New_2 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =39

        Rectangle5_36 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupuserupdateutil
            Width: =1366
            ZIndex: =40

        Submit_Bttn_31 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            BorderThickness: =0
            Fill: =RGBA(128, 128, 128, 1)
            Height: =44
            HoverColor: =ColorFade(Self.Color, -4%)
            HoverFill: =ColorFade(Self.Fill, -4%)
            OnSelect: |
                =ForAll(colUtilitiesSaved As aPatch,If(IsBlank(LookUp('Utilities Total Form',ID=aPatch.ID && Year=aPatch.Year && Month=aPatch.Month).ID),
                Patch('Utilities Total Form',{
                
                        FormNo:DataCardValue4.Text,
                        Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                        Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                        aPatch.Conversion2Amt, DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate
                
                }),
                
                      Patch(
                         'Utilities Total Form',
                         {
                             
                        ID:aPatch.ID,
                        FormNo:DataCardValue4.Text,
                        Status:"Saved", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                        Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                        aPatch.Conversion2Amt
                        
                        }
                      )
                
                )
                
                );
                
                Navigate(Successful)
            PressedColor: =ColorFade(Self.Color, -4%)
            PressedFill: =ColorFade(Self.Fill, -4%)
            Size: =13
            Text: ="Yes"
            Visible: =popupuserupdateutil
            Width: =209
            X: =452
            Y: =664
            ZIndex: =41

        Cancel_Bttn_33 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupuserupdateutil,false)
            Size: =13
            Text: ="No"
            Visible: =popupuserupdateutil
            Width: =209
            X: =687
            Y: =664
            ZIndex: =42

        Circle2_45 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupuserupdateutil
            Width: =65
            X: =651
            Y: =264
            ZIndex: =43

        Image6_26 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupuserupdateutil
            Width: =45
            X: =661
            Y: =274
            ZIndex: =44

        Label3_48 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Do you want to save the form?"
            Visible: =popupuserupdateutil
            Width: =681
            X: =343
            Y: =362
            ZIndex: =45

    Pop_Up_User_Update_Submit_Util As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =40

        Rectangle5_40 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupsubmitupdateutil
            Width: =1366
            ZIndex: =46

        Submit_Bttn_32 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            Fill: =RGBA(0, 161, 233, 1)
            Height: =44
            HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
            OnSelect: |+
                =ForAll(colUtilitiesSaved As aPatch,If(IsBlank(LookUp('Utilities Total Form',ID=aPatch.ID).ID),
                Patch('Utilities Total Form',{
                
                        FormNo:DataCardValue4.Text,
                        Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                        Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                        aPatch.Conversion2Amt, DateSavedSubmit: 'CreatedSavedDate-do not delete'.SelectedDate
                
                }),
                
                      Patch(
                         'Utilities Total Form',
                         {
                             
                        ID:aPatch.ID,
                        FormNo:DataCardValue4.Text,
                        Status:"Pending approval", BU:BUUtil.Text, Month:MonthUtil.Selected.Value,Year:Value(YearUtil.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Utilities: aPatch.Utilities, UtilitiesType: aPatch.UtilitiesType,
                        Unit: aPatch.Unit, TotalUtilities: aPatch.TotalUtilities, Conversion1Amt: aPatch.Conversion1Amt, Conversion2Amt: 
                        aPatch.Conversion2Amt
                        
                        }
                      )
                
                )
                
                );
                
                Navigate(Successful)
                
            Size: =13
            Text: ="Submit"
            Visible: =popupsubmitupdateutil
            Width: =209
            X: =687
            Y: =664
            ZIndex: =47

        Cancel_Bttn_34 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupsubmitupdateutil,false)
            Size: =13
            Text: ="Cancel"
            Visible: =popupsubmitupdateutil
            Width: =209
            X: =452
            Y: =664
            ZIndex: =48

        Circle2_46 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupsubmitupdateutil
            Width: =65
            X: =651
            Y: =264
            ZIndex: =49

        Image6_27 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupsubmitupdateutil
            Width: =45
            X: =661
            Y: =274
            ZIndex: =50

        Label3_49 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Are you sure you want to submit the form for approval?"
            Visible: =popupsubmitupdateutil
            Width: =681
            X: =343
            Y: =362
            ZIndex: =51

    Popupalreadysubmit_Util As group:
        Height: =5
        Width: =5
        X: =80
        Y: =80
        ZIndex: =52

        Rectangle5_53 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupalreadysubmitutil
            Width: =1366
            ZIndex: =22

        Circle2_48 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupalreadysubmitutil
            Width: =65
            X: =651
            Y: =264
            ZIndex: =23

        Label3_51 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: |-
                ="Form already in system for selected month.
                Please click                       to update your form."
            Visible: =popupalreadysubmitutil
            Width: =681
            X: =343
            Y: =362
            ZIndex: =24

        Icon11_2 As icon.Warning:
            Color: =RGBA(255, 255, 255, 1)
            Height: =42
            Icon: =Icon.Warning
            Visible: =popupalreadysubmitutil
            Width: =42
            X: =663
            Y: =273
            ZIndex: =25

        "'Close-bttn-etika_17' As icon.CancelBadge":
            Color: =RGBA(0, 161, 233, 1)
            Height: =24
            Icon: =Icon.CancelBadge
            OnSelect: |-
                =Set(popupalreadysubmitutil,false);
                Set(resetyearutil,!resetyearutil);Set(resetmonthutil,!resetmonthutil);
            Visible: =popupalreadysubmitutil
            Width: =24
            X: =1336
            Y: =16
            ZIndex: =26

        Label10_1 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            OnSelect: =Set(popupalreadysubmitutil, false );Set(resetyearutil, true );Set(resetmonthutil, true );Navigate(Status)
            Size: =18
            Text: ="status page"
            Underline: =true
            Visible: =popupalreadysubmitutil
            Width: =158
            X: =550
            Y: =400
            ZIndex: =27

