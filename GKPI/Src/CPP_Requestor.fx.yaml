CPP_Requestor As screen:
    Height: =
    OnVisible: |-
        =Set(varShowMenu, true );
        
        Set(varShowMenu, false );
        
        If(!'CPP-Form_1'.Valid,SubmitForm('CPP-Form_1')||Notify("Please fill in the mandatory field(s) in Copacker Production Volume Form",NotificationType.Error,1500));
        
        Set(varRC, true );Set(varHL, false );Set(varAddCopacker, false );
        
        ClearCollect(colCopackerBU,'Copacker BU List');
        
        Collect(colCopackerUnit,Filter('Copacker List',BU=CPPBU_1.Text));
        
        ClearCollect(colCopackerList,'Copacker List');
        
        Clear(colCopacker);
        
        ClearCollect(colCopacker,ShowColumns(Filter('Copacker List',BU=CPPBU_1.Text),"Copacker","Coefficient","BU","ItemCode","ProductName","UnitConversionCoefficient","ID"));
        
        ClearCollect(colCopackerSaved,ShowColumns(Filter('Copacker Form',BU=CPPBU_1.Text && FormNo = CPPFormNo_1.Text),"ID", "BU", "Month", "Year", "RequestorName", "RequestorEmail", "Status", "Copacker", "ItemCode", "Variant","OpeningBalance", "OpeningBalance2", "Production", "Production2", "DeliveredtoWarehouse", "DeliveredtoWarehouse0", "Rejected", "Rejected2", "ClosingBalance", "ClosingBalance2", "UCCUnit", "UCCAmt"));
        
        Set(popupyousure, false );Set(popupnewcpp, false )

    HtmlText1_3 As htmlViewer:
        Height: =673
        HtmlText: |-
            ="<div style='background-color: rgba(253,253,253,1); box-shadow: 1px 2px 22px 0px rgba(236,236,236,1); margin: 30px; width: 1295px; height: 548px; border-radius: 10px'></div>"
        Width: =1366
        Y: =95
        ZIndex: =3

    SubHeader_18 As SubHeader:
        ZIndex: =4

    Header_29 As Header:
        HeaderText: ="Copacker Production Volume Form"
        ZIndex: =5

    "'CPP-Form_1' As form":
        AcceptsFocus: =false
        DataSource: ='Copacker Master Form'
        Height: =520
        Item: =Defaults('Copacker Master Form')
        SnapToColumns: =false
        Width: =1285
        X: =35
        Y: =144
        ZIndex: =6

        DataCard34 As typedDataCard.blankCard:
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =42
            Width: =1284
            X: =0
            Y: =0
            ZIndex: =1

            DataCardKey25_14 As label:
                AutoHeight: =true
                Color: =RGBA(0, 161, 233, 1)
                FontWeight: =Semibold
                Height: =34
                PaddingLeft: =10
                Size: =16
                Text: ="Form Details"
                Width: =1087
                Wrap: =false
                X: =67
                ZIndex: =1

            Circle2_25 As circle:
                Fill: =RGBA(0, 161, 233, 1)
                Height: =31
                Width: =31
                X: =36
                Y: =5
                ZIndex: =2

            Icon23_17 As icon.CalendarBlank:
                Color: =RGBA(255, 255, 255, 1)
                DisplayMode: =DisplayMode.View
                Height: =23
                Icon: =Icon.DocumentWithContent
                Width: =23
                X: =40
                Y: =9
                ZIndex: =3

        Month_DataCard9_1 As typedDataCard.comboBoxEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Month"
            Default: =
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Copacker Form'],DataSourceInfo.DisplayName,"Month")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =129
            Required: =true
            Update: =
            Width: =428
            X: =4
            Y: =0
            ZIndex: =1

            DataCardKey4_1 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            ErrorMessage4_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: ="This field is mandatory."
                Visible: =(IsBlank(MonthCPP_1.Selected.Value) && Parent.DisplayMode=DisplayMode.Edit)
                Width: =Parent.Width - 60
                X: =30
                Y: =99
                ZIndex: =3

            StarVisible4_1 As label:
                Align: =Align.Center
                Height: =DataCardKey4_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey4_1.Y
                ZIndex: =4

            MonthCPP_1 As dropdown:
                AllowEmptySelection: =true
                BorderColor: |-
                    =If(IsBlank(MonthCPP_1.Selected.Value),Red,
                    RGBA(230, 230, 230, 1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =If(CPPSaved,varCPP.Month.Value,"")
                Height: =45
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Items: =Calendar.MonthsLong()
                OnChange: =If(CountRows(Filter('Copacker Form', BU = CPPBU_1.Text, Month = MonthCPP_1.Selected.Value,Year = YearCPP_1.Selected.Value))>0,Set(popupalreadysubmitcpp,true))
                Reset: =resetmonthcpp
                Width: =368
                X: =30
                Y: =44
                ZIndex: =5

        DataCard20_1 As typedDataCard.blankCard:
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            Height: =111
            Width: =1284
            X: =0
            Y: =10
            ZIndex: =1

            DataCardKey25_8 As label:
                Color: =RGBA(0, 161, 233, 1)
                FontWeight: =Semibold
                Height: =25
                Size: =16
                Text: ="Copacker"
                Width: =Parent.Width - 60
                Wrap: =false
                X: =28
                Y: =10
                ZIndex: =1

            DataCardValue24_11 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                BorderThickness: =0
                Default: =
                DelayOutput: =true
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(230, 230, 230, 1)
                Height: =5
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =1224
                X: =28
                Y: =46
                ZIndex: =2

            Button8_47 As button:
                BorderThickness: =0
                Fill: =If(varRC,DimGrey,RGBA(0, 161, 233, 1))
                Height: =30
                OnSelect: =Set(varRC,true);Set(varHL,false)
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =10
                Text: ="RC"
                Width: =50
                X: =1149
                Y: =5
                ZIndex: =3

            Button8_48 As button:
                BorderThickness: =0
                Fill: =If(varHL,DimGrey,RGBA(0, 161, 233, 1))
                Height: =30
                HoverFill: =ColorFade(Self.Fill, -20%)
                OnSelect: =Set(varHL,true);Set(varRC,false)
                RadiusBottomLeft: =5
                RadiusBottomRight: =5
                RadiusTopLeft: =5
                RadiusTopRight: =5
                Size: =10
                Text: ="hL"
                Width: =50
                X: =1204
                Y: =5
                ZIndex: =4

            "'Add-bttn-CPP-New' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                DisplayMode: |-
                    =If(
                    
                    And(Value(ProdHrsLine1Can.Text)<12, Value(SKULine1Can.Text)<1), DisplayMode.Edit,
                    
                    DisplayMode.Disabled
                    
                    )
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Set(popupyousure,true);
                PaddingLeft: =30
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Text: ="Add New Copacker"
                Width: =227
                X: =909
                Y: =2
                ZIndex: =5

            Icon22_23 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                Width: =28
                X: =911
                Y: =11
                ZIndex: =6

            Label26_17 As label:
                Align: =Center
                Height: =31
                PaddingLeft: =0
                Size: =10
                Text: ="Opening Balance"
                Width: =69
                X: =688
                Y: =75
                ZIndex: =7

            Label26_18 As label:
                Align: =Center
                Height: =20
                PaddingLeft: =0
                Size: =10
                Text: ="Production"
                Width: =85
                X: =785
                Y: =86
                ZIndex: =8

            Label26_19 As label:
                Align: =Center
                Height: =31
                PaddingLeft: =0
                Size: =10
                Text: ="Delivered to Warehouse"
                Width: =83
                X: =882
                Y: =75
                ZIndex: =9

            Label26_20 As label:
                Height: =20
                PaddingLeft: =0
                Size: =10
                Text: ="Rejected"
                Width: =59
                X: =994
                Y: =86
                ZIndex: =10

            Label26_21 As label:
                Align: =Center
                Height: =31
                PaddingLeft: =0
                Size: =10
                Text: |-
                    ="Closing
                    Balance"
                Width: =70
                X: =1094
                Y: =75
                ZIndex: =11

            Label26_24 As label:
                Height: =20
                PaddingLeft: =0
                Size: =10
                Text: ="Item Code"
                Width: =76
                X: =48
                Y: =86
                ZIndex: =12

            Label26_25 As label:
                Height: =20
                PaddingLeft: =0
                Size: =10
                Text: ="Variant"
                Width: =238
                X: =149
                Y: =86
                ZIndex: =13

            Label26_26 As label:
                Align: =Center
                AutoHeight: =true
                PaddingLeft: =0
                Size: =10
                Text: ="Unit Conversion Coefficient"
                Visible: =varAddCopacker
                Width: =182
                X: =470
                Y: =67
                ZIndex: =14

        ID_DataCard1 As typedDataCard.textualViewCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="ID"
            Default: =ThisItem.ID
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Copacker Form'],DataSourceInfo.DisplayName,"ID")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =40
            Required: =false
            Visible: =false
            Width: =428
            X: =1
            Y: =10
            ZIndex: =1

            DataCardKey2 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue2 As label:
                AutoHeight: =true
                DisplayMode: =Parent.DisplayMode
                Height: =27
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =If(CPPSaved,varCPP.ID,CountRows('Copacker Master Form')+1)
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey2.Y + DataCardKey2.Height + 5
                ZIndex: =2

            TextInput17 As text:
                Default: =If(CPPSaved,varCPP.ID,CountRows('Copacker Master Form')+1)
                X: =40
                ZIndex: =3

        FormNo_DataCard2_1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="FormNo"
            Default: =ThisItem.FormNo
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Copacker Master Form'],DataSourceInfo.DisplayName,"FormNo")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Copacker Master Form'], DataSourceInfo.MaxLength, "FormNo")
            Required: =false
            Update: =CPPFormNo_1.Text
            Width: =321
            X: =1
            Y: =0
            ZIndex: =23

            DataCardKey275_1 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: ="Form No"
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            CPPFormNo_1 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: |-
                    =If(CPPSaved,varCPP.FormNo,
                    
                    "CPP"&"-"&Right(YearCPP_1.Selected.Value, 2 )&Switch(MonthCPP_1.Selected.Value,"January", "01", "February", "02", "March", "03", "April", "04", "May", "05", "June", "06", "July", "07", "August", "08", "September", "09",  "October", "10", "November", "11", "December", "12"))
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Fill: =RGBA(0, 0, 0, 0)
                HoverFill: =Self.Fill
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey275_1.Y + DataCardKey275_1.Height + 5
                ZIndex: =2

            ErrorMessage218_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =CPPFormNo_1.Y + CPPFormNo_1.Height
                ZIndex: =3

            StarVisible231_1 As label:
                Align: =Align.Center
                Height: =DataCardKey275_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey275_1.Y
                ZIndex: =4

        BU_DataCard1_2 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="BU"
            Default: =ThisItem.BU
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Copacker Master Form'],DataSourceInfo.DisplayName,"BU")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Copacker Master Form'], DataSourceInfo.MaxLength, "BU")
            Required: =false
            Update: =CPPBU_1.Text
            Width: =214
            X: =2
            Y: =0
            ZIndex: =23

            DataCardKey276_1 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            CPPBU_1 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: ="EBSB"
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Fill: =RGBA(0, 0, 0, 0)
                HoverFill: =Self.Fill
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey276_1.Y + DataCardKey276_1.Height + 5
                ZIndex: =2

            ErrorMessage219_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =CPPBU_1.Y + CPPBU_1.Height
                ZIndex: =3

            StarVisible232_1 As label:
                Align: =Align.Center
                Height: =DataCardKey276_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey276_1.Y
                ZIndex: =4

        Year_DataCard2_1 As typedDataCard.numberEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Year"
            Default: =ThisItem.Year
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Copacker Master Form'],DataSourceInfo.DisplayName,"Year")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =140
            Required: =true
            Update: =Value(CPPYear_1.Text)
            Width: =321
            X: =3
            Y: =0
            ZIndex: =23

            DataCardKey278_1 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            CPPYear_1 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                Format: =TextFormat.Number
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Visible: =false
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey278_1.Y + DataCardKey278_1.Height + 5
                ZIndex: =2

            ErrorMessage221_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: ="This field is mandatory."
                Visible: =(IsBlank(YearCPP_1.Selected.Value) && Parent.DisplayMode=DisplayMode.Edit)
                Width: =Parent.Width - 60
                X: =30
                Y: =99
                ZIndex: =3

            StarVisible234_1 As label:
                Align: =Align.Center
                Height: =DataCardKey278_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey278_1.Y
                ZIndex: =4

            YearCPP_1 As dropdown:
                BorderColor: |-
                    =If(IsBlank(YearCPP_1.Selected.Value),Red,
                    RGBA(230, 230, 230, 1))
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =If(CPPSaved,varCPP.Year,"")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Items: =["", Year(Now()),  Year(Today())-1]
                OnChange: =If(CountRows(Filter('Copacker Form', BU = CPPBU_1.Text, Month = MonthCPP_1.Selected.Value,Year = YearCPP_1.Selected.Value))>0,Set(popupalreadysubmitcpp,true))
                Reset: =resetyearcpp
                Width: =261
                X: =30
                Y: =49
                ZIndex: =5

    CPP_Submit_bttn_3 As button:
        BorderThickness: =0
        Fill: =RGBA(0, 161, 233, 1)
        Height: =42
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: =Set(popupusersubmit,true)
        Size: =13
        Text: ="Submit"
        Visible: =If(CPPSaved,false,true)
        Width: =200
        X: =1133
        Y: =703
        ZIndex: =7

    CPP_Save_bttn_3 As button:
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderThickness: =0
        Fill: =RGBA(128, 128, 128, 1)
        Height: =42
        HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        HoverFill: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        OnSelect: =Set(popupusersavecpp,true)
        Size: =13
        Text: ="Save"
        Visible: =If(CPPSaved,false,true)
        Width: =200
        X: =918
        Y: =703
        ZIndex: =8

    Icon2_26 As icon.Home:
        Color: =RGBA(128, 128, 128, 1)
        Height: =29
        Icon: =Icon.Home
        OnSelect: =Navigate(Homepage)
        Width: =25
        X: =60
        Y: =9
        ZIndex: =9

    Button14_3 As button:
        Fill: =RGBA(0, 161, 233, 1)
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: |-
            =
            Patch('Copacker BU List', LookUp('Copacker BU List', ID = TextInput3_1.Text),
            {Copacker: TextInput7_1.Text}
            
            );
            
            Set(popupnewcpp,false)
        Size: =13
        Text: ="Done"
        Visible: =popupnewcpp
        X: =1109
        Y: =582
        ZIndex: =11

    Button14_2 As button:
        Fill: =RGBA(128, 128, 128, 1)
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: |-
            =Set(popupnewcpp,false);
            Remove('Copacker BU List', First(Sort('Copacker BU List', ID, Descending)));
            Refresh('Copacker BU List')
        Size: =13
        Text: ="Cancel"
        Visible: =popupnewcpp
        X: =918
        Y: =582
        ZIndex: =12

    CPP_Submit_bttn_2 As button:
        BorderThickness: =0
        DisplayMode: |
            =DisplayMode.Edit
        Fill: =RGBA(0, 161, 233, 1)
        Height: =42
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: |-
            =Patch('Copacker BU List',LookUp('Copacker BU List', ID = TextInput3_1.Text), {Copacker: TextInput7_1.Text});
            Set(popupnewcpp,false)
        Size: =13
        Text: ="Done"
        Visible: =popupnewcpp
        Width: =200
        X: =1111
        Y: =684
        ZIndex: =13

    CPP_Save_bttn_2 As button:
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderThickness: =0
        Fill: =RGBA(128, 128, 128, 1)
        Height: =42
        HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        HoverFill: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        OnSelect: |-
            =Remove( 'Copacker BU List',
            Last( Filter( 'Copacker BU List', ID = TextInput3_1.Text ) ) );
            
            Set(popupnewcpp,false)
        Size: =13
        Text: ="Cancel"
        Visible: =popupnewcpp
        Width: =200
        X: =896
        Y: =684
        ZIndex: =14

    Gallery5 As gallery.variableTemplateHeightGallery:
        Height: =215
        Items: =Filter(colCopackerBU,BU = CPPBU_1.Text).Copacker
        Layout: =Layout.Vertical
        TemplateSize: =182
        Visible: =If(!CPPSaved && varRC,true,false)
        Width: =1223
        X: =60
        Y: =449
        ZIndex: =15

        Button8_50 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =49
            Text: =""
            Width: =1213
            ZIndex: =1

        Circle1_9 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =29
            Y: =9
            ZIndex: =2

        Icon22_9 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =22
            Icon: =Icon.Post
            OnSelect: =Select(Parent)
            Width: =22
            X: =33
            Y: =13
            ZIndex: =3

        Label26 As label:
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =34
            OnSelect: =Select(Parent)
            Text: =ThisItem.Copacker
            Width: =Len(Label26.Text)*15
            X: =76
            Y: =8
            ZIndex: =4

        Gallery6 As gallery.variableTemplateHeightGallery:
            Fill: =RGBA(253, 253, 253, 1)
            Height: =If(Checkbox1.Value,CountRows(Gallery6.AllItems)*50+10,0)
            Items: =If(Checkbox1.Value, Filter(colCopackerList,Copacker = Label26.Text && EffectiveDate = First(Sort(Distinct(colCopackerUser,EffectiveDate),Result,Descending)).Result),Filter(colCopackerList,Copacker = "", EffectiveDate=Blank()))
            Layout: =Layout.Vertical
            TemplateSize: =244
            Width: =1222
            Y: =Button8_50.Height
            ZIndex: =5

            CPPOB_23 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPOB_23.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopacker, ID=Value('CPPID-test'.Text)).OpeningBalance,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Opening Balance"
                Width: =70
                X: =651
                ZIndex: =3

            CPPProd_3 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPProd_3.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopacker, ID=Value('CPPID-test'.Text)).Production,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Production"
                Width: =70
                X: =751
                ZIndex: =4

            CPPDelivered_3 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPDelivered_3.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopacker, ID=Value('CPPID-test'.Text)).DeliveredtoWarehouse,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Delivered to Warehouse"
                Width: =70
                X: =851
                ZIndex: =5

            CPPRejected_3 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPRejected_3.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopacker, ID=Value('CPPID-test'.Text)).Rejected,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Rejected"
                Width: =70
                X: =951
                ZIndex: =6

            CPPClosingBalance_3 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: |-
                    =
                    Text(
                    Sum(CPPOB_23.Text + CPPProd_3.Text) - CPPDelivered_3.Text - CPPRejected_3.Text,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Tooltip: ="Closing Balance"
                Width: =70
                X: =1054
                ZIndex: =7

            RemoveIcon_17 As icon.Trash:
                Color: =RGBA(128, 128, 128, 1)
                Height: =31
                Icon: =Icon.Trash
                OnSelect: |
                    =RemoveIf(colCopacker, ID = Gallery6.Selected.ID);
                    RemoveIf(colCopackerList, ID = Gallery6.Selected.ID);
                Visible: =If(CountRows(Filter('Copacker List', 'Product Name' = CPP_ProdName.Text)) > 0, false, true)
                Width: =35
                X: =1157
                Y: =4
                ZIndex: =8

            CPP_ProdName As text:
                BorderColor: =If(IsBlank(CPP_ProdName.Text),Red,DimGrey)
                Default: =ThisItem.'Product Name'
                DisplayMode: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0,White,Transparent)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Variant (e.g 'Chilled Soya Bean')"
                Width: =290
                X: =102
                ZIndex: =9

            CPP_ProdItemCode As text:
                BorderColor: =If(IsBlank(CPP_ProdItemCode.Text),Red,DimGrey)
                Default: =ThisItem.'Item Code'
                DisplayMode: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0,White,Transparent)
                Format: =TextFormat.Number
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Item Code (e.g '0123')"
                Width: =82
                ZIndex: =10

            "'CPPID-test' As text":
                BorderColor: =If(IsBlank('CPPID-test'.Text), Red, DimGrey)
                Default: =ThisItem.ID
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Visible: =false
                Width: =70
                X: =392
                ZIndex: =11

            CPP_Conversion_Unit As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPP_Conversion_Unit.Text), Red, DimGrey)
                Default: =LookUp(colCopackerList, ID=Value('CPPID-test'.Text)).'Unit Conversion Coefficient'
                DisplayMode: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0,White,Transparent)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Unit Conversion Coefficient (eg.'Litre/Case')"
                Visible: =varAddCopacker
                Width: =117
                X: =501
                ZIndex: =12

            CPP_UnitConversion_Amt As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPP_UnitConversion_Amt.Text), Red, DimGrey)
                Default: =LookUp(colCopackerList, ID=Value('CPPID-test'.Text)).'Unit Conversion Coefficient Amt'
                DisplayMode: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker List', ID = ThisItem.ID)) = 0,White,Transparent)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerList,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerList,First(Filter(colCopackerList,ID=ThisItem.ID)),
                        {Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}),
                    
                        Collect(colCopackerList,{Coefficient: "Copacker Products", Copacker: Label26.Text, BU: CPPBU_1.Text, 'Item Code': CPP_ProdItemCode.Text, 'Product Name': CPP_ProdName.Text, 'Unit Conversion Coefficient Amt': Value(CPP_UnitConversion_Amt.Text), 'Unit Conversion Coefficient': CPP_Conversion_Unit.Text}));
                    
                    
                    If(
                        CountIf(colCopacker,ID=ThisItem.ID)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt: CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                    
                        Production: Value(CPPProd_3.Text),
                        Production2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0: Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                    
                    
                    
                      }),
                    
                    Collect(colCopacker,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, ProductName:CPP_ProdName.Text, ItemCode: CPP_ProdItemCode.Text, 
                        ID:ThisItem.ID, Copacker: Label26.Text,
                    
                        UnitConversionCoefficientAmt:CPP_UnitConversion_Amt.Text, 
                        UnitConversionCoefficient: CPP_Conversion_Unit.Text,
                    
                        OpeningBalance:Value(CPPOB_23.Text), 
                        OpeningBalance2: Value(Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt'/ 100,0)),
                    
                            Production: Value(CPPProd_3.Text),
                            Production2: Value(Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0)),
                    
                            DeliveredtoWarehouse: Value(CPPDelivered_3.Text),
                        DeliveredtoWarehouse0:  Value(Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        Rejected: Value(CPPRejected_3.Text),
                         Rejected2: Value(Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)),
                    
                        ClosingBalance: Value(CPPOB_23.Text + CPPProd_3.Text - CPPDelivered_3.Text - CPPRejected_3.Text),
                         ClosingBalance2: Round(Value(CPPProd_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_23.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_3.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_3.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName.Text).'Unit Conversion Coefficient Amt' / 10,0)
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Unit Conversion Coefficient (eg.'7.2')"
                Visible: =varAddCopacker
                Width: =70
                X: =421
                ZIndex: =13

        "'Add-CPP' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =16

            "'Add-bttn-CPP' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =Collect(
                        colCopackerList, 
                        {Copacker: Label26.Text,
                        ID: Last(colCopackerList).ID + 1,
                        BU: CPPBU_1.Text,
                        'Item Code': "",
                        'Product Name': "",
                        'Unit Conversion Coefficient Amt': Value(""),
                        'Unit Conversion Coefficient': ""});
                    
                    Collect(
                        colCopacker, 
                        {Variant:"", ID: Sum(Last(colCopackerList).ID + 1)-1});
                    
                    Set(varAddCopacker,true)
                    
                    
                    
                PaddingLeft: =30
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(Checkbox1.Value, true,false)
                Width: =80
                X: =
                Y: =CountRows(Filter(colCopackerList,Copacker=Label26.Text).BU)*45+100
                ZIndex: =14

            Icon22_24 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =Collect(
                        colCopackerList, 
                        {Copacker: Label26.Text,
                        ID: Last(colCopackerList).ID + 1,
                        BU: CPPBU_1.Text,
                        'Item Code': "",
                        'Product Name': "",
                        'Unit Conversion Coefficient Amt': Value(""),
                        'Unit Conversion Coefficient': ""});
                    
                    Collect(
                        colCopacker, 
                        {Variant:"", ID: Sum(Last(colCopackerList).ID + 1)-1});
                    
                    Set(varAddCopacker,true)
                    
                    
                    
                Visible: =If(Checkbox1.Value, true,false)
                Width: =28
                Y: =CountRows(Filter(colCopackerList,Copacker=Label26.Text).BU)*45+100+12
                ZIndex: =15

        Checkbox1 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            OnSelect: =Select(Parent)
            Text: ="Show all SKU"
            Width: =297
            X: =323
            ZIndex: =17

    Gallery5_hl As gallery.variableTemplateHeightGallery:
        Height: =215
        Items: =Filter(colCopackerBU,BU = CPPBU_1.Text).Copacker
        Layout: =Layout.Vertical
        TemplateSize: =182
        Visible: =If(!CPPSaved && varHL,true,false)
        Width: =1223
        X: =60
        Y: =449
        ZIndex: =16

        Button8_51 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =49
            Text: =""
            Width: =1226
            ZIndex: =1

        Circle1_10 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =29
            Y: =9
            ZIndex: =2

        Icon22_10 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =22
            Icon: =Icon.Post
            OnSelect: =Select(Parent)
            Width: =22
            X: =33
            Y: =13
            ZIndex: =3

        Label26_1 As label:
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =34
            OnSelect: =Select(Parent)
            Text: =ThisItem.Copacker
            Width: =910
            X: =76
            Y: =8
            ZIndex: =4

        Gallery6_1 As gallery.variableTemplateHeightGallery:
            Height: =If(Checkbox1_1.Value,CountRows(Gallery6_1.AllItems)*50+10,0)
            Items: =If(Checkbox1_1.Value, Filter(colCopackerList,Copacker = Label26_1.Text && EffectiveDate = First(Sort(Distinct(colCopackerUser,EffectiveDate),Result,Descending)).Result),Filter(colCopackerList,Copacker = "" && EffectiveDate=Blank()))
            Layout: =Layout.Vertical
            TemplateSize: =244
            Width: =1222
            Y: =Button8_51.Height
            ZIndex: =5

            CPPOB_31 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopacker,ID=ThisItem.ID).OpeningBalance2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =660
                ZIndex: =3

            CPPProd_4 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopacker,ID=ThisItem.ID).Production2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =771
                ZIndex: =4

            CPPDelivered_4 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopacker,ID=ThisItem.ID).DeliveredtoWarehouse0,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =862
                ZIndex: =5

            CPPRejected_4 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopacker,ID=ThisItem.ID).Rejected2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =963
                ZIndex: =6

            CPPClosingBalance_4 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopacker,ID=ThisItem.ID).ClosingBalance2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =1064
                ZIndex: =7

            CPP_ProdName_1 As text:
                BorderColor: =If(IsBlank(CPP_ProdName_1.Text),Red,DimGrey)
                BorderThickness: =0
                Default: =ThisItem.'Product Name'
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(
                        CountIf(colCopacker,Variant=CPP_ProdName_1.Text)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,Variant=CPP_ProdName_1.Text)),{OpeningBalance:Value(CPPOB_31.Text),OpeningBalance2: Value(CPPOB_31.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_1.Text).'Unit Conversion Coefficient Amt' / 100,ClosingBalance: Value(CPPClosingBalance_4.Text),'Item Code': CPP_ProdItemCode_1.Text, Copacker: Label26_1.Text}),
                        
                        Collect(colCopacker,{OpeningBalance:Value(CPPOB_31.Text),OpeningBalance2: Value(CPPOB_31.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_1.Text).'Unit Conversion Coefficient Amt' / 100,Variant:CPP_ProdName_1.Text,ClosingBalance: Value(CPPClosingBalance_4.Text),'Item Code': CPP_ProdItemCode_1.Text,Copacker: Label26_1.Text}))
                Size: =10
                Width: =326
                X: =102
                ZIndex: =9

            CPP_ProdItemCode_1 As text:
                BorderColor: =If(IsBlank(CPP_ProdItemCode_1.Text),Red,DimGrey)
                BorderThickness: =0
                Default: =ThisItem.'Item Code'
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(
                        CountIf(colCopacker,Variant=CPP_ProdName_1.Text)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,Variant=CPP_ProdName_1.Text)),{OpeningBalance:Value(CPPOB_31.Text),OpeningBalance2: Value(CPPOB_31.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_1.Text).'Unit Conversion Coefficient Amt' / 100,ClosingBalance: Value(CPPClosingBalance_4.Text),'Item Code': CPP_ProdItemCode_1.Text, Copacker: Label26_1.Text}),
                        
                        Collect(colCopacker,{OpeningBalance:Value(CPPOB_31.Text),OpeningBalance2: Value(CPPOB_31.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_1.Text).'Unit Conversion Coefficient Amt' / 100,Variant:CPP_ProdName_1.Text,ClosingBalance: Value(CPPClosingBalance_4.Text),'Item Code': CPP_ProdItemCode_1.Text,Copacker: Label26_1.Text}))
                Size: =10
                Width: =82
                ZIndex: =10

        Checkbox1_1 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            OnSelect: =Select(Parent)
            Text: ="Show all SKU"
            Width: =297
            X: =323
            ZIndex: =6

    Button2_6 As button:
        Color: =RGBA(153, 153, 153, 1)
        Fill: =RGBA(0, 0, 0, 0)
        FontWeight: =Semibold
        HoverColor: =ColorFade(Self.Color, -10%)
        HoverFill: =Self.Fill
        OnSelect: =
        PressedColor: =Self.Color
        PressedFill: =Self.Fill
        Size: =12
        Text: ="Definition"
        Width: =115
        X: =626
        Y: =55
        ZIndex: =17

    Gallery5_1 As gallery.variableTemplateHeightGallery:
        Height: =215
        Items: =Filter(colCopackerBU,BU = CPPBU_1.Text).Copacker
        Layout: =Layout.Vertical
        TemplateSize: =182
        Visible: =If(CPPSaved && varRC,true,false)
        Width: =1223
        X: =60
        Y: =449
        ZIndex: =18

        Button8_59 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =49
            Text: =""
            Width: =1213
            ZIndex: =1

        Circle1_14 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =29
            Y: =9
            ZIndex: =2

        Icon22_19 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =22
            Icon: =Icon.Post
            OnSelect: =Select(Parent)
            Width: =22
            X: =33
            Y: =13
            ZIndex: =3

        Label26_2 As label:
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =34
            OnSelect: =Select(Parent)
            Text: =ThisItem.Copacker
            Width: =Len(Label26_2.Text)*15
            X: =76
            Y: =8
            ZIndex: =4

        Gallery6_2 As gallery.variableTemplateHeightGallery:
            Fill: =RGBA(253, 253, 253, 1)
            Height: =If(Checkbox1_2.Value,CountRows(Gallery6_2.AllItems)*50+10,0)
            Items: =If(Checkbox1_2.Value, Filter(colCopackerSaved,Copacker = Label26_2.Text),Filter(colCopackerSaved,Copacker = ""))
            Layout: =Layout.Vertical
            TemplateSize: =244
            Width: =1213
            Y: =Button8_59.Height
            ZIndex: =5

            CPPOB_24 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPOB_24.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved, ID=Value('CPPID-test_1'.Text)).OpeningBalance,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Opening Balance"
                Width: =70
                X: =651
                ZIndex: =3

            CPPProd_5 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPProd_5.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved, ID=Value('CPPID-test_1'.Text)).Production,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Production"
                Width: =70
                X: =751
                ZIndex: =4

            CPPDelivered_5 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPDelivered_5.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved, ID=Value('CPPID-test_1'.Text)).DeliveredtoWarehouse,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Delivered to Warehouse"
                Width: =70
                X: =851
                ZIndex: =5

            CPPRejected_5 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPPRejected_5.Text), Red, DimGrey)
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved, ID=Value('CPPID-test_1'.Text)).Rejected,"###,###,###")
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Rejected"
                Width: =70
                X: =951
                ZIndex: =6

            CPPClosingBalance_5 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: |-
                    =
                    Text(
                    Sum(CPPOB_24.Text + CPPProd_5.Text) - CPPDelivered_5.Text - CPPRejected_5.Text,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Tooltip: ="Closing Balance"
                Width: =70
                X: =1054
                ZIndex: =7

            RemoveIcon_18 As icon.Trash:
                Color: =RGBA(128, 128, 128, 1)
                Height: =31
                Icon: =Icon.Trash
                OnSelect: |
                    =RemoveIf(colCopackerSaved, ID = ThisItem.ID);
                Visible: =If(CountIf('Copacker Form',ID=ThisItem.ID)>0,false,true)
                Width: =35
                X: =1157
                Y: =4
                ZIndex: =8

            CPP_ProdName_2 As text:
                BorderColor: =If(IsBlank(CPP_ProdName_2.Text),Red,DimGrey)
                Default: =ThisItem.Variant
                DisplayMode: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0,White,Transparent)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Variant (e.g 'Chilled Soya Bean')"
                Width: =290
                X: =102
                ZIndex: =9

            CPP_ProdItemCode_2 As text:
                BorderColor: =If(IsBlank(CPP_ProdItemCode_2.Text),Red,DimGrey)
                Default: =ThisItem.ItemCode
                DisplayMode: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0,White,Transparent)
                Format: =TextFormat.Number
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Item Code (e.g '0123')"
                Width: =82
                ZIndex: =10

            "'CPPID-test_1' As text":
                BorderColor: =If(IsBlank('CPPID-test_1'.Text), Red, DimGrey)
                Default: =ThisItem.ID
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Visible: =false
                Width: =70
                X: =392
                ZIndex: =11

            CPP_Conversion_Unit_1 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPP_Conversion_Unit_1.Text), Red, DimGrey)
                Default: =LookUp(colCopackerSaved,ID=ThisItem.ID).UCCUnit
                DisplayMode: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0,White,Transparent)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Unit Conversion Coefficient (eg.'Litre/Case')"
                Width: =117
                X: =501
                ZIndex: =12

            CPP_UnitConversion_Amt_1 As text:
                Align: =Center
                BorderColor: =If(IsBlank(CPP_UnitConversion_Amt_1.Text), Red, DimGrey)
                Default: =LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt
                DisplayMode: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0, DisplayMode.Edit, DisplayMode.View)
                Fill: =If(CountRows(Filter('Copacker Form', ID = ThisItem.ID)) = 0,White,Transparent)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(
                        CountIf(colCopackerSaved,ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerSaved,First(Filter(colCopackerSaved,ID=ThisItem.ID)),{FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                      }),
                    
                    Collect(colCopackerSaved,{
                        FormNo:CPPFormNo_1.Text, BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName: varUserName, RequestorEmail: varUserEmail, Variant:CPP_ProdName_2.Text, ItemCode: CPP_ProdItemCode_2.Text, 
                        ID:ThisItem.ID, Copacker: Label26_2.Text,
                    
                        UCCAmt: Value(CPP_UnitConversion_Amt_1.Text), 
                        UCCUnit: CPP_Conversion_Unit_1.Text,
                    
                        OpeningBalance:Value(CPPOB_24.Text), 
                        OpeningBalance2: If(CountIf('Copacker Form', ID=ThisItem.ID)>0,
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt'/ 100,0),
                        Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Production: Value(CPPProd_5.Text),
                        Production2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0), Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        DeliveredtoWarehouse: Value(CPPDelivered_5.Text),
                        DeliveredtoWarehouse0: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                        Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), Round(Value(CPPDelivered_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        Rejected: Value(CPPRejected_5.Text),
                         Rejected2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Value(Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0)), Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved, ID = ThisItem.ID).UCCAmt/ 100,0)),
                    
                        ClosingBalance: Value(CPPOB_24.Text + CPPProd_5.Text - CPPDelivered_5.Text - CPPRejected_5.Text),
                         ClosingBalance2: If(CountIf('Copacker Form',ID=ThisItem.ID)>0,
                         Round(Value(CPPProd_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerList, 'Product Name' = CPP_ProdName_2.Text).'Unit Conversion Coefficient Amt' / 10,0), 
                    
                        Round(Value(CPPProd_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100, 0) + Round(Value(CPPOB_24.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 100,0) - Round(Value(CPPDelivered_5.Text) *  LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0) - Round(Value(CPPRejected_5.Text) * LookUp(colCopackerSaved,ID=ThisItem.ID).UCCAmt / 10,0))
                    
                        
                           }));
                    
                Size: =10
                Tooltip: ="Unit Conversion Coefficient (eg.'7.2')"
                Width: =70
                X: =421
                ZIndex: =13

        "'Add-CPP_2' As group":
            Height: =5
            Width: =5
            X: =60
            Y: =60
            ZIndex: =16

            "'Add-bttn-CPP_10' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =Collect(
                        colCopackerSaved,
                        {Variant:"", ID: Sum(Last(colCopackerSaved).ID + 1), Copacker: Label26_2.Text});
                    
                    Set(varAddCopacker,true)
                    
                    
                    
                PaddingLeft: =30
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(Checkbox1_2.Value, true,false)
                Width: =80
                X: =
                Y: =CountRows(Filter(colCopackerList,Copacker=Label26_2.Text).BU)*45+100
                ZIndex: =14

            Icon22_36 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =Collect(
                        colCopackerSaved,
                        {Variant:"", ID: Sum(Last(colCopackerSaved).ID + 1), Copacker: Label26_2.Text});
                    
                    Set(varAddCopacker,true)
                    
                    
                    
                Visible: =If(Checkbox1_2.Value, true,false)
                Width: =28
                Y: =CountRows(Filter(colCopackerList,Copacker=Label26_2.Text).BU)*45+100+12
                ZIndex: =15

        Checkbox1_2 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            OnSelect: =Select(Parent)
            Text: ="Show all SKU"
            Width: =297
            X: =323
            ZIndex: =17

    Gallery5_hl_1 As gallery.variableTemplateHeightGallery:
        Height: =215
        Items: =Filter(colCopackerBU,BU = CPPBU_1.Text).Copacker
        Layout: =Layout.Vertical
        TemplateSize: =182
        Visible: =If(CPPSaved && varHL,true,false)
        Width: =1223
        X: =60
        Y: =449
        ZIndex: =19

        Button8_60 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =49
            Text: =""
            Width: =1213
            ZIndex: =1

        Circle1_17 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =29
            Y: =9
            ZIndex: =2

        Icon22_21 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =22
            Icon: =Icon.Post
            OnSelect: =Select(Parent)
            Width: =22
            X: =33
            Y: =13
            ZIndex: =3

        Label26_3 As label:
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =34
            OnSelect: =Select(Parent)
            Text: =ThisItem.Copacker
            Width: =910
            X: =76
            Y: =8
            ZIndex: =4

        Gallery6_3 As gallery.variableTemplateHeightGallery:
            Height: =If(Checkbox1_3.Value,CountRows(Gallery6_3.AllItems)*50+10,0)
            Items: =If(Checkbox1_3.Value, Filter(colCopackerSaved,Copacker = Label26_3.Text),Filter(colCopackerSaved,Copacker = ""))
            Layout: =Layout.Vertical
            TemplateSize: =244
            Width: =1213
            Y: =Button8_60.Height
            ZIndex: =5

            CPPOB_32 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved,ID=ThisItem.ID).OpeningBalance2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =660
                ZIndex: =3

            CPPProd_6 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved,ID=ThisItem.ID).Production2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =771
                ZIndex: =4

            CPPDelivered_6 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved,ID=ThisItem.ID).DeliveredtoWarehouse0,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =862
                ZIndex: =5

            CPPRejected_6 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved,ID=ThisItem.ID).Rejected2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =963
                ZIndex: =6

            CPPClosingBalance_6 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                BorderThickness: =0
                Default: |-
                    =Text(
                    LookUp(colCopackerSaved,ID=ThisItem.ID).ClosingBalance2,"###,###,###")
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                Size: =10
                Width: =70
                X: =1064
                ZIndex: =7

            CPP_ProdName_3 As text:
                BorderColor: =If(IsBlank(CPP_ProdName_3.Text),Red,DimGrey)
                BorderThickness: =0
                Default: =ThisItem.Variant
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(
                        CountIf(colCopacker,Variant=CPP_ProdName_3.Text)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,Variant=CPP_ProdName_3.Text)),{OpeningBalance:Value(CPPOB_32.Text),OpeningBalance2: Value(CPPOB_32.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_3.Text).'Unit Conversion Coefficient Amt' / 100,ClosingBalance: Value(CPPClosingBalance_6.Text),'Item Code': CPP_ProdItemCode_3.Text, Copacker: Label26_3.Text}),
                        
                        Collect(colCopacker,{OpeningBalance:Value(CPPOB_32.Text),OpeningBalance2: Value(CPPOB_32.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_3.Text).'Unit Conversion Coefficient Amt' / 100,Variant:CPP_ProdName_3.Text,ClosingBalance: Value(CPPClosingBalance_6.Text),'Item Code': CPP_ProdItemCode_3.Text,Copacker: Label26_3.Text}))
                Size: =10
                Width: =326
                X: =102
                ZIndex: =9

            CPP_ProdItemCode_3 As text:
                BorderColor: =If(IsBlank(CPP_ProdItemCode_3.Text),Red,DimGrey)
                BorderThickness: =0
                Default: =ThisItem.ItemCode
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                HoverBorderColor: =Self.BorderColor
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(
                        CountIf(colCopacker,Variant=CPP_ProdName_3.Text)>0,
                    
                        Patch(colCopacker,First(Filter(colCopacker,Variant=CPP_ProdName_3.Text)),{OpeningBalance:Value(CPPOB_32.Text),OpeningBalance2: Value(CPPOB_32.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_3.Text).'Unit Conversion Coefficient Amt' / 100,ClosingBalance: Value(CPPClosingBalance_6.Text),'Item Code': CPP_ProdItemCode_3.Text, Copacker: Label26_3.Text}),
                        
                        Collect(colCopacker,{OpeningBalance:Value(CPPOB_32.Text),OpeningBalance2: Value(CPPOB_32.Text) * LookUp(colCopackerUnit, 'Product Name' = CPP_ProdName_3.Text).'Unit Conversion Coefficient Amt' / 100,Variant:CPP_ProdName_3.Text,ClosingBalance: Value(CPPClosingBalance_6.Text),'Item Code': CPP_ProdItemCode_3.Text,Copacker: Label26_3.Text}))
                Size: =10
                Width: =82
                ZIndex: =10

        Checkbox1_3 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            OnSelect: =Select(Parent)
            Text: ="Show all SKU"
            Width: =297
            X: =323
            ZIndex: =6

    CPP_Save_bttn_5 As button:
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderThickness: =0
        Fill: =RGBA(128, 128, 128, 1)
        Height: =42
        HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        HoverFill: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        OnSelect: =Set(popupuserupdatecpp,true)
        Size: =13
        Text: |-
            ="Save update
            "
        Visible: =If(CPPSaved,true,false)
        Width: =200
        X: =918
        Y: =703
        ZIndex: =20

    CPP_Submit_bttn_4 As button:
        BorderThickness: =0
        Fill: =RGBA(0, 161, 233, 1)
        Height: =42
        HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
        OnSelect: =Set(popupuserupdatesubmit,true)
        Size: =13
        Text: ="Submit"
        Visible: =If(CPPSaved,true,false)
        Width: =200
        X: =1133
        Y: =703
        ZIndex: =21

    Pop_Up_NewCPP As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =34

        Button8_49 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            Height: =669
            Text: =""
            Visible: =popupnewcpp
            Width: =1366
            Y: =99
            ZIndex: =44

        DataCardKey25_9 As label:
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =73
            Size: =14
            Text: ="Please fill in the Copacker name"
            Visible: =popupnewcpp
            Width: =1083
            Wrap: =false
            X: =37
            Y: =212
            ZIndex: =45

        "Gallery8_1 As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver4.0'":
            Height: =278
            Items: =First(Sort('Copacker BU List',ID,SortOrder.Descending))
            Layout: =Layout.Vertical
            TemplatePadding: =0
            TemplateSize: =76
            Visible: =popupnewcpp
            Width: =1347
            X: =19
            Y: =274
            ZIndex: =46

            Separator5_1 As rectangle:
                Fill: =RGBA(230, 230, 230, 1)
                Height: =1
                OnSelect: =Select(Parent)
                Width: =Parent.TemplateWidth
                Y: =Parent.TemplateHeight - 1
                ZIndex: =5

            TextInput7_1 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =""
                Height: =41
                OnSelect: =Select(Parent)
                Reset: =resettext
                Width: =673
                X: =18
                Y: =16
                ZIndex: =6

            TextInput3_1 As text:
                Default: =ThisItem.ID
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =117
                X: =734
                Y: =17
                ZIndex: =7

        Submit_Bttn_21 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            Fill: =RGBA(0, 161, 233, 1)
            Height: =44
            HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
            OnSelect: |
                =Collect(colCopackerBU,{Copacker: TextInput7_1.Text, BU: CPPBU_1.Text, ID: CountRows(colCopackerSaved)+1});
                Set(popupnewcpp,false);
                UpdateContext({resettext: !resettext})
            Size: =13
            Text: ="Done"
            Visible: =popupnewcpp
            Width: =209
            X: =706
            Y: =684
            ZIndex: =47

        CPP_Save_bttn_4 As button:
            BorderColor: =RGBA(128, 128, 128, 1)
            BorderThickness: =0
            Fill: =RGBA(128, 128, 128, 1)
            Height: =42
            HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
            HoverFill: =ColorFade(RGBA(128, 128, 128, 1), -4%)
            OnSelect: =Set(popupnewcpp,false)
            Size: =13
            Text: ="Cancel"
            Visible: =popupnewcpp
            Width: =200
            X: =452
            Y: =684
            ZIndex: =48

    Pop_Up_Are_You_Sure As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =34

        Button8_56 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(255, 255, 255, 1)
            Height: =669
            Text: =""
            Visible: =popupyousure
            Width: =1366
            Y: =99
            ZIndex: =40

        DataCardKey25_18 As label:
            Align: =Center
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =72
            Size: =14
            Text: ="Are you sure you want to add a new Copacker?"
            Visible: =popupyousure
            Width: =1083
            Wrap: =false
            X: =142
            Y: =354
            ZIndex: =41

        Areyousureyes As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            Fill: =RGBA(0, 161, 233, 1)
            Height: =44
            HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
            OnSelect: |
                =Set(popupnewcpp,true);
                Set(popupyousure,false)
            Size: =13
            Text: ="Yes"
            Visible: =popupyousure
            Width: =209
            X: =706
            Y: =684
            ZIndex: =42

        Areyousureno As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupyousure,false)
            Size: =13
            Text: ="Cancel"
            Visible: =popupyousure
            Width: =209
            X: =452
            Y: =684
            ZIndex: =43

    BG_27 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =36

        Image3_34 As image:
            Height: =768
            Image: =asahi_people
            ImagePosition: =ImagePosition.Fill
            Width: =1366
            ZIndex: =1

        Rectangle1_61 As rectangle:
            Fill: =RGBA(255, 255, 255, 0.97)
            Height: =768
            Width: =1365
            ZIndex: =2

    Pop_Up_User_Save_New As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =44

        Rectangle5_28 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupusersavecpp
            Width: =1366
            ZIndex: =28

        Submit_Bttn_22 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            BorderThickness: =0
            Fill: =RGBA(128, 128, 128, 1)
            Height: =44
            HoverColor: =ColorFade(Self.Color, -4%)
            HoverFill: =ColorFade(Self.Fill, -4%)
            OnSelect: |-
                =ForAll(colCopacker As aPatch,If(IsBlank(LookUp('Copacker Form',ID=aPatch.ID).ID),
                Patch('Copacker Form',{
                
                        FormNo:CPPFormNo_1.Text,
                        Status:"Saved", BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value,Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Copacker: aPatch.Copacker, 'Item Code': aPatch.ItemCode,
                        Variant: aPatch.ProductName, 'Opening Balance (RC)': aPatch.OpeningBalance, 
                        'Opening Balance (hL)': aPatch.OpeningBalance2, 'Production (RC)': aPatch.Production, 
                        'Production (hL)': aPatch.Production2, 'Delivered to Warehouse (RC)': aPatch.DeliveredtoWarehouse,
                        'Delivered to Warehouse (hL)': aPatch.DeliveredtoWarehouse0, 'Rejected (RC)': aPatch.Rejected, 
                        'Rejected (hL)': aPatch.Rejected2, 'Closing Balance (RC)': aPatch.ClosingBalance, 
                        'Closing Balance (hL)': aPatch.ClosingBalance2, 
                        UCCAmt: Value(aPatch.UnitConversionCoefficientAmt), UCCUnit: aPatch.UnitConversionCoefficient
                
                }),
                
                      Patch(
                         'Copacker Form',
                         {
                             
                        ID:aPatch.ID,
                        FormNo:CPPFormNo_1.Text,
                        Status:"Saved", BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value,Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Copacker: aPatch.Copacker, 'Item Code': aPatch.ItemCode,
                        Variant: aPatch.ProductName, 'Opening Balance (RC)': aPatch.OpeningBalance, 
                        'Opening Balance (hL)': aPatch.OpeningBalance2, 'Production (RC)': aPatch.Production, 
                        'Production (hL)': aPatch.Production2, 'Delivered to Warehouse (RC)': aPatch.DeliveredtoWarehouse,
                        'Delivered to Warehouse (hL)': aPatch.DeliveredtoWarehouse0, 'Rejected (RC)': aPatch.Rejected, 
                        'Rejected (hL)': aPatch.Rejected2, 'Closing Balance (RC)': aPatch.ClosingBalance, 
                        'Closing Balance (hL)': aPatch.ClosingBalance2, 
                        UCCAmt: Value(aPatch.UnitConversionCoefficientAmt), UCCUnit: aPatch.UnitConversionCoefficient
                        }
                      )
                
                )
                );
                
                If(IsBlank(LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text))),
                      Patch(
                         'Copacker Master Form',
                         {
                        FormNo: CPPFormNo_1.Text, Status:"Saved", BU: CPPBU_1.Text, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Month: MonthCPP_1.SelectedText}),
                
                      Patch(
                         'Copacker Master Form',
                         LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text),
                         {
                        FormNo: CPPFormNo_1.Text, Status:"Saved", BU: CPPBU_1.Text, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Month: MonthCPP_1.SelectedText
                
                        }
                      )
                )
                );
                
                
                UpdateContext({ResetYearUFE:true});
                UpdateContext({ResetMonthUFE:true});
                UpdateContext({ResetNonWorkingDaysUFE:true});
                 
                Navigate(Successful);
            PressedColor: =ColorFade(Self.Color, -4%)
            PressedFill: =ColorFade(Self.Fill, -4%)
            Size: =13
            Text: ="Yes"
            Visible: =popupusersavecpp
            Width: =209
            X: =452
            Y: =664
            ZIndex: =29

        Cancel_Bttn_24 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupusersavecpp,false)
            Size: =13
            Text: ="No"
            Visible: =popupusersavecpp
            Width: =209
            X: =687
            Y: =664
            ZIndex: =30

        Circle2_24 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupusersavecpp
            Width: =65
            X: =651
            Y: =264
            ZIndex: =31

        Image6_21 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupusersavecpp
            Width: =45
            X: =661
            Y: =274
            ZIndex: =32

        Label3_40 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Do you want to save the form?"
            Visible: =popupusersavecpp
            Width: =681
            X: =343
            Y: =362
            ZIndex: =33

    Pop_Up_User_Update_New As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =48

        Rectangle5_33 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupuserupdatecpp
            Width: =1366
            ZIndex: =49

        Submit_Bttn_28 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            BorderThickness: =0
            Fill: =RGBA(128, 128, 128, 1)
            Height: =44
            HoverColor: =ColorFade(Self.Color, -4%)
            HoverFill: =ColorFade(Self.Fill, -4%)
            OnSelect: |+
                =ForAll(colCopackerSaved As aPatch,If(!IsBlank(LookUp('Copacker Form',ID=aPatch.ID).ID),
                
                      Patch(
                         'Copacker Form',
                         {
                             
                        ID:aPatch.ID,
                        FormNo:CPPFormNo_1.Text,
                        Status:"Saved", BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value,Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Copacker: aPatch.Copacker, 'Item Code': aPatch.ItemCode,
                        Variant: aPatch.Variant, 'Opening Balance (RC)': aPatch.OpeningBalance, 
                        'Opening Balance (hL)': aPatch.OpeningBalance2, 'Production (RC)': aPatch.Production, 
                        'Production (hL)': aPatch.Production2, 'Delivered to Warehouse (RC)': aPatch.DeliveredtoWarehouse,
                        'Delivered to Warehouse (hL)': aPatch.DeliveredtoWarehouse0, 'Rejected (RC)': aPatch.Rejected, 
                        'Rejected (hL)': aPatch.Rejected2, 'Closing Balance (RC)': aPatch.ClosingBalance, 
                        'Closing Balance (hL)': aPatch.ClosingBalance2, UCCAmt: aPatch.UCCAmt, UCCUnit: aPatch.UCCUnit
                        }
                      )
                )
                );
                
                If(!IsBlank(LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text))),
                      Patch(
                         'Copacker Master Form',
                         LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text),
                         {
                        FormNo: CPPFormNo_1.Text, Status:"Saved", BU: CPPBU_1.Text, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Month: MonthCPP_1.SelectedText
                
                        }
                      )
                )
                );
                
                Navigate(Successful)
                
                
                
            PressedColor: =ColorFade(Self.Color, -4%)
            PressedFill: =ColorFade(Self.Fill, -4%)
            Size: =13
            Text: ="Yes"
            Visible: =popupuserupdatecpp
            Width: =209
            X: =452
            Y: =664
            ZIndex: =50

        Cancel_Bttn_30 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupuserupdatecpp,false)
            Size: =13
            Text: ="No"
            Visible: =popupuserupdatecpp
            Width: =209
            X: =687
            Y: =664
            ZIndex: =51

        Circle2_37 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupuserupdatecpp
            Width: =65
            X: =651
            Y: =264
            ZIndex: =52

        Image6_22 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupuserupdatecpp
            Width: =45
            X: =661
            Y: =274
            ZIndex: =53

        Label3_45 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Do you want to save the form?"
            Visible: =popupuserupdatecpp
            Width: =681
            X: =343
            Y: =362
            ZIndex: =54

    Pop_Up_User_Update_Submit As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =55

        Rectangle5_34 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupuserupdatesubmit
            Width: =1366
            ZIndex: =55

        Submit_Bttn_29 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            Fill: =RGBA(0, 161, 233, 1)
            Height: =44
            HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
            OnSelect: |+
                =ForAll(colCopackerSaved As aPatch,If(!IsBlank(LookUp('Copacker Form',ID=aPatch.ID).ID),
                
                      Patch(
                         'Copacker Form',
                         {
                             
                        ID:aPatch.ID,
                        FormNo:CPPFormNo_1.Text,
                        Status:"Pending approval", BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value,Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Copacker: aPatch.Copacker, 'Item Code': aPatch.ItemCode,
                        Variant: aPatch.Variant, 'Opening Balance (RC)': aPatch.OpeningBalance, 
                        'Opening Balance (hL)': aPatch.OpeningBalance2, 'Production (RC)': aPatch.Production, 
                        'Production (hL)': aPatch.Production2, 'Delivered to Warehouse (RC)': aPatch.DeliveredtoWarehouse,
                        'Delivered to Warehouse (hL)': aPatch.DeliveredtoWarehouse0, 'Rejected (RC)': aPatch.Rejected, 
                        'Rejected (hL)': aPatch.Rejected2, 'Closing Balance (RC)': aPatch.ClosingBalance, 
                        'Closing Balance (hL)': aPatch.ClosingBalance2, UCCAmt: aPatch.UCCAmt, UCCUnit: aPatch.UCCUnit
                        }
                      )
                )
                );
                
                If(!IsBlank(LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text))),
                      Patch(
                         'Copacker Master Form',
                         LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text),
                         {
                        FormNo: CPPFormNo_1.Text, Status:"Pending approval", BU: CPPBU_1.Text, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Month: MonthCPP_1.SelectedText
                
                        }
                      )
                )
                );
                
                Navigate(Successful)
                
                
                
            Size: =13
            Text: ="Submit"
            Visible: =popupuserupdatesubmit
            Width: =209
            X: =709
            Y: =664
            ZIndex: =56

        Cancel_Bttn_31 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupuserupdatesubmit,false)
            Size: =13
            Text: ="Cancel"
            Visible: =popupuserupdatesubmit
            Width: =209
            X: =474
            Y: =664
            ZIndex: =57

        Circle2_38 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupuserupdatesubmit
            Width: =65
            X: =651
            Y: =264
            ZIndex: =58

        Image6_25 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupuserupdatesubmit
            Width: =45
            X: =661
            Y: =274
            ZIndex: =59

        Label3_46 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Are you sure you want to submit the form for approval?"
            Visible: =popupuserupdatesubmit
            Width: =681
            X: =343
            Y: =362
            ZIndex: =60

    Popupalreadysubmit_CPP As group:
        Height: =5
        Width: =5
        X: =80
        Y: =80
        ZIndex: =61

        Rectangle5_41 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupalreadysubmitcpp
            Width: =1366
            ZIndex: =22

        Circle2_47 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupalreadysubmitcpp
            Width: =65
            X: =651
            Y: =264
            ZIndex: =23

        Label3_50 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: |-
                ="Form already in system for selected month.
                Please click                       to update your form."
            Visible: =popupalreadysubmitcpp
            Width: =681
            X: =343
            Y: =362
            ZIndex: =24

        Icon11_1 As icon.Warning:
            Color: =RGBA(255, 255, 255, 1)
            Height: =42
            Icon: =Icon.Warning
            Visible: =popupalreadysubmitcpp
            Width: =42
            X: =663
            Y: =273
            ZIndex: =25

        "'Close-bttn-etika_13' As icon.CancelBadge":
            Color: =RGBA(0, 161, 233, 1)
            Height: =24
            Icon: =Icon.CancelBadge
            OnSelect: |-
                =Set(popupalreadysubmitcpp,false);
                Set(resetyearcpp,!resetyearcpp);Set(resetmonthcpp,!resetmonthcpp);
            Visible: =popupalreadysubmitcpp
            Width: =24
            X: =1336
            Y: =16
            ZIndex: =26

        Label10 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            OnSelect: |-
                =Set(popupalreadysubmitcpp,false);
                Set(resetyearcpp,true);Set(resetmonthcpp,true);
                Navigate(Status)
            Size: =18
            Text: ="status page"
            Underline: =true
            Visible: =popupalreadysubmitcpp
            Width: =158
            X: =550
            Y: =400
            ZIndex: =27

    Pop_Up_User_Submit_8 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =64

        Rectangle5_27 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupusersubmit
            Width: =1366
            ZIndex: =34

        Submit_Bttn_20 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            Fill: =RGBA(0, 161, 233, 1)
            Height: =44
            HoverFill: =ColorFade(RGBA(0, 161, 233, 1), -4%)
            OnSelect: |-
                =ForAll(colCopacker As aPatch,If(IsBlank(LookUp('Copacker Form',ID=aPatch.ID).ID),
                Patch('Copacker Form',{
                
                        FormNo:CPPFormNo_1.Text,
                        Status:"Pending approval", BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value,Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Copacker: aPatch.Copacker, 'Item Code': aPatch.ItemCode,
                        Variant: aPatch.ProductName, 'Opening Balance (RC)': aPatch.OpeningBalance, 
                        'Opening Balance (hL)': aPatch.OpeningBalance2, 'Production (RC)': aPatch.Production, 
                        'Production (hL)': aPatch.Production2, 'Delivered to Warehouse (RC)': aPatch.DeliveredtoWarehouse,
                        'Delivered to Warehouse (hL)': aPatch.DeliveredtoWarehouse0, 'Rejected (RC)': aPatch.Rejected, 
                        'Rejected (hL)': aPatch.Rejected2, 'Closing Balance (RC)': aPatch.ClosingBalance, 
                        'Closing Balance (hL)': aPatch.ClosingBalance2, 
                        UCCAmt: Value(aPatch.UnitConversionCoefficientAmt), UCCUnit: aPatch.UnitConversionCoefficient
                
                }),
                
                      Patch(
                         'Copacker Form',
                         {
                             
                        ID:aPatch.ID,
                        FormNo:CPPFormNo_1.Text,
                        Status:"Pending approval", BU:CPPBU_1.Text, Month:MonthCPP_1.Selected.Value,Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Copacker: aPatch.Copacker, 'Item Code': aPatch.ItemCode,
                        Variant: aPatch.ProductName, 'Opening Balance (RC)': aPatch.OpeningBalance, 
                        'Opening Balance (hL)': aPatch.OpeningBalance2, 'Production (RC)': aPatch.Production, 
                        'Production (hL)': aPatch.Production2, 'Delivered to Warehouse (RC)': aPatch.DeliveredtoWarehouse,
                        'Delivered to Warehouse (hL)': aPatch.DeliveredtoWarehouse0, 'Rejected (RC)': aPatch.Rejected, 
                        'Rejected (hL)': aPatch.Rejected2, 'Closing Balance (RC)': aPatch.ClosingBalance, 
                        'Closing Balance (hL)': aPatch.ClosingBalance2, 
                        UCCAmt: Value(aPatch.UnitConversionCoefficientAmt), UCCUnit: aPatch.UnitConversionCoefficient
                        }
                      )
                
                )
                );
                
                If(IsBlank(LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text))),
                      Patch(
                         'Copacker Master Form',
                         {
                        FormNo: CPPFormNo_1.Text, Status:"Pending approval", BU: CPPBU_1.Text, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Month: MonthCPP_1.SelectedText}),
                
                      Patch(
                         'Copacker Master Form',
                         LookUp('Copacker Master Form',ID=Value(DataCardValue2.Text),
                         {
                        FormNo: CPPFormNo_1.Text, Status:"Pending approval", BU: CPPBU_1.Text, Year:Value(YearCPP_1.Selected.Value),
                        RequestorName:varUserName, RequestorEmail:varUserEmail, Month: MonthCPP_1.SelectedText
                
                        }
                      )
                )
                );
                
                
                UpdateContext({ResetYearUFE:true});
                UpdateContext({ResetMonthUFE:true});
                UpdateContext({ResetNonWorkingDaysUFE:true});
                 
                Navigate(Successful);
            Size: =13
            Text: ="Submit"
            Visible: =popupusersubmit
            Width: =209
            X: =709
            Y: =664
            ZIndex: =35

        Cancel_Bttn_23 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupusersubmit,false)
            Size: =13
            Text: ="Cancel"
            Visible: =popupusersubmit
            Width: =209
            X: =474
            Y: =664
            ZIndex: =36

        Circle2_22 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupusersubmit
            Width: =65
            X: =651
            Y: =264
            ZIndex: =37

        Image6_24 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupusersubmit
            Width: =45
            X: =661
            Y: =274
            ZIndex: =38

        Label3_39 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Are you sure you want to submit the form for approval?"
            Visible: =popupusersubmit
            Width: =681
            X: =343
            Y: =362
            ZIndex: =39

