"'Coefficient_Requestor-KotaSan' As screen":
    Height: =
    OnVisible: |-
        =ClearCollect(colCoefficient, AddColumns('Coefficients for G-KPI Calculation',"IsChoosen",false));
        
        ClearCollect(colCoefficient, Filter('Coefficients for G-KPI Calculation', Coefficient <> "Unit CO2 Emission by Electricity MY" &&
        Coefficient <> "Unit CO2 Emission by Electricity ID"));
        
        ClearCollect(colCoefficientCopacker,'Copacker List');
        
        ClearCollect(colCopackerKSChangeLog,ShowColumns('Coefficients for G-KPI Calculation Change Log',"ID", "ChangeLogNew", "Item", "ChangeLogCO2","ChangeLogDS", "Remarks", "EffectiveDate",  "Coefficient"));
        
        Clear(colCopackerKSChangeLog);
        
        Set(popupsavecoefficientcppKS,false); Set(savecppKS,false); Set(updatecppKS,false);
        
        Set(varCoefficientEdit,false)

    HtmlText1_10 As htmlViewer:
        Height: =704
        HtmlText: |-
            ="<div style='background-color: rgba(253,253,253,1); box-shadow: 1px 2px 22px 0px rgba(236,236,236,1); margin: 30px; width: 1295px; height: 630px; border-radius: 10px'></div>"
        Width: =1366
        Y: =64
        ZIndex: =3

    SubHeader_24 As SubHeader:
        Height: =95
        ZIndex: =4

    Header_35 As Header:
        HeaderText: ="Coefficients for G-KPI Calculation (Utility Related)"
        ZIndex: =5

    Gallery7 As gallery.variableTemplateHeightGallery:
        Height: =539
        Items: =Distinct(colCoefficient, Coefficient)
        Layout: =Layout.Vertical
        TemplateSize: =280
        Width: =1282
        X: =42
        Y: =114
        ZIndex: =7

        Gallery9 As gallery.variableTemplateHeightGallery:
            Height: =CountRows(Filter(colCoefficient,Coefficient =  Label28.Text))*80
            Items: =Filter(colCoefficient,Coefficient = Label28.Text)
            Layout: =Layout.Vertical
            TemplateFill: =If(ThisItem.IsChoosen,RGBA(247, 247, 247, 1),Transparent)
            TemplateSize: =204
            Visible: =If(ThisItem.Result <> "Copacker Products" && Checkbox1_7.Value,true,false)
            Width: =1283
            Y: =Label31_10.Y+30
            ZIndex: =3

            TextInput6 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: |
                    =ThisItem.Title
                DisplayMode: =If(CountRows(Filter('Coefficients for G-KPI Calculation',ID = ThisItem.ID))=0, DisplayMode.Edit,View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                Mode: =TextMode.MultiLine
                OnChange: |+
                    =If(
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0, 
                        Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                        {Title: TextInput6.Text}),
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0, 
                        Patch(colCoefficient,
                        {Title: TextInput6.Text, Coefficient: Label28.Text})
                    
                    );
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item", ID:ThisItem.ID, Coefficient: Label28.Text
                        
                        }));
                    
                OnSelect: =Select(Parent)
                PaddingLeft: =3
                PaddingTop: =20
                Size: =11
                Width: =184
                X: =292
                Y: =3
                ZIndex: =1

            TextInput6_1 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =ThisItem.Unit
                DisplayMode: =If(CountRows(Filter('Coefficients for G-KPI Calculation',ID = ThisItem.ID))=0, DisplayMode.Edit,View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0, 
                        Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                        {Unit: TextInput6_1.Text}),
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0, 
                        Patch(colCoefficient,
                        {Unit: TextInput6_1.Text, Coefficient: Label28.Text})
                    
                    );
                    
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item", ID:ThisItem.ID, Coefficient: Label28.Text
                        
                        }));
                OnSelect: =Select(Parent)
                PaddingLeft: =3
                Size: =11
                Width: =61
                X: =489
                Y: =3
                ZIndex: =2

            TextInput6_2 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Color: |
                    =If(
                    
                    Label28.Text = "Fuel", RGBA(27, 179, 55, 1),
                    TextInput6.Text = "Condensed Milk", RGBA(27, 179, 55, 1),
                    
                    Black)
                Default: |+
                    =ThisItem.'Unit Calorific (Fuel) Value'
                    
                DisplayMode: |-
                    =If(ThisItem.IsChoosen && Label28.Text = "Fuel",DisplayMode.Edit,
                    ThisItem.IsChoosen && TextInput6.Text = "Condensed Milk",DisplayMode.Edit,
                    ThisItem.IsChoosen && TextInput6.Text = "Powder",DisplayMode.Edit,
                    CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,DisplayMode.Edit,
                    View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |
                    =If(
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0, 
                        Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                        {'Unit Calorific (Fuel) Value': Value(TextInput6_2.Text)}),
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0, 
                        Patch(colCoefficient,
                        {'Unit Calorific (Fuel) Value': Value(TextInput6_2.Text), Coefficient: Label28.Text})
                    
                    );
                    
                    
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {ChangeLogNew: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit Calorific (Fuel) Value' & " change to " & TextInput6_2.Text
                    
                        }),
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,  
                    
                        Collect(colCopackerKSChangeLog,{ID:ThisItem.ID, ChangeLogNew: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit Calorific (Fuel) Value' & " change to " & TextInput6_2.Text, Item:TextInput6.Text, Coefficient: Label28.Text}),
                        
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item", ID:ThisItem.ID, Coefficient: Label28.Text
                        
                        }));
                    
                    If(Value(TextInput6_2.Text)=Value(LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit Calorific (Fuel) Value'),
                    Remove(colCopackerKSChangeLog,First( Filter(colCopackerKSChangeLog, ID=ThisItem.ID ) ) ));
                OnSelect: =Select(Parent)
                PaddingLeft: =3
                Size: =11
                Visible: =If(TextInput6.Text<>"Electricity Malaysia" && TextInput6.Text<>"Electricity Indonesia",true,false)
                Width: =71
                X: =563
                Y: =3
                ZIndex: =3

            TextInput6_3 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =ThisItem.'Unit Calorific Value (Fuel) Unit'
                DisplayMode: =If(CountRows(Filter('Coefficients for G-KPI Calculation',ID = ThisItem.ID))=0, DisplayMode.Edit,View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0, 
                        Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                        {'Unit Calorific Value (Fuel) Unit': TextInput6_3.Text}),
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0,
                        Patch(colCoefficient,
                        {'Unit Calorific Value (Fuel) Unit': TextInput6_3.Text, Coefficient: Label28.Text})
                    );
                    
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item",  ID:ThisItem.ID, Coefficient: Label28.Text
                        
                        }));
                OnSelect: =Select(Parent)
                PaddingLeft: =3
                Size: =11
                Width: =90
                X: =647
                Y: =3
                ZIndex: =4

            TextInput6_4 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Color: =RGBA(27, 179, 55, 1)
                Default: =ThisItem.'Unit CO2 Emmission (Fuel) Value'
                DisplayMode: |-
                    =If(ThisItem.IsChoosen && Label28.Text = "Fuel",DisplayMode.Edit,
                    ThisItem.IsChoosen && TextInput6.Text = "Condensed Milk",DisplayMode.Edit,
                    CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,DisplayMode.Edit,
                    View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0,
                    Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                    {'Unit CO2 Emmission (Fuel) Value': Value(TextInput6_4.Text)}),
                    CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0,
                    Patch(colCoefficient,
                    {'Unit CO2 Emmission (Fuel) Value': Value(TextInput6_4.Text), Coefficient: Label28.Text}));
                    
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {ChangeLogCO2: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit CO2 Emmission (Fuel) Value' & " change to " & TextInput6_4.Text
                    
                        }),
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,  
                    
                        Collect(colCopackerKSChangeLog,{ID:ThisItem.ID, ChangeLogCO2: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit CO2 Emmission (Fuel) Value' & " change to " & TextInput6_4.Text, Item:TextInput6.Text, Coefficient: Label28.Text}),
                        
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item",  ID:ThisItem.ID, Coefficient: Label28.Text}));
                    
                    If(Value(TextInput6_4.Text)=Value(LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit CO2 Emmission (Fuel) Value'),
                    Remove(colCopackerKSChangeLog,First( Filter(colCopackerKSChangeLog, ID=ThisItem.ID ) ) ));
                OnSelect: =Select(Parent)
                PaddingLeft: =3
                Size: =11
                Visible: =If(Label28.Text = "Fuel", true, false)
                Width: =71
                X: =750
                Y: =3
                ZIndex: =5

            TextInput6_5 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =ThisItem.'Unit CO2 Emmission (Fuel) Unit'
                DisplayMode: =If(CountRows(Filter('Coefficients for G-KPI Calculation',ID = ThisItem.ID))=0, DisplayMode.Edit,DisplayMode.View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |+
                    =If(CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0,
                    Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                    {'Unit CO2 Emmission (Fuel) Unit':TextInput6_5.Text}),
                    CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0,
                    Patch(colCoefficient,{'Unit CO2 Emmission (Fuel) Unit':TextInput6_5.Text, Coefficient: Label28.Text}));
                    
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item",  ID:ThisItem.ID, Coefficient: Label28.Text
                        
                        }));
                    
                OnSelect: =Select(Parent)
                PaddingLeft: =3
                Size: =11
                Visible: =If(Label28.Text = "Fuel", true, false)
                Width: =108
                X: =834
                Y: =3
                ZIndex: =6

            TextInput6_6 As text:
                Align: =Left
                BorderColor: =RGBA(230, 230, 230, 1)
                Color: =RGBA(27, 179, 55, 1)
                Default: =ThisItem.DataSource
                DisplayMode: |-
                    =If(ThisItem.IsChoosen && Label28.Text = "Fuel",DisplayMode.Edit,
                    ThisItem.IsChoosen && TextInput6.Text = "Condensed Milk",DisplayMode.Edit,
                    CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,DisplayMode.Edit,
                    View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                Mode: =TextMode.MultiLine
                OnChange: |
                    =If(CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0,
                    Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                    {DataSource:TextInput6_6.Text}),
                    CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0,
                    Patch(colCoefficient,{DataSource:TextInput6_6.Text, Coefficient: Label28.Text}));
                    
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {ChangeLogDS: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).DataSource & " change to " & TextInput6_6.Text
                    
                        }),
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,  
                    
                        Collect(colCopackerKSChangeLog,{ID:ThisItem.ID, 
                        ChangeLogDS: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).DataSource & " change to " & TextInput6_6.Text, 
                        Item:TextInput6.Text, Coefficient: Label28.Text}),
                        
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item",  ID:ThisItem.ID, Coefficient: Label28.Text}));
                    
                    If(TextInput6_6.Text=LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).DataSource,
                    Remove(colCopackerKSChangeLog,First( Filter(colCopackerKSChangeLog, ID=ThisItem.ID ) ) ));
                OnSelect: =Select(Parent)
                PaddingLeft: =3
                PaddingTop: =20
                Size: =11
                Visible: =If(Label28.Text = "Fuel", true, false)
                Width: =279
                X: =955
                Y: =3
                ZIndex: =7

            TextInput9 As text:
                Default: =ThisItem.ID
                Fill: =RGBA(0, 0, 0, 0)
                Height: =49
                OnSelect: =Select(Parent)
                Visible: =false
                Width: =59
                X: =179
                Y: =3
                ZIndex: =9

            TextInput6_12 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =LookUp('Coefficients for G-KPI Calculation', Title=TextInput6.Text, true)
                DisplayMode: =If(CountRows(Filter('Coefficients for G-KPI Calculation', Coefficient = TextInput6_12.Text)) = 0, varCoefficientEdit, DisplayMode.Edit, DisplayMode.View)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =68
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnChange: |-
                    =If(
                        Label28.Text = "Fuel", 
                        Patch(colCoefficient, LookUp(colCoefficient, ID = Value(TextInput9.Text)),
                        {Title: TextInput6_12.Text})
                    
                    )
                OnSelect: =Select(Parent)
                Size: =11
                Visible: =false
                Width: =66
                X: =131
                ZIndex: =10

            DatePicker3 As datepicker:
                BorderColor: =RGBA(230, 230, 230, 1)
                DefaultDate: =ThisItem.EffectiveDate
                DisplayMode: |-
                    =If(ThisItem.IsChoosen && Label28.Text = "Fuel",DisplayMode.Edit,
                    ThisItem.IsChoosen && TextInput6.Text = "Condensed Milk",DisplayMode.Edit,
                    CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,DisplayMode.Edit,
                    View)
                Fill: =RGBA(0, 0, 0, 0)
                Format: ="mm/yyyy"
                Height: =35
                OnChange: |-
                    =If(
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))>0, 
                        Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),
                        {EffectiveDate: DatePicker3.SelectedDate}),
                        CountRows(Filter(colCoefficient,ID = ThisItem.ID))=0, 
                        Patch(colCoefficient,
                        {EffectiveDate: DatePicker3.SelectedDate, Coefficient: Label28.Text})
                    
                    );
                    
                    
                    If(
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {EffectiveDate: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).EffectiveDate & " change to " 
                        &DatePicker3.SelectedDate
                    
                        }),
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)>0,  
                    
                        Collect(colCopackerKSChangeLog,{ID:ThisItem.ID, EffectiveDate: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).EffectiveDate & " change to " & DatePicker3.SelectedDate, Item:TextInput6.Text, Coefficient: Label28.Text}),
                        
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)>0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Patch(colCopackerKSChangeLog,First(Filter(colCopackerKSChangeLog,ID=ThisItem.ID)),
                        {Item:TextInput6.Text}),
                    
                        CountIf(colCopackerKSChangeLog,ID=ThisItem.ID)=0 && CountIf('Coefficients for G-KPI Calculation',ID=ThisItem.ID)=0,  
                    
                        Collect(colCopackerKSChangeLog,
                        {Item:TextInput6.Text, Remarks:"new item", ID:ThisItem.ID, Coefficient: Label28.Text}));
                    
                    If( DatePicker3.SelectedDate=Value(LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).EffectiveDate),
                    Remove(colCopackerKSChangeLog,First( Filter(colCopackerKSChangeLog, ID=ThisItem.ID ) ) ))
                OnSelect: =Select(Parent)
                Size: =11
                Width: =179
                X: =100
                Y: =20
                ZIndex: =11

            Checkbox6 As checkbox:
                BorderColor: =RGBA(230, 230, 230, 1)
                CheckboxBorderColor: =RGBA(179, 179, 179, 1)
                Default: =ThisItem.IsChoosen
                Height: =36
                OnCheck: |-
                    =Patch(colCoefficient,ThisItem,{IsChoosen:true})
                OnSelect: =Select(Parent)
                OnUncheck: |-
                    =Patch(colCoefficient,ThisItem,{IsChoosen:false});
                    Patch(colCoefficient, LookUp(colCoefficient, ID = ThisItem.ID),{EffectiveDate:LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).EffectiveDate,'Unit Calorific (Fuel) Value':  LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit Calorific (Fuel) Value', 'Unit CO2 Emmission (Fuel) Value': LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).'Unit CO2 Emmission (Fuel) Value', DataSource: LookUp('Coefficients for G-KPI Calculation',ID = ThisItem.ID).DataSource });
                    Remove(colCopackerKSChangeLog,First( Filter(colCopackerKSChangeLog, ID=ThisItem.ID ) ) )
                Text: =""
                Visible: |-
                    =If(Label28.Text = "Fuel",true,
                    TextInput6.Text = "Condensed Milk",true,
                    TextInput6.Text = "Powder",true,
                    If(CountRows(Filter('Coefficients for G-KPI Calculation',ID = ThisItem.ID))=0,true,
                    false))
                Width: =52
                X: =10
                Y: =14
                ZIndex: =12

        Button8_52 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =45
            Text: =""
            Width: =1272
            ZIndex: =5

        Circle1_11 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =25
            Y: =8
            ZIndex: =6

        Icon22_18 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =16
            Icon: |-
                =If(
                    
                    Label28.Text = "Fuel", Icon.ToolsWrench,
                    Label28.Text = "Conversion Unit", Icon.Sync,
                    Label28.Text = "Product", Icon.ListWatchlistRemind,
                    Label28.Text = "Copacker Products", Icon.Post,
                    Label28.Text = "Electricity", Icon.LightningBolt
                
                )
            OnSelect: =Select(Parent)
            Width: =26
            X: =27
            Y: =15
            ZIndex: =7

        Label28 As label:
            AutoHeight: =true
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =44
            OnSelect: =Select(Parent)
            Text: =ThisItem.Result 
            Width: =928
            X: =61
            Y: =7
            ZIndex: =8

        Label31 As label:
            Height: =If(Checkbox1_7.Value,33,0)
            OnSelect: =Select(Parent)
            Size: =11
            Text: |
                =If(
                    Label28.Text = "Fuel","Fuel Type",
                    Label28.Text = "Conversion Unit","Unit Conversion From",
                    Label28.Text = "Product","Products Type",
                    Label28.Text = "Copacker Products","Products Name"
                
                )
            Visible: =If(Checkbox1_7.Value,true,false)
            Width: =208
            X: =If(Label28.Text="Copacker Products",205,295)
            Y: =50
            ZIndex: =9

        Label31_1 As label:
            Align: =Center
            Height: =If(Checkbox1_7.Value,33,0)
            OnSelect: =Select(Parent)
            Size: =11
            Text: |
                =If(
                    Label28.Text <> "Copacker Products","Unit",
                    Label28.Text = "Copacker Products","Item Code"
                
                )
            Visible: =If(Checkbox1_7.Value,true,false)
            Width: =116
            X: =If(Label28.Text="Copacker Products",550,462)
            Y: =50
            ZIndex: =10

        Label31_2 As label:
            Align: =Center
            Height: =If(Checkbox1_7.Value,33,0)
            OnSelect: =Select(Parent)
            Size: =11
            Text: |
                =If(
                    Label28.Text = "Fuel","Unit Calorific Value",
                    Label28.Text = "Conversion Unit","Unit Calorific Value",
                    Label28.Text = "Product","Unit Conversion Coefficient",
                    Label28.Text = "Copacker Products","Copacker/BU"
                
                )
            Visible: =If(Checkbox1_7.Value,true,false)
            Width: =200
            X: =If(Label28.Text="Copacker Products",730,554)
            Y: =50
            ZIndex: =11

        Label31_3 As label:
            Align: =Center
            Height: =If(Checkbox1_7.Value,33,0)
            OnSelect: =Select(Parent)
            Size: =11
            Text: |
                =If(
                    Label28.Text = "Fuel","Unit CO2 Emmission",
                    Label28.Text = "Copacker Products","Unit Conversion Coefficient"
                
                )
            Visible: =If(Checkbox1_7.Value,true,false)
            Width: =200
            X: =If(Label28.Text="Copacker Products",1030,742)
            Y: =50
            ZIndex: =12

        Label31_4 As label:
            Align: =Left
            Height: =If(Checkbox1_7.Value,33,0)
            OnSelect: =Select(Parent)
            Size: =11
            Text: |
                =If(
                    Label28.Text = "Fuel","Data Source"
                
                )
            Visible: =If(Checkbox1_7.Value,true,false)
            Width: =200
            X: =951
            Y: =50
            ZIndex: =13

        Checkbox1_7 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            Height: =36
            OnSelect: =Select(Parent)
            Text: ="Show all items"
            Width: =297
            X: =283
            Y: =5
            ZIndex: =16

        Label31_10 As label:
            Height: =If(Checkbox1_7.Value,33,0)
            OnSelect: =Select(Parent)
            Size: =11
            Text: ="Effective Date"
            Visible: =If(Checkbox1_7.Value,true,false)
            Width: =177
            X: =If(Label28.Text="Copacker Products",20,110)
            Y: =50
            ZIndex: =21

        "'Add-CPP_3' As group":
            Height: =5
            Width: =5
            X: =40
            Y: =40
            ZIndex: =21

            "'Add-bttn-CPP_11' As button":
                Align: =Left
                Color: =RGBA(0, 161, 233, 1)
                Fill: =RGBA(0, 0, 0, 0)
                Height: =37
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: |+
                    =Collect(
                        colCoefficient, 
                        {Coefficient: Label28.Text,
                        EffectiveDate: First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result,
                        ID: Last(colCoefficient).ID + 1})
                    
                    
                    
                    
                PaddingLeft: =30
                PressedColor: =Self.Color
                PressedFill: =Self.Fill
                Size: =12
                Text: ="Add"
                Visible: =If(Checkbox1_7.Value && Label28.Text<>"Copacker Products", true,false)
                Width: =80
                X: =15
                Y: |-
                    =CountRows(Filter(colCoefficient,Coefficient =  Label28.Text))*80+
                    Label31_10.Height+Checkbox1_7.Height
                ZIndex: =19

            Icon22_41 As icon.Add:
                Color: =RGBA(0, 161, 233, 1)
                Height: =15
                Icon: =Icon.Add
                OnSelect: |+
                    =Collect(
                        colCoefficient, 
                        {Coefficient: Label28.Text,
                        EffectiveDate: First(Sort(Distinct('Coefficients for G-KPI Calculation',EffectiveDate),Result,Descending)).Result,
                        ID: Last(colCoefficient).ID + 1})
                    
                    
                    
                    
                Visible: =If(Checkbox1_7.Value && Label28.Text<>"Copacker Products", true,false)
                Width: =28
                X: =15
                Y: |-
                    =CountRows(Filter(colCoefficient,Coefficient =  Label28.Text))*80+
                    Label31_10.Height+Checkbox1_7.Height+12
                ZIndex: =20

        GalleryKSCPP As gallery.variableTemplateHeightGallery:
            Height: =CountRows(Filter(colCoefficientCopacker,Coefficient =  Label28.Text))*45
            Items: |-
                =Sort(
                Filter (
                    colCoefficientCopacker,
                    ComboBox3.Selected.Result = Blank() Or
                    'Product Name' in ComboBox3.SelectedItems,
                    ComboBox3_1.Selected.Result = Blank() Or
                    'Item Code' in ComboBox3_1.SelectedItems
                
                ),Copacker,Ascending)
            Layout: =Layout.Vertical
            TemplateFill: =If(ThisItem.IsChoosen,RGBA(247, 247, 247, 1),Transparent)
            TemplateSize: =39
            Visible: =If(Checkbox1_7.Value && Label28.Text = "Copacker Products",true,false)
            Width: =1255
            X: =9
            Y: =ComboBox3.Y+50
            ZIndex: =22

            TextInput6_21 As text:
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =ThisItem.'Product Name'
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Size: =11
                Width: =343
                X: =181
                Y: =3
                ZIndex: =2

            TextInput6_22 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =ThisItem.'Item Code'
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Size: =11
                Width: =81
                X: =553
                Y: =3
                ZIndex: =3

            TextInput6_23 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =ThisItem.Copacker
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Size: =11
                Width: =286
                X: =663
                Y: =3
                ZIndex: =4

            TextInput6_24 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Color: =RGBA(27, 179, 55, 1)
                Default: =ThisItem.'Unit Conversion Coefficient Amt'
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Size: =11
                Width: =119
                X: =978
                Y: =3
                ZIndex: =5

            TextInput6_25 As text:
                Align: =Center
                BorderColor: =RGBA(230, 230, 230, 1)
                Default: =ThisItem.'Unit Conversion Coefficient'
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Height: =33
                HoverBorderColor: =Self.BorderColor
                HoverColor: =Self.Color
                HoverFill: =Self.Fill
                OnSelect: =Select(Parent)
                Size: =11
                Width: =117
                X: =1126
                Y: =3
                ZIndex: =6

            DatePicker4_1 As datepicker:
                BorderColor: =RGBA(230, 230, 230, 1)
                DefaultDate: =ThisItem.EffectiveDate
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(0, 0, 0, 0)
                Format: ="mm/yyyy"
                Height: =35
                OnSelect: =Select(Parent)
                Size: =11
                Width: =142
                X: =10
                Y: =2
                ZIndex: =7

        ComboBox3 As combobox:
            BorderColor: =RGBA(230, 230, 230, 1)
            ChevronBackground: =RGBA(0, 161, 233, 1)
            DisplayFields: =["Result"]
            InputTextPlaceholder: =""
            Items: |-
                =Distinct(
                Filter(colCoefficientCopacker, Coefficient = Label28.Text).'Product Name','Product Name')
            OnChange: |
                =UpdateContext({ResetDropdownItem: true});
                UpdateContext({ResetDropdownItem: false})
            OnSelect: =Select(Parent)
            Reset: =ResetDropdownProductName
            SearchFields: =["Result"]
            SearchItems: |-
                =Search(Distinct(
                Filter(colCoefficientCopacker, Coefficient = Label28.Text).'Product Name','Product Name'),ComboBox3.SearchText,"Result")
            Visible: =If(Checkbox1_7.Value && Label28.Text = "Copacker Products",true,false)
            X: =Label31.X
            Y: =90
            ZIndex: =23

        ComboBox3_1 As combobox:
            BorderColor: =RGBA(230, 230, 230, 1)
            ChevronBackground: =RGBA(0, 161, 233, 1)
            DisplayFields: =["Result"]
            InputTextPlaceholder: =""
            IsSearchable: =false
            Items: |-
                =Distinct(
                Filter(colCoefficientCopacker, Coefficient = Label28.Text).'Item Code','Item Code')
            OnSelect: |
                =UpdateContext({ResetDropdownProductName: true}); 
                UpdateContext({ResetDropdownProductName: false})
            Reset: =ResetDropdownItem
            SearchFields: =["Result"]
            SearchItems: =[]
            Visible: =If(Checkbox1_7.Value && Label28.Text = "Copacker Products",true,false)
            Width: =127
            X: =Label31_1.X+20
            Y: =90
            ZIndex: =24

    Icon2_23 As icon.Notebook:
        Color: =RGBA(153, 153, 153, 1)
        Height: =25
        Icon: =Icon.Notebook
        OnSelect: =Set(changeloguserKS,true)
        Tooltip: ="Change Log"
        Width: =25
        X: =1127
        Y: =64
        ZIndex: =12

    Label2_1 As label:
        Color: =RGBA(153, 153, 153, 1)
        FontWeight: =Semibold
        OnSelect: =Set(changeloguserKS,true)
        Text: ="Change Log"
        X: =1155
        Y: =55
        ZIndex: =13

    KS_Update_bttn As button:
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderThickness: =0
        Fill: =RGBA(0, 161, 233, 1)
        Height: =42
        HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        HoverFill: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        OnSelect: =Set(popupsavecoefficientcppKS,true); Set(updatecppKS,true)
        Size: =13
        Text: ="Save"
        Width: =200
        X: =583
        Y: =673
        ZIndex: =14

    changelogKS_popup As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =28

        ChangeLogPopUp_2 As button:
            BorderColor: =RGBA(194, 194, 194, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =716
            HoverColor: =Self.Color
            HoverFill: =Self.Fill
            OnSelect: =true
            Text: =""
            Visible: =changeloguserKS
            Width: =1366
            Y: =52
            ZIndex: =15

        SubHeader_27 As SubHeader:
            Height: =43
            Visible: =changeloguserKS
            Y: =52
            ZIndex: =16

        "'Close-bttn-etika_19' As icon.CancelBadge":
            Color: =RGBA(0, 161, 233, 1)
            Height: =20
            Icon: =Icon.CancelBadge
            OnSelect: =Set(changeloguserKS,false)
            Visible: =changeloguserKS
            Width: =20
            X: =1324
            Y: =64
            ZIndex: =17

        Label39_1 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =41
            Size: =14
            Text: ="Change log"
            Visible: =changeloguserKS
            Width: =660
            X: =353
            Y: =54
            ZIndex: =18

        DataTable9 As dataTable.datatable:
            BorderStyle: =BorderStyle.Solid
            DisplayMode: =DisplayMode.Edit
            Fill: =RGBA(0, 0, 0, 0)
            HeadingFill: =RGBA(0, 161, 233, 1)
            Height: =604
            Items: =Sort('Coefficients for G-KPI Calculation Change Log',Created,Descending)
            SelectedFill: =RGBA(230, 230, 230, 1)
            Visible: =changeloguserKS
            Width: =1295
            X: =27
            Y: =129
            ZIndex: =19

            ChangeLogNew_Column4 As dataTableColumn.textualColumn:
                AutoWidth: =false
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Unit Calorific Value"
                FieldName: ="ChangeLogNew"
                FieldVariantName: ="textualColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =32
                Text: =ThisItem.ChangeLogNew
                Width: =233
                X: =0
                Y: =0
                ZIndex: =49

            Item_Column4 As dataTableColumn.textualColumn:
                AutoWidth: =true
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Item"
                FieldName: ="Item"
                FieldVariantName: ="textualColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =31
                Text: =ThisItem.Item
                Width: =307
                X: =0
                Y: =0
                ZIndex: =50

            ChangeLogCO2_Column1 As dataTableColumn.textualColumn:
                AutoWidth: =false
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Unit CO2 Emission"
                FieldName: ="ChangeLogCO2"
                FieldVariantName: ="textualColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =34
                Text: =ThisItem.ChangeLogCO2
                Width: =190
                X: =0
                Y: =0
                ZIndex: =51

            ChangeLogDS_Column1 As dataTableColumn.textualColumn:
                AutoWidth: =false
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Data Source"
                FieldName: ="ChangeLogDS"
                FieldVariantName: ="textualColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =35
                Text: =ThisItem.ChangeLogDS
                Width: =612
                X: =0
                Y: =0
                ZIndex: =52

            Remarks_Column1 As dataTableColumn.textualColumn:
                AutoWidth: =false
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Remarks"
                FieldName: ="Remarks"
                FieldVariantName: ="textualColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =36
                Text: =ThisItem.Remarks
                Width: =115
                X: =0
                Y: =0
                ZIndex: =53

            Created_Column1 As dataTableColumn.dateTimeColumn:
                AutoWidth: =false
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Date"
                FieldName: ="Created"
                FieldVariantName: ="dateTimeColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =8
                Text: =Text(ThisItem.Created,"dd/mm/yyyy")
                Width: =142
                X: =0
                Y: =0
                ZIndex: =54

            Coefficient_Column2 As dataTableColumn.textualColumn:
                DisplayMode: =DisplayMode.Edit
                FieldDisplayName: ="Coefficient"
                FieldName: ="Coefficient"
                FieldVariantName: ="textualColumn"
                Height: =Parent.Height
                LayoutHeight: =Parent.Height
                Order: =30
                Text: =ThisItem.Coefficient
                Width: =100
                X: =0
                Y: =0
                ZIndex: =68

    popupsavecppuser_1 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =30

        Rectangle5_61 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupsavecoefficientcppKS
            Width: =1366
            ZIndex: =20

        Submit_Bttn_updatecpp_KS As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            BorderThickness: =0
            Fill: =RGBA(128, 128, 128, 1)
            Height: =44
            HoverColor: =ColorFade(Self.Color, -4%)
            HoverFill: =ColorFade(Self.Fill, -4%)
            OnSelect: |+
                =ForAll(RenameColumns(Filter(colCoefficient,IsChoosen),"ID","EID"),
                Patch('Coefficients for G-KPI Calculation', LookUp('Coefficients for G-KPI Calculation', ID=EID),
                {       EffectiveDate: LookUp(colCoefficient, ID=EID).EffectiveDate,
                        Title: LookUp(colCoefficient, ID=EID).Title,
                        Unit: LookUp(colCoefficient, ID=EID).Unit,
                        'Unit Calorific (Fuel) Value': LookUp(colCoefficient, ID=EID).'Unit Calorific (Fuel) Value',
                        'Unit Calorific Value (Fuel) Unit': LookUp(colCoefficient, ID=EID).'Unit Calorific Value (Fuel) Unit',
                        'Unit Calorific Value (Fuel) Calculation':LookUp(colCoefficient, ID=EID).'Unit Calorific Value (Fuel) Calculation',
                        'Unit CO2 Emmission (Fuel) Value': LookUp(colCoefficient, ID=EID).'Unit CO2 Emmission (Fuel) Value',
                        'Unit CO2 Emmission (Fuel) Unit': LookUp(colCoefficient, ID=EID).'Unit CO2 Emmission (Fuel) Unit',
                        DataSource: LookUp(colCoefficient, ID=EID).DataSource
                }));
                
                ForAll(Filter(colCoefficient,IsChoosen) As _item, If(LookUp('Coefficients for G-KPI Calculation',ID=_item.ID,ID)=Blank(),
                Patch('Coefficients for G-KPI Calculation',
                {       EffectiveDate: _item.EffectiveDate,
                        Coefficient: _item.Coefficient,
                        Title: _item.Title,
                        Unit:_item.Unit,
                        'Unit Calorific (Fuel) Value':_item.'Unit Calorific (Fuel) Value',
                        'Unit Calorific Value (Fuel) Unit':_item.'Unit Calorific Value (Fuel) Unit',
                        'Unit Calorific Value (Fuel) Calculation':_item.'Unit Calorific Value (Fuel) Calculation',
                        'Unit CO2 Emmission (Fuel) Value':_item.'Unit CO2 Emmission (Fuel) Value',
                        'Unit CO2 Emmission (Fuel) Unit':_item.'Unit CO2 Emmission (Fuel) Unit',
                        DataSource:_item.DataSource
                })));
                
                ForAll(colCopackerKSChangeLog As _item, 
                Patch('Coefficients for G-KPI Calculation Change Log',
                {Item: _item.Item, ChangeLogNew:_item.ChangeLogNew, EffectiveDateMonth: _item.EffectiveDate, ChangeLogCO2:_item.ChangeLogCO2, ChangeLogDS:_item.ChangeLogDS, Remarks:_item.Remarks, Coefficient: _item.Coefficient}));
                
                ForAll(colCoefficient As _item,If(LookUp('Coefficients for G-KPI Calculation',ID=_item.ID,ID)=Blank(),
                Patch('Utilities for G-KPI Calculation',
                {Coefficient:_item.Coefficient,BU:Table({Value:"EBSB"}, {Value:"EDSB"}, {Value:"PTEMI"}, {Value:"PTEDI"}),FuelType:_item.Title,
                DataType:"Purchased Fuel Amount", Unit:"", Status:"Approved"})));
                
                Navigate(Successful)
                
            PressedColor: =ColorFade(Self.Color, -4%)
            PressedFill: =ColorFade(Self.Fill, -4%)
            Size: =13
            Text: ="Yes"
            Visible: =popupsavecoefficientcppKS
            Width: =209
            X: =452
            Y: =664
            ZIndex: =21

        Cancel_Bttn_40 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(savecppKS,false); Set(updatecppKS,false); Set(popupsavecoefficientcppKS,false);
            Size: =13
            Text: ="No"
            Visible: =popupsavecoefficientcppKS
            Width: =209
            X: =687
            Y: =664
            ZIndex: =22

        Circle2_55 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupsavecoefficientcppKS
            Width: =65
            X: =651
            Y: =264
            ZIndex: =23

        Image6_45 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupsavecoefficientcppKS
            Width: =45
            X: =661
            Y: =274
            ZIndex: =24

        Label3_57 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Do you want to save the changes?"
            Visible: =popupsavecoefficientcppKS
            Width: =681
            X: =343
            Y: =362
            ZIndex: =25

    BG_33 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =36

        Image3_40 As image:
            Height: =768
            Image: =asahi_people
            ImagePosition: =ImagePosition.Fill
            Width: =1366
            ZIndex: =1

        Rectangle1_67 As rectangle:
            Fill: =RGBA(255, 255, 255, 0.97)
            Height: =768
            Width: =1365
            X: =1
            ZIndex: =2

