"'Utilities-Approver' As screen":

    SubHeader_21 As SubHeader:
        ZIndex: =3

    Header_18 As Header:
        HeaderText: ="E-1 G-KPI (Utility Related) Form"
        ZIndex: =4

    Label36_1 As label:
        Text: ="v02"
        Y: =728
        ZIndex: =5

    "'Utilities-Form_1' As form":
        AcceptsFocus: =false
        DataSource: ='Utilities Master Form'
        Height: =184
        Item: |-
            =Switch(
                true,
                !IsBlank(varUtil.FormNo),
                LookUp('Utilities Master Form', FormNo = varUtil.FormNo),
                And(!IsBlank(Param("UtilFormNo")), !IsBlank(Param("Roles")),  !IsBlank(Param("ApproverName")), !IsBlank(Param("ApproverEmail"))), LookUp('Utilities Master Form', FormNo= Param("UtilFormNo")))
        SnapToColumns: =false
        Width: =1366
        Y: =104
        ZIndex: =6

        Status_DataCard5 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Status"
            Default: =ThisItem.Status
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"Status")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "Status")
            Required: =false
            Update: =DataCardValue35.Text
            Width: =436
            X: =0
            Y: =0
            ZIndex: =1

            DataCardKey54 As label:
                AutoHeight: =true
                Color: =RGBA(0, 161, 233, 1)
                FontWeight: =Semibold
                Height: =34
                Size: =18
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue35 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                BorderThickness: =0
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(230, 230, 230, 1)
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =49
                ZIndex: =2

            ErrorMessage35 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue35.Y + DataCardValue35.Height
                ZIndex: =3

            StarVisible35 As label:
                Align: =Align.Center
                Height: =DataCardKey54.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey54.Y
                ZIndex: =4

        FormNo_DataCard2_3 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="FormNo"
            Default: =ThisItem.FormNo
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"FormNo")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "FormNo")
            Required: =false
            Update: =DataCardValue4_1.Text
            Width: =214
            X: =1
            Y: =0
            ZIndex: =7

            DataCardKey4_3 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: ="Form No"
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue4_1 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                BorderThickness: =0
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(230, 230, 230, 1)
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =166
                X: =30
                Y: =DataCardKey4_3.Y + DataCardKey4_3.Height + 5
                ZIndex: =2

            ErrorMessage15_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue4_1.Y + DataCardValue4_1.Height
                ZIndex: =3

            StarVisible15_1 As label:
                Align: =Align.Center
                Height: =DataCardKey4_3.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey4_3.Y
                ZIndex: =4

        BU_DataCard1_4 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="BU"
            Default: =ThisItem.BU
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"BU")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "BU")
            Required: =false
            Update: =BUUtil_1.Text
            Width: =213
            X: =2
            Y: =0
            ZIndex: =7

            DataCardKey13_3 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            BUUtil_1 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =Parent.Default
                DelayOutput: =true
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(230, 230, 230, 1)
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey13_3.Y + DataCardKey13_3.Height + 5
                ZIndex: =2

            ErrorMessage16_3 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =BUUtil_1.Y + BUUtil_1.Height
                ZIndex: =3

            StarVisible16_3 As label:
                Align: =Align.Center
                Height: =DataCardKey13_3.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey13_3.Y
                ZIndex: =4

        Year_DataCard2_3 As typedDataCard.numberEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Year"
            Default: =ThisItem.Year
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"Year")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =164
            Required: =true
            Update: =YearUtil_1.Selected.Value
            Width: =226
            X: =4
            Y: =0
            ZIndex: =7

            DataCardKey16_3 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            ErrorMessage56_3 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: ="This field is mandatory."
                Visible: =(IsBlank(YearUtil_1.Selected.Value) && Parent.DisplayMode=DisplayMode.Edit)
                Width: =Parent.Width - 60
                X: =30
                Y: =99
                ZIndex: =3

            StarVisible62_3 As label:
                Align: =Align.Center
                Height: =DataCardKey16_3.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey16_3.Y
                ZIndex: =4

            YearUtil_1 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank(YearUtil_1.Selected.Value), Color.Red, Parent.BorderColor)
                BorderThickness: =0
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =Parent.Default
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(230, 230, 230, 1)
                Items: =["", Year(Now()),  Year(Today())-1]
                OnChange: =If(CountRows(Filter('Utilities Total Form', BU = BUUtil_1.Text, Month = MonthUtil_1.Selected.Value,Year = YearUtil_1.Selected.Value))>0,Set(popupalreadysubmitutil,true))
                Reset: =resetyearutil
                Width: =150
                X: =30
                Y: =44
                ZIndex: =5

        Month_DataCard6_5 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="Month"
            Default: =ThisItem.Month
            DisplayMode: =DisplayMode.View
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"Month")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =94
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "Month")
            Required: =true
            Update: =MonthUtil_1.Selected.Value
            Width: =226
            X: =5
            Y: =0
            ZIndex: =7

            DataCardKey15_1 As label:
                AutoHeight: =true
                Color: =RGBA(0, 0, 0, 1)
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            ErrorMessage17_2 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: ="This field is mandatory."
                Visible: =(IsBlank(MonthUtil_1.Selected.Value) && Parent.DisplayMode=DisplayMode.Edit)
                Width: =Parent.Width - 60
                X: =30
                Y: =99
                ZIndex: =3

            StarVisible17_2 As label:
                Align: =Align.Center
                Height: =DataCardKey15_1.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey15_1.Y
                ZIndex: =4

            MonthUtil_1 As dropdown:
                AllowEmptySelection: =true
                BorderColor: =If(IsBlank(MonthUtil_1.Selected.Value), Color.Red, Parent.BorderColor)
                BorderThickness: =0
                ChevronBackground: =RGBA(0, 161, 233, 1)
                Default: =Parent.Default
                DisplayMode: =DisplayMode.View
                Fill: =RGBA(230, 230, 230, 1)
                Items: =Calendar.MonthsLong()
                OnChange: =If(CountRows(Filter('Utilities Total Form', BU = BUUtil_1.Text, Month = MonthUtil_1.Selected.Value,Year = YearUtil_1.Selected.Value))>0,Set(popupalreadysubmitutil,true))
                Reset: =resetmonthutil
                X: =30
                Y: =44
                ZIndex: =5

        RequestorName_DataCard1_1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="RequestorName"
            Default: =ThisItem.RequestorName
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"RequestorName")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "RequestorName")
            Required: =false
            Update: =DataCardValue56_1.Text
            Visible: =false
            Width: =285
            X: =0
            Y: =3
            ZIndex: =7

            DataCardKey17_2 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue56_1 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =varUserName
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey17_2.Y + DataCardKey17_2.Height + 5
                ZIndex: =2

            ErrorMessage57_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue56_1.Y + DataCardValue56_1.Height
                ZIndex: =3

            StarVisible63_1 As label:
                Align: =Align.Center
                Height: =DataCardKey17_2.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey17_2.Y
                ZIndex: =4

        RequestorEmail_DataCard1_1 As typedDataCard.textualEditCard:
            BorderStyle: =BorderStyle.Solid
            DataField: ="RequestorEmail"
            Default: =ThisItem.RequestorEmail
            DisplayMode: =Parent.DisplayMode
            DisplayName: =DataSourceInfo([@'Utilities Master Form'],DataSourceInfo.DisplayName,"RequestorEmail")
            Fill: =RGBA(0, 0, 0, 0)
            Height: =50
            MaxLength: =DataSourceInfo([@'Utilities Master Form'], DataSourceInfo.MaxLength, "RequestorEmail")
            Required: =false
            Update: =DataCardValue57_1.Text
            Visible: =false
            Width: =214
            X: =0
            Y: =4
            ZIndex: =7

            DataCardKey51_3 As label:
                AutoHeight: =true
                Height: =34
                Text: =Parent.DisplayName
                Width: =Parent.Width - 60
                Wrap: =false
                X: =30
                Y: =10
                ZIndex: =1

            DataCardValue57_1 As text:
                BorderColor: =If(IsBlank(Parent.Error), Parent.BorderColor, Color.Red)
                Default: =varUserEmail
                DelayOutput: =true
                DisplayMode: =Parent.DisplayMode
                MaxLength: =Parent.MaxLength
                PaddingLeft: =5
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Tooltip: =Parent.DisplayName
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardKey51_3.Y + DataCardKey51_3.Height + 5
                ZIndex: =2

            ErrorMessage61_1 As label:
                AutoHeight: =true
                Height: =10
                Live: =Live.Assertive
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Text: =Parent.Error
                Visible: =Parent.DisplayMode=DisplayMode.Edit
                Width: =Parent.Width - 60
                X: =30
                Y: =DataCardValue57_1.Y + DataCardValue57_1.Height
                ZIndex: =3

            StarVisible66_1 As label:
                Align: =Align.Center
                Height: =DataCardKey51_3.Height
                Text: ="*"
                Visible: =And(Parent.Required, Parent.DisplayMode=DisplayMode.Edit)
                Width: =30
                Wrap: =false
                Y: =DataCardKey51_3.Y
                ZIndex: =4

    Gallery2 As gallery.variableTemplateHeightGallery:
        Height: =297
        Items: |-
            =Switch(
                true,
                !IsBlank(varUtil.FormNo),
                Sort(
                Distinct(Filter('Utilities Total Form', FormNo = varUtil.FormNo),Utilities),Result),
                And(!IsBlank(Param("UtilFormNo")), !IsBlank(Param("Roles")),  !IsBlank(Param("ApproverName")), 
                !IsBlank(Param("ApproverEmail"))), 
                Sort(
                Distinct(Filter('Utilities Total Form', FormNo= Param("UtilFormNo")),Utilities),Result))
        Layout: =Layout.Vertical
        TemplateSize: =262
        Width: =1366
        Y: =210
        ZIndex: =7

        Gallery13 As gallery.variableTemplateHeightGallery:
            Height: |-
                =If(Checkbox1_6.Value, CountRows(
                Filter('Utilities Total Form',Utilities = Label26_6.Text && FormNo = DataCardValue4_1.Text))*60, 0)
            Items: |-
                =If(Checkbox1_6.Value, Filter('Utilities Total Form',Utilities = Label26_6.Text && FormNo = DataCardValue4_1.Text),
                
                Filter('Utilities Total Form',Utilities = "" && FormNo = DataCardValue4_1.Text))
            Layout: =Layout.Vertical
            TemplateSize: =280
            Width: =1302
            X: =27
            Y: =49
            ZIndex: =1

            Label37 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.UtilitiesType
                Width: =168
                ZIndex: =1

            Label37_1 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.DataType
                Width: =186
                X: =175
                ZIndex: =2

            Label37_2 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.Unit
                Width: =71
                X: =402
                ZIndex: =3

            Label37_3 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.TotalUtilities
                Width: =111
                X: =480
                ZIndex: =4

            Label37_4 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.Conversion1
                Width: =128
                X: =598
                ZIndex: =5

            Label37_5 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.Conversion1Unit
                Width: =96
                X: =733
                ZIndex: =6

            Label37_6 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.Conversion1Amt
                Width: =106
                X: =836
                ZIndex: =7

            Label37_7 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.Conversion2
                Width: =128
                X: =949
                ZIndex: =8

            Label37_8 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.Conversion2Unit
                Width: =96
                X: =1084
                ZIndex: =9

            Label37_9 As label:
                AutoHeight: =true
                Height: =60
                OnSelect: =Select(Parent)
                Size: =11
                Text: =ThisItem.Conversion2Amt
                Width: =106
                X: =1191
                ZIndex: =10

        Button8_65 As button:
            DisplayMode: =DisplayMode.View
            Fill: =RGBA(247, 247, 247, 1)
            Height: =49
            Text: =""
            Width: =1302
            X: =20
            ZIndex: =2

        Circle1_20 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =30
            OnSelect: =Select(Parent)
            Width: =30
            X: =56
            Y: =9
            ZIndex: =3

        Icon22_39 As icon.Post:
            Color: =RGBA(255, 255, 255, 1)
            DisplayMode: =DisplayMode.View
            Height: =22
            Icon: =Icon.Post
            OnSelect: =Select(Parent)
            Width: =22
            X: =60
            Y: =13
            ZIndex: =4

        Label26_6 As label:
            Color: =RGBA(0, 161, 233, 1)
            FontWeight: =Semibold
            Height: =34
            OnSelect: =Select(Parent)
            Text: =ThisItem.Result
            Width: =Len(Label26_6.Text)*15
            X: =103
            Y: =8
            ZIndex: =5

        Checkbox1_6 As checkbox:
            CheckboxBorderColor: =RGBA(179, 179, 179, 1)
            OnSelect: =Select(Parent)
            Text: ="Show all SKU"
            Width: =297
            X: =263
            ZIndex: =6

    Approve_bttn_5 As button:
        BorderThickness: =0
        Fill: =RGBA(54, 176, 75, 1)
        Height: =42
        HoverFill: =ColorFade(Self.Fill, -4%)
        OnSelect: =Set(popupapproveutil,true);Set(mandatorycommentboxutil,false)
        Size: =13
        Text: ="Approve"
        Visible: |-
            =If(
            
            And(DataCardValue140.Text = "Pending approval from Regional Manager",Param("Roles") = "PM",CountRows(Filter('Approver Details', FormNo = DataCardValue347.Text, Roles = "Plant Manager", AlreadyRespond = "Yes")) > 0), false,
            
            And(DataCardValue140.Text = "Closed", Param("Roles") = "RM",CountRows(Filter('Approver Details', FormNo = DataCardValue347.Text, Roles = "Regional Manager", AlreadyRespond = "Yes")) > 0), false,
            
            true)
        Width: =200
        X: =1143
        Y: =703
        ZIndex: =8

    Reject_bttn_5 As button:
        BorderColor: =RGBA(128, 128, 128, 1)
        BorderThickness: =0
        Fill: =RGBA(184, 0, 0, 1)
        Height: =42
        HoverBorderColor: =ColorFade(RGBA(128, 128, 128, 1), -4%)
        HoverFill: =ColorFade(Self.Fill, -4%)
        OnSelect: |-
            =If(IsBlank('Commment-box-approver_2'.Text),Set(mandatorycommentbox,true),Set(popupusersaveutil,true));
            
            If(And(mandatorycommentbox, IsBlank('Commment-box-approver_2'.Text)), Notify("Please leave your comment(s) in the comment box below if you reject the form.",NotificationType.Error,1500));
        Size: =13
        Text: ="Reject"
        Visible: |-
            =If(
            
            And(DataCardValue140.Text = "Pending approval from Regional Manager",Param("Roles") = "PM",CountRows(Filter('Approver Details', FormNo = DataCardValue347.Text, Roles = "Plant Manager", AlreadyRespond = "Yes")) > 0), false,
            
            And(DataCardValue140.Text = "Closed", Param("Roles") = "RM",CountRows(Filter('Approver Details', FormNo = DataCardValue347.Text, Roles = "Regional Manager", AlreadyRespond = "Yes")) > 0), false,
            
            true)
        Width: =200
        X: =928
        Y: =703
        ZIndex: =9

    Label17_2 As label:
        Height: =43
        Text: ="Please leave your comment(s) in the comment box below if you reject the form."
        Width: =810
        X: =23
        Y: =528
        ZIndex: =10

    "'Commment-box-approver_2' As text":
        Default: =""
        Height: =112
        HoverFill: =Self.Fill
        Width: =1315
        X: =23
        Y: =568
        ZIndex: =11

    ErrorMessage21_4 As label:
        Height: =25
        Live: =Live.Assertive
        PaddingBottom: =0
        PaddingLeft: =0
        PaddingRight: =0
        PaddingTop: =0
        Text: ="This field is mandatory."
        Visible: =If(And(IsBlank('Commment-box-approver_1'.Text),mandatorycommentbox),true,false)
        Width: =1219
        X: =23
        Y: =691
        ZIndex: =12

    Pop_Up_Reject_3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =25

        Rectangle5_58 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupusersaveutil
            Width: =1366
            ZIndex: =19

        Submit_Bttn_36 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            BorderThickness: =0
            Fill: =RGBA(184, 0, 0, 1)
            Height: =44
            HoverColor: =ColorFade(Self.Color, -4%)
            HoverFill: =ColorFade(Self.Fill, -4%)
            OnSelect: |-
                ='ApprovalFlow-TriggerRejectButtonforApproverUtilities'.Run(DataCardValue4_1.Text, Param("Roles"), Param("ApproverName"), Param("ApproverEmail"), 'Commment-box-approver_2'.Text, BUUtil_1.Text);
                
                If(
                
                And(!IsBlank(Param("UtilFormNo")), Param("Roles") = "PM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = Param("UtilFormNo")),
                    {Status: "Rejected"
                    }),
                
                And(!IsBlank(varUtil.FormNo), Param("Roles") = "PM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = varUtil.FormNo),
                    {Status: "Rejected"
                    }),
                    
                And(!IsBlank(Param("UtilFormNo")), Param("Roles") = "RM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = Param("UtilFormNo")),
                    {Status: "Rejected"
                    }),
                
                And(!IsBlank(varUtil.FormNo), Param("Roles") = "RM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = varUtil.FormNo),
                    {Status:  "Rejected"
                    }));
                
                
                If(
                
                And(CountRows(Filter('Approver Details', FormNo = varUtil.FormNo, Roles = varUserRoles.Value)) > 0, !IsBlank(varUtil.FormNo)),
                Patch('Approver Details', 
                LookUp('Approver Details', FormNo = varUtil.FormNo),
                    {ApproverEmail:varUserEmail,
                    ApproverName:varUserName,
                    Roles: varUserRoles.Value,
                    FormNo:varUtil.FormNo,
                    Response:"Reject",
                    ResponseDate: Today(),
                    Comments: 'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }),
                
                And(CountRows(Filter('Approver Details', FormNo = Param("UtilFormNo"), Roles = (Param("Roles")))) > 0, !IsBlank(Param("UtilFormNo"))),
                Patch('Approver Details', 
                LookUp('Approver Details', FormNo = Param("UtilFormNo")),
                    {ApproverEmail: Param("ApproverEmail"),
                    ApproverName: Substitute(Substitute(Param("ApproverName"),"+"," "),"%20"," "),
                    Roles: If(Param("Roles") = "PM", "Plant Manager", Param("Roles") = "RM", "Regional Manager"),
                    FormNo:Param("UtilFormNo"),
                    Response:"Reject",
                    ResponseDate: Today(),
                    Comments:  'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }),
                    
                And(CountRows(Filter('Approver Details', FormNo = varUtil.FormNo, Roles = varUserRoles.Value)) = 0, !IsBlank(varUtil.FormNo)),
                Patch('Approver Details', 
                    {ApproverEmail:varUserEmail,
                    ApproverName:varUserName,
                    Roles: varUserRoles.Value,
                    FormNo:varUtil.FormNo,
                    Response:"Reject",
                    ResponseDate: Today(),
                    Comments:  'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }),
                
                And(CountRows(Filter('Approver Details', FormNo = Param("UtilFormNo"), Roles = (Param("Roles")))) = 0, !IsBlank(Param("UtilFormNo"))),
                Patch('Approver Details', 
                    {ApproverEmail: Param("ApproverEmail"),
                    ApproverName: Substitute(Substitute(Param("ApproverName"),"+"," "),"%20"," "),
                    Roles: If(Param("Roles") = "PM", "Plant Manager", Param("Roles") = "RM", "Regional Manager"),
                    FormNo:Param("UtilFormNo"),
                    Response:"Reject",
                    ResponseDate: Today(),
                    Comments:  'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }));
                
                Set(popupapprovesuccessful,true)
            PressedColor: =ColorFade(Self.Color, -4%)
            PressedFill: =ColorFade(Self.Fill, -4%)
            Size: =13
            Text: ="Yes"
            Visible: =popupusersaveutil
            Width: =209
            X: =452
            Y: =664
            ZIndex: =20

        Cancel_Bttn_38 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupusersaveutil,false)
            Size: =13
            Text: ="No"
            Visible: =popupusersaveutil
            Width: =209
            X: =684
            Y: =664
            ZIndex: =21

        Circle2_53 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupusersaveutil
            Width: =65
            X: =651
            Y: =264
            ZIndex: =22

        Image6_43 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupusersaveutil
            Width: =45
            X: =661
            Y: =274
            ZIndex: =23

        Label3_55 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Do you want to continue rejecting the form?"
            Visible: =popupusersaveutil
            Width: =681
            X: =343
            Y: =362
            ZIndex: =24

    Pop_Up_Approve_3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =27

        Rectangle5_57 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupapproveutil
            Width: =1366
            ZIndex: =13

        Submit_Bttn_35 As button:
            Align: =Center
            BorderColor: =RGBA(0, 161, 233, 1)
            BorderThickness: =0
            Fill: =RGBA(54, 176, 75, 1)
            Height: =44
            HoverFill: =ColorFade(Self.Fill, -4%)
            OnSelect: |-
                ='ApprovalFlow-TriggerApproveButtonforApproverUtilities'.Run(DataCardValue4_1.Text, Param("Roles"), Param("ApproverName"), Param("ApproverEmail"), 'Commment-box-approver_2'.Text, BUUtil_1.Text);
                
                If(
                
                And(!IsBlank(Param("UtilFormNo")), Param("Roles") = "PM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = Param("UtilFormNo")),
                    {Status: "Pending approval from Regional Manager"
                    }),
                
                And(!IsBlank(varUtil.FormNo), Param("Roles") = "PM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = varUtil.FormNo),
                    {Status: "Pending approval from Regional Manager"
                    }),
                    
                And(!IsBlank(Param("UtilFormNo")), Param("Roles") = "RM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = Param("UtilFormNo")),
                    {Status: "Approved"
                    }),
                
                And(!IsBlank(varUtil.FormNo), Param("Roles") = "RM"),
                Patch('Utilities Master Form', 
                LookUp('Utilities Master Form', FormNo = varUtil.FormNo),
                    {Status:  "Approved"
                    }));
                
                
                If(
                
                And(CountRows(Filter('Approver Details', FormNo = varUtil.FormNo, Roles = varUserRoles.Value)) > 0, !IsBlank(varUtil.FormNo)),
                Patch('Approver Details', 
                LookUp('Approver Details', FormNo = varUtil.FormNo),
                    {ApproverEmail:varUserEmail,
                    ApproverName:varUserName,
                    Roles: varUserRoles.Value,
                    FormNo:varUtil.FormNo,
                    Response:"Approve",
                    ResponseDate: Today(),
                    Comments: 'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }),
                
                And(CountRows(Filter('Approver Details', FormNo = Param("UtilFormNo"), Roles = (Param("Roles")))) > 0, !IsBlank(Param("UtilFormNo"))),
                Patch('Approver Details', 
                LookUp('Approver Details', FormNo = Param("UtilFormNo")),
                    {ApproverEmail: Param("ApproverEmail"),
                    ApproverName: Substitute(Substitute(Param("ApproverName"),"+"," "),"%20"," "),
                    Roles: If(Param("Roles") = "PM", "Plant Manager", Param("Roles") = "RM", "Regional Manager"),
                    FormNo:Param("UtilFormNo"),
                    Response:"Approve",
                    ResponseDate: Today(),
                    Comments:  'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }),
                    
                And(CountRows(Filter('Approver Details', FormNo = varUtil.FormNo, Roles = varUserRoles.Value)) = 0, !IsBlank(varUtil.FormNo)),
                Patch('Approver Details', 
                    {ApproverEmail:varUserEmail,
                    ApproverName:varUserName,
                    Roles: varUserRoles.Value,
                    FormNo:varUtil.FormNo,
                    Response:"Approve",
                    ResponseDate: Today(),
                    Comments:  'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }),
                
                And(CountRows(Filter('Approver Details', FormNo = Param("UtilFormNo"), Roles = (Param("Roles")))) = 0, !IsBlank(Param("UtilFormNo"))),
                Patch('Approver Details', 
                    {ApproverEmail: Param("ApproverEmail"),
                    ApproverName: Substitute(Substitute(Param("ApproverName"),"+"," "),"%20"," "),
                    Roles: If(Param("Roles") = "PM", "Plant Manager", Param("Roles") = "RM", "Regional Manager"),
                    FormNo:Param("UtilFormNo"),
                    Response:"Approve",
                    ResponseDate: Today(),
                    Comments:  'Commment-box-approver_2'.Text,
                    NeedInput: "No",
                    EditForm: "No",
                    AlreadyRespond: "Yes"
                    }));
                
                Set(popupapprovesuccessful,true)
            Size: =13
            Text: ="Yes"
            Visible: =popupapproveutil
            Width: =209
            X: =452
            Y: =664
            ZIndex: =14

        Cancel_Bttn_37 As button:
            Align: =Center
            BorderColor: =RGBA(128, 128, 128, 1)
            Color: =RGBA(128, 128, 128, 1)
            Fill: =RGBA(255, 255, 255, 1)
            Height: =44
            HoverColor: =RGBA(128, 128, 128, 1)
            HoverFill: =ColorFade(RGBA(255, 255, 255, 0), -4%)
            OnSelect: =Set(popupapproveutil,false)
            Size: =13
            Text: ="No"
            Visible: =popupapproveutil
            Width: =209
            X: =684
            Y: =664
            ZIndex: =15

        Circle2_52 As circle:
            Fill: =RGBA(0, 161, 233, 1)
            Height: =65
            Visible: =popupapproveutil
            Width: =65
            X: =651
            Y: =264
            ZIndex: =16

        Image6_32 As image:
            Height: =45
            Image: ='signature-with-a-pen'
            Visible: =popupapproveutil
            Width: =45
            X: =661
            Y: =274
            ZIndex: =17

        Label3_54 As label:
            Align: =Center
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =87
            Size: =18
            Text: ="Do you want to continue approving the form?"
            Visible: =popupapproveutil
            Width: =681
            X: =343
            Y: =362
            ZIndex: =18

    Pop_Up_Success_3 As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =31

        Rectangle5_59 As rectangle:
            Fill: =RGBA(255, 255, 255, 1)
            Height: =768
            Visible: =popupapprovesuccessful
            Width: =1366
            ZIndex: =26

        iconCircle2_7 As circle.Circle:
            Fill: =RGBA(0, 161, 233, 1)
            Visible: =popupapprovesuccessful
            X: =Parent.Width/2 - Self.Width/2
            Y: =319
            ZIndex: =28

        iconCheck2_7 As icon.Check:
            Height: =iconCircle2_7.Height
            Icon: =Icon.Check
            OnSelect: |
                =
            PaddingBottom: =Self.PaddingTop
            PaddingLeft: =Self.PaddingTop
            PaddingRight: =Self.PaddingTop
            PaddingTop: =24
            Visible: =popupapprovesuccessful
            Width: =iconCircle2_7.Width
            X: =Parent.Width/2 - Self.Width/2
            Y: =319
            ZIndex: =29

        LblSuccessMsg2_8 As label:
            Align: =Align.Center
            AutoHeight: =true
            Color: =RGBA(128, 128, 128, 1)
            FontWeight: =Semibold
            Height: =100
            Size: =18
            Text: ="This was successfully completed"
            Visible: =popupapprovesuccessful
            Width: =Parent.Width * 0.75
            X: =Parent.Width/2 - Self.Width/2
            Y: =449
            ZIndex: =30

